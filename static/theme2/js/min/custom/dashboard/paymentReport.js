var scriptRun=!1;function getPaymentReportData(e,t,a){url=t?CONTEXT_PATH+UNIQUEUUID+"/dashboard/student-payment-report-count":CONTEXT_PATH+UNIQUEUUID+"/dashboard/student-payment-report",customLoader(!0),$.ajax({type:"POST",contentType:"application/json",url,data:JSON.stringify(getRequestForPaymentReport(e,a,"N")),dataType:"json",success:function(e){return"0"==e.status||"2"==e.status||"3"==e.status?($("#studentPaymentReportTable tbody").empty(),"3"==e.status?redirectLoginPage():"theme1"==tt?showMessage(!1,e.message):showMessageTheme2(0,e.message,"",!0),$("#pagination").twbsPagination("destroy"),$("#consolidate").html(""),$("#studentPaymentReportTable tbody").empty(),$("#studentPaymentReport #studentPaymentReportTable tbody").html('<tr><td class="text-center">No records found</td></tr>')):t?pageCount(e.count):(1==a&&pageCount(e.count),$("#studentPaymentReportTable tbody").empty(),$("#studentPaymentReport #studentPaymentReportTable tbody").html(cardDetails(e)).promise().done((function(){$(".perfectScroll").perfectScrollbar()})),"DIRECTOR"==USER_ROLE&&null!=e.consolidate&&$("#consolidate").html(consolidateContent(e.consolidate,e.count))),customLoader(!1),!1}})}function getRequestForPaymentReport(e,t,a){var n={},r={};r.schoolId=SCHOOL_ID,r.studentName=$("#studentName").val(),""!=$("#startDate").val()&&(r.startDate=changeDateFormat(new Date($("#startDate").val()),"yyyy-mm-ddd")+" 00:00:00"),""!=$("#endDate").val()&&(r.endDate=changeDateFormat(new Date($("#endDate").val()),"yyyy-mm-ddd")+" 23:59:59"),""!=$("#gradeId").val()&&(r.gradeId=$("#gradeId").select2("val")),""!=$("#learningProgram").val()&&(r.learningProgram=$("#learningProgram").select2("val")),""!=$("#learningPlatform").val()&&(r.learningPlatform=$("#learningPlatform").select2("val")),""!=$("#enrollStatus").val()&&(r.enrollStatus=$("#enrollStatus").select2("val")),""!=$("#paymentStatus").val()&&(r.paymentStatus=$("#paymentStatus").select2("val")),""!=$("#userId").val()?r.userId=[$("#userId").val()]:r.userId=[],""!=$("#sessionId").val()&&(r.sessionId=$("#sessionId").val()),1==t&&$("#pageNumber").val(1);var o=$("#pageNumber").val();return(o-=1)<0&&(o=0),r.pageNumber=o,r.pageSize=$("#pageSize").val(),r.type=t,r.forDownload=a,""!=$("#overDueBy").val()&&0!=$("#overDueBy").val()?r.overDueBy=$("#overDueBy").val():r.overDueBy=45,n.paymentReportRequestDTO=r,n}function pageCount(e){var t=e/parseInt($("#pageSize").val());Number.isInteger(t)||(t=t.toString().split("."),t=parseInt(t[0])+1),$("#pagination").twbsPagination("destroy"),$("#pagination").twbsPagination({totalPages:t,visiblePages:10,next:"Next",prev:"Prev",onPageClick:function(e,t){$("#pageNumber").val(t),getPaymentReportData("",!1,2)}})}function resetStudentPaymentForm(e){var t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1);a=changeDateFormat(a,"MMM-dd-yyyy");var n=new Date(t.getFullYear(),t.getMonth()+1,0);n=changeDateFormat(n,"MMM-dd-yyyy"),$("#studentName").val(""),$("#"+e+" #startDate").val(a).datepicker("update"),$("#"+e+" #endDate").val(n).datepicker("update"),$("#"+e+" #learningPlatform").val("").trigger("change"),$("#"+e+" #learningProgram").val("").trigger("change"),$("#"+e+" #gradeId").val("").trigger("change"),$("#"+e+" #enrollStatus").val("0").trigger("change"),$("#"+e+" #paymentStatus").val(["ODUE","DUE"]).trigger("change"),$("#"+e+" #userId").val("").trigger("change"),$("#"+e+" #overDueBy").val("45"),$("#"+e+" #pageSize").val("10").trigger("change"),getPaymentReportData("",!1,1)}function downloadStudentPaymentReport(e,t,a){customLoader(!0),$.ajax({type:"POST",contentType:"application/json",url:CONTEXT_PATH+UNIQUEUUID+"/dashboard/student-payment-report-download",data:JSON.stringify(getRequestForPaymentReport(e,a,"Y")),xhrFields:{responseType:"blob"},success:function(e){var t=document.createElement("a"),a=window.URL.createObjectURL(e);t.href=a;var n=new Date,r=n.getFullYear()+"-"+(n.getMonth()>8?n.getMonth()+1:"0"+(n.getMonth()+1))+"-"+(n.getDate()>9?n.getDate():"0"+n.getDate())+"-"+n.getHours()+"-"+n.getMinutes()+"-"+n.getSeconds();t.download="Student_Payment_Report_"+r+".csv",document.body.append(t),t.click(),t.remove(),window.URL.revokeObjectURL(a),customLoader(!1)},error:function(e){console.log(e),customLoader(!1)}})}