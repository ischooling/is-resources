var player,player1,flagWatchVideo=!1,isSkipped=!1,videoUrl="N";function rendereDashboardContent(e){customLoader(!0),$("body").append(batchImpAnnouncementModal());var n=getStudentDashboardOrMigrationSection();if("N"==n.studentGraduate){"Y"==n.showBatchImpAnnouncementModal?($("#batchImpAnnouncementModal").modal("hide"),$("#batchStudentMappingId").val(n.batchStudentMappingId),$("#batchStartDate").text(n.batchAcademicYearStartDate),$("#batchFeeDueDate").text(n.feePayDueDate)):$("#batchImpAnnouncementModal").modal("hide"),"Y"!=n.firstTimeRequest||"Y"!=n.timePrefrenceSelectionStatus||"Skipped"!=n.systemTrainingStatus&&"COMPLETED"!=n.systemTrainingStatus||($("#welcomeNoteModal").modal("show"),window.setTimeout((function(){$("#welcomeNoteModal").modal("hide")}),8e3));var a=getStudentDashboardDetails();"Y"==a.showGraduationCeremonyPopup&&($("#graduationCeremonyModal").length>=1&&$("#graduationCeremonyModal").remove(),$("body").append(studentGraduationCeremontPopup()),setTimeout((()=>{$("#graduationCeremonyModal").modal("show")}),2e3)),videoUrl=a.videoUrl,"false"!==e&&(a.isParent=!0),renderStudentDashboard(a),renderAnnouncement(a.userId),renderActitify(a.userId),getCartDetails(a.userId),setTimeout((function(){getReserveASeatForNextGrade(a.userId)}),1e4),$("#timeStuStandardId").val(a.studentStandardId),"Y"==n.showStudentCourseSelectionModel&&getStudentTimePreference(n.studentId,n.standardId,n.providerId)}else"Y"==n.studentGraduate&&("Y"==n.showBatchImpAnnouncementModal?($("#batchStartDate").text(n.batchAcademicYearStartDate),$("#batchFeeDueDate").text(n.feePayDueDate),$("#batchImpAnnouncementModal").modal("hide"),$("#batchStudentMappingId").val(n.batchStudentMappingId)):$("#batchImpAnnouncementModal").modal("hide"),"Y"==n.showGraduationCeremonyPopup&&($("#graduationCeremonyModal").length>=1&&$("#graduationCeremonyModal").remove(),$("body").append(studentGraduationCeremontPopup()),setTimeout((()=>{$("#graduationCeremonyModal").modal("show")}),2e3)),n=getStudentMigraionOptionDetails(),"false"!==e&&(a.isParent=!0),renderMigrationDetailsOptionContent(n));"true"!==e&&(n.lastPassUpdatedDate||window.setTimeout((function(){callCommonDashboardPageForPasswordChange("14","No")}),1e3)),getChat(n.email,USER_ROLE)}async function renderStudentDashboard(e){var n=dashboardContent(e);$("#dashboardContentInHTML").html(n),$("#currentTimeForUser").html(convertUTCToTimezoneAs(getUTCTime(),DATETIME_FORMATTER,e.userTimezone).format("MMM DD, YYYY hh:mm:ss a")),setInterval((function(){$("#currentTimeForUser").html(convertUTCToTimezoneAs(getUTCTime(),DATETIME_FORMATTER,e.userTimezone).format("MMM DD, YYYY hh:mm:ss a"))}),1e3);for(var a=$(".card-activity .vertical-nav-menu > .sub-menu").length,t=1;t<=a;t++){var o=$(".card-activity .vertical-nav-menu  .sub-menu:nth-child("+t+") > ul .sub-menu").length;if($(".card-activity .vertical-nav-menu > .sub-menu:nth-child("+t+") ul li").length<1)$(".card-activity .vertical-nav-menu > .sub-menu:nth-child("+t+") a").addClass("disable-activity");else if(o>=1)for(var l=1;l<=o;l++)$(".card-activity .vertical-nav-menu  .sub-menu:nth-child("+t+")").addClass("mm-active"),$(".card-activity .vertical-nav-menu > .sub-menu:nth-child("+t+")  ul").addClass("mm-show"),$(".card-activity .vertical-nav-menu > .sub-menu:nth-child("+t+") > ul > .sub-menu:nth-child("+l+")").addClass("mm-active"),$(".card-activity .vertical-nav-menu > .sub-menu:nth-child("+t+") > ul > .sub-menu:nth-child("+l+") ul").addClass("mm-show");else $(".card-activity .vertical-nav-menu > .sub-menu:nth-child("+t+")  ul").addClass("mm-show"),$(".card-activity .vertical-nav-menu  .sub-menu:nth-child("+t+")").addClass("mm-active")}$(".announcement-anchor .announcement-list").click((function(){$(this).parent().find(".horizontal-scroll-table").slideToggle(),$(this).parent().closest("li").siblings().find(".horizontal-scroll-table").slideUp()}));var i=new Date,d=moment(i).format("YYYY-MM-DD"),s=moment(i).add(1,"days").format("YYYY-MM-DD");callSchoolCalendar("",USER_ID,UNIQUEUUID,"agendaDay",d,s,!1),calendarEventBind(),setTimeout((function(){$("button.fc-today-button").unbind("click").bind("click",(function(){$("#schoolcalendar").fullCalendar("today");var e=$("#schoolcalendar").fullCalendar("getView").name,n=$("#schoolcalendar").fullCalendar("getDate");if("agendaDay"===e)var a=new Date,t=moment(a).format("YYYY-MM-DD"),o=moment(a).add(1,"days").format("YYYY-MM-DD");else if("agendaWeek"===e){t=n.format("YYYY-MM-DD");var l=new Date(t),i=startAndEndOfWeek(l);t=i[0],o=i[1]}callSchoolCalendar("",USER_ID,UNIQUEUUID,e,t,o,!0)}))}),1e3),e.schoolId,$("#moveToTimePreferencePopup").click((function(){$("#mandatoryVideoModal").modal("hide"),$("#timePreferencePopup").removeClass("d-none"),$("#timePreferencePopup").modal("show")})),"N"!=e.videoUrl&&onYouTubeIframeAPIReady(e.videoUrl)}function slideMenu(e){$("#main-nav1").metisMenu({toggle:!1})}function dashboardContent(e){let n=`\n    <div class="app-page-title pt-1 pb-1 mb-2">\n        <div class="page-title-wrapper">\n            <div class="page-title-heading w-100">\n                \x3c!-- Optional code can go here, like the user dashboard observation --\x3e\n            </div>\n            <div class="page-title-actions mt-0 mb-1 d-lg-none pt-4">\n                <div class="d-inline-block">\n                    <label class="switch">\n                        <input class="switch-input redirectLmsUrl" type="checkbox" value="yes" onclick="redirectLms(this, '${e.isPayLmsPaymentPending}');" changeUrl="${e.lmsProviderURL}" />\n                        <span class="switch-label" data-on="" data-off="LMS"></span>\n                        <span class="switch-handle"></span>\n                    </label>\n                </div>\n            </div>\n        </div>\n    </div>\n    ${dashboardSchoolCalendar(e)}`;return"STUDENT"===USER_ROLE&&(n+=calendarMeetingLinkValidate()),n}function dashboardAnnouncement(e){return`\n    <div class="card box-shadow-none">\n        <div class="card-header theme-bg text-white justify-content-between card-header-primary d-flex">\n            <h6 class="pull-left m-0 font-size-md">\n                ${null!=e.schoolAnnouncements&&e.schoolAnnouncements.newAnnouncementCount>0?`${e.schoolAnnouncements.newAnnouncementCount} New Announcement(s)`:"Announcement"}\n            </h6>\n        </div>\n        <div class="card-body announcement-card-scroll">\n            <div class="announcement-wrapper">\n                <ul>\n                    ${null!=e.schoolAnnouncements&&e.schoolAnnouncements.schoolAnnounceDTO.length>0?e.schoolAnnouncements.schoolAnnounceDTO.map((e=>`\n                            <li class="col-md-12 col-sm-12 col-12 p-0">\n                                <div class="announcement-anchor" onclick="showAnnounceDataById(${e.announceId}, ${moduleId});">\n                                    <div class="announcement-list">\n                                        <span class="annoucement-icon">\n                                            <i class="fa fa-bullhorn"></i>\n                                            ${"N"===e.replyStatus?'<label class="new-label">New</label>':""}\n                                        </span>\n                                        <h4 class="announcement-title">\n                                            <span>${e.announceTitle}\n                                                ${"N"===e.replyStatus&&"Y"===e.latestStstus?'<label class="m-0 announcement-ribbon">New</label><i class="fa fa-star announcement-ribbon-star"></i>':""}\n                                            </span>\n                                        </h4>\n                                    </div>\n                                </div>\n                            </li>\n                        `)).join(""):'<li class="col-md-12 col-sm-12 col-xs-12 text-center">No new announcements</li>'}\n                </ul>\n            </div>\n        </div>\n    </div>`}function dashboardSchoolCalendar(e){return`\n    <div class="main-card mb-3">\n        <div class="full">\n            <div class="card-body px-0 pb-0">\n                <div class="row">\n                    ${"STUDENT"===e.userRole||"TEACHER"===e.userRole?'\n                    <div class="col-lg-8 col-md-8 col-sm-12 col-12 pt-2">':'\n                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">'}\n                        <div class="full mt-1">\n                            <div class="card">\n                                <div class="card-body">\n                                    <span id="currentTimeForUser" class="d-none"></span>\n                                    <div class="text-left d-flex align-items-center">\n                                        <span class="d-inline-block country-flag mr-2">\n                                            <img src="${PATH_FOLDER_FONT2}${e.countryISOCode}.svg" class="rounded" width="45px" alt="Flag"/>\n                                        </span>\n                                        <span class="user_timezone d-inline-block font-size-lg font-weight-semi-bold text-dark">\n                                            <label>${e.userTimezone}&nbsp;</label>\n                                        </span>\n                                        \x3c!--<span class="clock-box">\n                                            <label class="user_current_day clock-bg font-size-lg time-label"></label>\n                                        </span>\n                                        <span class="clock-box">\n                                            <label class="user_current_hour clock-bg font-size-lg time-label"></label>\n                                        </span>\n                                        <span class="clock-box position-relative">\n                                            <label class="user_current_mins clock-bg font-size-lg time-label"></label>\n                                            <label class="user_current_second clock-bg font-size-lg time-label"></label>\n                                        </span>\n                                        <span class="clock-box">\n                                            <label class="user_current_am_pm clock-bg font-size-lg time-label"></label>\n                                        </span>--\x3e\n                                        <div class="clock-box">\n                                            <span class="user_current_time clock-bg font-30 text-primary font-weight-semi-bold time-label"></span>\n                                        </div>\n                                    </div>\n                                    <hr/>\n                                    <div class="position-relative" style="z-index:0;" id="schoolcalendar"></div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    ${"STUDENT"===e.userRole||"TEACHER"===e.userRole?'\n                    <div class="col-lg-4 col-md-4 col-sm-12 pt-2 col-12 animated zoomIn">\n                        <div class="full" id="announcementDiv"></div>\n                        <div class="full mt-3" id="activityDiv"></div>\n                    </div>':""}\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="announceDataId" class="full"></div>\n    ${holidayOne()}\n    ${onBordingMandotryVideo()}`}function holidayOne(){return'\n    <div class="modal fade calendarbox" id="holiday1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-modal="true">\n        <div class="modal-dialog" role="document">\n            <div class="modal-content">\n                <div class="modal-header pt-2 pb-2 theme-bg text-white">\n                    <h5 class="modal-title" id="calendarbox_title"></h5>\n                    <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">\n                        <span aria-hidden="true">X</span>\n                    </button>\n                </div>\n                <div class="modal-body">\n                    <p class="activity_type"><b><span class="activity"></span></b></p>\n                </div>\n            </div>\n        </div>\n    </div>'}function batchImpAnnouncementModal(){return`<div id="batchImpAnnouncementModal" class="modal fade bd-example-modal-lg fade-scale" data-backdrop="static" data-keyboard="false" tabindex="" role="dialog">\n                <input type="hidden" id="batchStudentMappingId">\n                <input type="hidden" id="batchStudentMappingId">\n                <div class="modal-dialog modal-dialog-centered box-shadow-none" role="document" style="max-width: 715px;">\n                    <div class="modal-content">\n                        <div class="modal-header py-2 bg-primary">\n                            <h5 class="modal-title text-white text-left">Important Announcement</h5>\n                        </div>\n                        <div class="modal-body">\n                            <h6 class="font-weight-semi-bold text-justify text-primary" style="line-height: 26px;">Our Group Learning batch for UTC+ time zone starts on Sept 18, 2024 and for UTC- time zone starts on Sep 25, 2024! To secure your enrollment please make sure to pay the full fee at the earliest. Don't miss out - enroll today!</h6>\n                            <h6 class="d-flex flex-wrap align-items-center justify-content-start font-weight-semi-bold  mt-3 fullView" style="gap:10px">\n                                For any queries regarding enrollment, please\n                                <a target="_blank" href="https://chat.internationalschooling.org/onboarding-support?uuid=${UNIQUEUUID}" class="notify-bell-chat d-flex justify-content-center align-items-center group position-relative" style="width: fit-content;">\n                                    <svg class="chat-logo bg-primary" width="35" height="35" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                        <path d="M16.0156 16.0156V16.7969C16.0156 17.4414 15.4883 17.9688 14.8438 17.9688H7.61719L7.42188 18.125L4.88281 20.0781V17.9688H3.32031C2.67578 17.9688 2.14844 17.4414 2.14844 16.7969V8.59375C2.14844 7.94922 2.67578 7.42188 3.32031 7.42188H7.8125V6.64062H3.32031C2.24609 6.64062 1.36719 7.51953 1.36719 8.59375V16.7969C1.36719 17.8711 2.24609 18.75 3.32031 18.75H4.10156V21.6797L7.89063 18.75H14.8438C15.918 18.75 16.7969 17.8711 16.7969 16.7969V16.0156H16.0156Z" fill="white"/>\n                                        <path d="M21.6797 4.29688C22.3242 4.29688 22.8516 4.82422 22.8516 5.46875V13.6719C22.8516 14.3164 22.3242 14.8438 21.6797 14.8438H20.1172V16.9727L17.5781 15.0195L17.3828 14.8438H10.1562C9.51172 14.8438 8.98438 14.3164 8.98438 13.6719V5.46875C8.98438 4.82422 9.51172 4.29688 10.1562 4.29688H21.6797ZM21.6797 3.51562H10.1562C9.08203 3.51562 8.20312 4.39453 8.20312 5.46875V13.6719C8.20312 14.7461 9.08203 15.625 10.1562 15.625H17.1094L20.8984 18.5547V15.625H21.6797C22.7539 15.625 23.6328 14.7461 23.6328 13.6719V5.46875C23.6328 4.39453 22.7539 3.51562 21.6797 3.51562Z" fill="white"/>\n                                    </svg>\n                                    <span class="chat-message" style="box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, .5) !important;padding:8px 5px 8px 22px">\n                                        Talk to School Administration\n                                    </span>\n                                    <span class="UNSEEN start-100 translate-middle badge position-absolute"></span>\n                                </a>\n                            </h6>\n                        </div>\n                        <div class="modal-footer justify-content-center">\n                            <button type="button" class="btn bg-primary text-white btn-shadow float-right px-4 b-4" onclick="updateAnnouncementAcknowledgeStatus();">Acknowledge & Close</button>\n                        </div>\n                    </div>\n                </div>\n            </div>`}function onBordingMandotryVideo(){return'\n            <div class="modal fade fade-scale" id="mandatoryVideoModal" data-backdrop="static">\n            <div class="modal-dialog modal-lg modal-dialog-centered box-shadow-none" role="document">\n                <div class="modal-content text-center">\n                    <div class="modal-header pt-2 pb-2 bg-primary text-white justify-content-center">\n                        <h5 class="heading">Welcome! '+USER_FULL_NAME+'</h5>\n                    </div>\n                    <div class="modal-body d-flex flex-wrap px-1 full pt-1">\n                        <div class="d-flex w-100 my-2">\n                            <div class="header-dots mr-0 position-relative ml-auto" style="min-width: 60px;">\n                                <a target="_blank" href="https://chat.internationalschooling.org/signIn?uuid='+UNIQUEUUID+'" class="notify-bell-chat d-flex justify-content-center align-items-center group">\n                                    <svg class="chat-logo bg-primary" width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                        <path d="M16.0156 16.0156V16.7969C16.0156 17.4414 15.4883 17.9688 14.8438 17.9688H7.61719L7.42188 18.125L4.88281 20.0781V17.9688H3.32031C2.67578 17.9688 2.14844 17.4414 2.14844 16.7969V8.59375C2.14844 7.94922 2.67578 7.42188 3.32031 7.42188H7.8125V6.64062H3.32031C2.24609 6.64062 1.36719 7.51953 1.36719 8.59375V16.7969C1.36719 17.8711 2.24609 18.75 3.32031 18.75H4.10156V21.6797L7.89063 18.75H14.8438C15.918 18.75 16.7969 17.8711 16.7969 16.7969V16.0156H16.0156Z" fill="white"/>\n                                        <path d="M21.6797 4.29688C22.3242 4.29688 22.8516 4.82422 22.8516 5.46875V13.6719C22.8516 14.3164 22.3242 14.8438 21.6797 14.8438H20.1172V16.9727L17.5781 15.0195L17.3828 14.8438H10.1562C9.51172 14.8438 8.98438 14.3164 8.98438 13.6719V5.46875C8.98438 4.82422 9.51172 4.29688 10.1562 4.29688H21.6797ZM21.6797 3.51562H10.1562C9.08203 3.51562 8.20312 4.39453 8.20312 5.46875V13.6719C8.20312 14.7461 9.08203 15.625 10.1562 15.625H17.1094L20.8984 18.5547V15.625H21.6797C22.7539 15.625 23.6328 14.7461 23.6328 13.6719V5.46875C23.6328 4.39453 22.7539 3.51562 21.6797 3.51562Z" fill="white"/>\n                                    </svg>\n                                    <span class="chat-message" style="box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.5) !important;">Talk to School Administration</span>\n                                    <span class="UNSEEN start-100 translate-middle badge position-absolute"></span>\n                                </a>\n                            </div>\n                        </div>\n                        <div class="full">\n                            <div id="player"></div>\n                        </div>\n                    </div>\n                    <div class="modal-footer">\n                        <button href="javascript:void(0)" id="play-again-btn" class="btn btn-outline-gray" onclick="playAgain()" disabled>Watch Again</button>\n                        <button href="javascript:void(0)" id="moveToTimePreferencePopup" class="btn btn-gray" disabled>Book System Training</button>\n                    </div>\n                </div>\n            </div>\n        </div>'}function onYouTubeIframeAPIReady(e){window.YT.ready((function(){flagWatchVideo?player1=new YT.Player("player1",{height:"390",width:"100%",videoId:e,playerVars:{modestbranding:1,rel:0,iv_load_policy:3,fs:0,cc_load_policy:0,disablekb:1,playsinline:1,autohide:1}}):player=new YT.Player("player",{height:"390",width:"100%",videoId:e,playerVars:{modestbranding:1,rel:0,iv_load_policy:3,fs:0,cc_load_policy:0,disablekb:1,playsinline:1,autohide:1},events:{onStateChange:onPlayerStateChange}})}))}function onPlayerStateChange(e){if(e.data==YT.PlayerState.ENDED){customLoader(!0),flagWatchVideo=!0,$("#play-again-btn").removeClass("btn-outline-gray"),$("#play-again-btn").addClass("btn-outline-primary"),$("#moveToTimePreferencePopup").removeClass("btn-gray"),$("#moveToTimePreferencePopup").addClass("btn-primary"),$("#moveToTimePreferencePopup, #play-again-btn").attr("disabled",!1);var n={flagWatchVideo:"Y"};n.userId=USER_ID,n.studentStandardId=$("#timeStuStandardId").val(),n.schoolId=SCHOOL_ID,$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","update-vedio-watched-status"),data:JSON.stringify(n),dataType:"json",async:!0,success:function(e){"0"==e.status||"2"==e.status||"3"==e.status?"3"==e.status?redirectLoginPage():showMessageTheme2(0,e.message,"",!0):customLoader(!1)},error:function(e){customLoader(!1)}})}}function playAgain(){player.seekTo(0),player.playVideo()}function studentGraduationCeremontPopup(){return'<div class="modal fade" id="graduationCeremonyModal" tabindex="-1" role="dialog" aria-labelledby="graduationCeremonyLabel" aria-hidden="true">\n            <div class="modal-dialog modal-lg modal-dialog-centered box-shadow-none" role="document">\n                <div class="modal-content shadow-lg rounded-4 border-0">\n                    <div class="modal-header p-0 bg-white border-0">\n                        <button type="button" class="text-white btn btn-sm btn-danger d-flex ml-auto mr-2 mt-2 rounded-circle" data-dismiss="modal" aria-label="Close" style="font-size: 16px !important; margin: 0;">\n                            <i class="fa fa-times" aria-hidden="true"></i>\n                        </button>\n                    </div>\n                    <div class="modal-body px-5 pt-2 pb-4">\n                        <div class="d-flex align-items-center">\n                            <div class="text-center text-lg-start mb-4 mb-lg-0">\n                                <h4 class="mb-3 font-weight-bold text-dark">\n                                    We are Celebrating our <span class="text-primary">First Graduation Ceremony 2025</span>\n                                    <i class="fa fa-graduation-cap text-dark" aria-hidden="true"></i>\n                                </h4>\n                                <p class="mb-4" style="font-size:16px;">\n                                    We are here to honor your hard work, celebrate your academic excellence,\n                                    and applaud your holistic growth — the journey that shaped you into who you are today.\n                                </p>\n                                <a href="https://join.internationalschooling.org/event-form" target="_blank" class="btn btn-primary px-4 py-2 rounded-10 font-weight-bold scale-btn-animate" style="font-size:14px;">\n                                    Fill Form to Join →\n                                </a>\n                            </div>\n                    </div>\n                </div>\n            </div>\n        </div>'}