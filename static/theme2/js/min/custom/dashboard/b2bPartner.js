function callStudentListByPartner(e){var t=!1;null!=$("#"+e+" #partnerName").val()&&""!=$("#"+e+" #partnerName").val()&&(t=!0),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-student-enrolled-partner"),data:JSON.stringify(getRequestForPartnerEnrolledList(e)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if(console.log(e),"0"==e.status||"2"==e.status)showMessageTheme2(!1,e.message),$("#enroll-list-skeleton").show();else{$("#enroll-list-skeleton").hide();var a=B2BStudentListDetails(e.studentList,t);$("#enrolled-list").html(a),$(".follow-up-no").click((function(){$(this).find(".fa-angle-down").toggleClass("fa-angle-down fa-angle-up"),$(this).parent().siblings().find(".fa-angle-up").toggleClass("fa-angle-up fa-angle-down"),$(this).parent().find(".follow-up-content").slideDown(),$(this).parent().siblings().find(".follow-up-content").slideUp(),$(this).parent().addClass("follow-up-accordian-active"),$(this).parent().siblings().removeClass("follow-up-accordian-active")}));var n=B2BStudentListCommission(e.studentList);$(".studentCommitionList").html(n),$("#totalCommissionDate").text(e.currentDate)}},error:function(e){console.log(e)}})}function getRequestForPartnerEnrolledList(e){var t={},a={};if(null!=$("#"+e+" #partnerName").val()&&""!=$("#"+e+" #partnerName").val()?a.counselorId=$("#"+e+" #partnerName").val():""!=$("#"+e+" #referralCode").val()?a.counselorId=USER_ID:a.counselorId=0,a.userId=USER_ID,a.schoolId=SCHOOL_ID,a.referralCode=$("#"+e+" #referralCode").val(),a.academicYear=$("#"+e+" #academicYear option:selected").text(),a.enrollmentStatus=$("#"+e+" #enrollmentStatus").val(),a.gradeId=$("#"+e+" #gradeId").val(),a.studentName=$("#"+e+" #studentName").val(),a.email=$("#"+e+" #email").val(),a.countryId=$("#"+e+" #countryId").val(),a.stateId=$("#"+e+" #stateId").val(),a.cityId=$("#"+e+" #cityId").val(),a.commissionStatus=$("#"+e+" #commissionStatus").val(),a.learningProgram=$("#"+e+" #learningProgram").val(),null!=$("#"+e+" #paymentDateFrom").val()&&""!=$("#"+e+" #paymentDateFrom").val()){var n=$("#"+e+" #paymentDateFrom").val();a.paymentDateFrom=n}if(null!=$("#"+e+" #paymentDateTo").val()&&""!=$("#"+e+" #paymentDateTo").val()){var r=$("#"+e+" #paymentDateTo").val();a.paymentDateTo=r}return a.paymentStatus=$("#"+e+" #paymentStatus").val(),a.sortBy=$("#"+e+" #sortBy").val(),a.feeStatus=$("#"+e+" #feeStatus").val(),a.pageSize=$("#"+e+" #pageSize").val(),t.enrollmentListFilterDTO=a,t}function callPartnerCountries(e,t,a,n){return $("#"+e+" #"+a).html('<option value="">Select country</option>'),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"COUNTRIES-LIST",t)),dataType:"json",async:!1,success:function(t){if("0"==t.status||"2"==t.status)showMessage(1,t.message);else{var r=t.mastersData.countries;$.each(r,(function(t,r){$("#"+e+" #"+a).append('<option dailCode="'+r.extra1+'" dail-country-code="'+r.extra+'" value="'+r.key+'" '+(n==r.key?"selected":"")+">"+r.value+"</option>")}))}}}),!0}function getRequestForPartnerCommissionRate(e,t,a,n){""!=t&&null!=t||(t=USER_ID);var r={},s={};return s.hash=getHash(),s.schoolId=SCHOOL_ID,s.schoolUUID=SCHOOL_UUID,s.userType=USER_ROLE,s.userId=t,s.learningProgram=a,s.enrollmentFor=n,r.authentication=s,r}function getPartnerCommissionRate(e,t,a){return new Promise((function(t,n){$.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/get-partner-commission-rate",data:JSON.stringify(getRequestForPartnerCommissionRate(e,a)),dataType:"json",global:!0,success:function(e){if("0"==e.status||"2"==e.status||"3"==e.status)return"3"==e.status&&redirectLoginPage(),n();t(e)},error:function(e,t,a){checkonlineOfflineStatus()||(console.error("Error: "+a),n(a))}})}))}function getPartnerCommissionRateHtml(e){var t="";if(null!=e&&e.length>0)for(let n=0;n<e.length;n++){const r=e[n];var a=r.min_range+"+";r.max_range>0&&(a=r.min_range+"-"+r.max_range),t=t+'<tr class="td-border-design"><td style="border-width:1px;border-color:#eee">'+r.standardName+'</td><td style="border-width:1px;border-color:#eee">'+r.learningProgramValue+'</td><td style="border-width:1px;border-color:#eee">'+r.byPartnerValue+" "+r.byPartnerType+'</td><td style="border-width:1px;border-color:#eee">'+r.bySchoolValue+" "+r.bySchoolType+'</td><td style="border-width:1px;border-color:#eee" class="text-center">'+a+'</td><td style="border-width:1px;border-color:#eee">'+r.startDate+'</td><td style="border-width:1px;border-color:#eee">'+("Dec 31, 2999"==r.endDate?"N/A":r.endDate)+"</td></tr>"}return t}function callPartnerListBy(e,t){var a={};a.userId=USER_ID,$("#"+e+" #"+t).html('<option dail-referral-code="" value="">Select Partner</option>'),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-partner-list"),data:JSON.stringify(a),dataType:"json",cache:!1,timeout:6e5,success:function(a){if(console.log(a),"0"==a.status||"2"==a.status);else{var n=a.partnerList;$.each(n,(function(a,n){$("#"+e+" #"+t).append('<option dail-referral-code="'+n.extra+'" value="'+n.key+'">'+n.value+"</option>")}))}},error:function(e){console.log(e)}})}function updateStudentPartnerCommissionRate(e,t,a,n,r){var s={},o=[];if(""==e)$(".commission_list").each((function(){var e=$(this).attr("id");if($("#checkCommission"+e).is(":checked")){var t=$(this).attr("data-commission"),a=$(this).attr("data-commission-rate"),n={};n.userId=USER_ID,n.studentStandardId=e,n.updateStatus=$("#commissionStatus"+e).val(),n.amount=t,n.commRate=a,o.push(n)}}));else{var l={};l.userId=USER_ID,l.studentStandardId=e,l.updateStatus=t,l.amount=a,l.commRate=n,o.push(l)}return s.dataList=o,s.totalAmount=""==a?$("#totalCommission").text():a.replace("$ ",""),s.referralCode=""==r?$("#referralCode").val():r,$.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/save-transfer-payment",data:JSON.stringify(s),dataType:"json",async:!1,global:!1,success:function(e){console.log(e),"0"==e.status||"2"==e.status||"3"==e.status?"3"==e.status?redirectLoginPage():showMessageTheme2(0,e.message):(showMessageTheme2(1,e.message),$("#updateTransferCommission").modal("hide"),callStudentListByPartner("partnerEnrollFilterForm"))},error:function(e){checkonlineOfflineStatus()}}),!0}function resetEnrollmentForm(e){$("#"+e+" #academicYear").val("0").trigger("change"),$("#"+e+" #partnerName").val("").trigger("change"),$("#"+e+" #enrollmentStatus").val("").trigger("change"),$("#"+e+" #gradeId").val("").trigger("change"),$("#"+e+" #countryId").val("").trigger("change"),$("#"+e+" #stateId").val("").trigger("change"),$("#"+e+" #cityId").val("").trigger("change"),$("#"+e+" #commissionStatus").val("").trigger("change"),$("#"+e+" #learningProgram").val("").trigger("change"),$("#"+e+" #paymentStatus").val("").trigger("change"),$("#"+e+" #feeStatus").val("").trigger("change"),$("#"+e+" #sortBy").val("Desc").trigger("change"),$("#"+e+" #studentName").val(""),$("#"+e+" #email").val(""),$("#"+e+" #pageSize").val("25"),$("#"+e+" #paymentDateFrom").val("").datepicker("upadate"),$("#"+e+" #paymentDateTo").val("").datepicker("upadate")}function getCallTotalCommission(){var e=0;return $(".commission_list").each((function(){var t=$(this).attr("id");if($("#checkCommission"+t).is(":checked")){var a=$(this).attr("data-commission");$(this).attr("data-commission-rate");a=a.replace("$ ",""),e+=parseFloat(a)}})),e}function getRequestForPartnerDetails(e,t){""!=t&&null!=t||(t=USER_ID);var a={},n={};return n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userType=USER_ROLE,n.userId=t,a.authentication=n,a}function getPartnerDashboardDetails(e){var t={};return $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/partner-content",data:JSON.stringify(getRequestForPartnerDetails(e)),dataType:"json",async:!1,global:!1,success:function(e){"0"==e.status||"2"==e.status||"3"==e.status?"3"==e.status&&redirectLoginPage():t=e},error:function(e){checkonlineOfflineStatus()}}),t}function getPartnerDashboardDetailsData(e){var t={};return $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/partner-learning-program-content",data:JSON.stringify(getRequestForPartnerDetails(e)),dataType:"json",async:!1,global:!1,success:function(e){"0"==e.status||"2"==e.status||"3"==e.status?"3"==e.status&&redirectLoginPage():t=e},error:function(e){checkonlineOfflineStatus()}}),t}function getCommissionRatesChart(e,t,a,n){var r=100,s=100;a>0&&(r-=a),n>0&&(s-=n),s>r||(s=r);var o={chart:{type:"radialBar",height:200,sparkline:{enabled:!0}},plotOptions:{radialBar:{startAngle:-90,endAngle:90,track:{background:"#007fff",strokeWidth:"100%"},hollow:{margin:15,size:"75%"},dataLabels:{name:{show:!0,offsetY:0,fontSize:"13px",color:"#343a40",fontWeight:"300"},value:{show:!0,fontSize:"24px",fontWeight:"bold",offsetY:-35,formatter:function(e){return t}}}}},fill:{},colors:["#9747ff"],labels:["Enrollment Range"],series:[50]};new ApexCharts($("#"+e)[0],o).render(),$("#"+e).css({visibility:"visible",opacity:"1"})}function getRequestForReferralCodeAndLink(e,t){""!=t&&null!=t||(t=USER_ID);var a={},n={};return n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userType=USER_ROLE,n.userId=t,a.authentication=n,a}function getReferralCodeAndLinksDetails(e){var t={};return $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/referral-and-links",data:JSON.stringify(getRequestForReferralCodeAndLink(e)),dataType:"json",async:!1,success:function(e){t=e}}),t}function getEnrollmentChart(e,t,a){var n={series:a,labels:t,chart:{type:"donut",height:100},dataLabels:{enabled:!1},plotOptions:{pie:{donut:{size:"75%",style:{display:"none"},labels:{show:!0,name:{},total:{show:!0,label:"Total",fontSize:"13px",fontWeight:400}}}}},responsive:[{breakpoint:480,options:{chart:{height:150},legend:{show:!1,position:"bottom"}}}]},r=new ApexCharts(document.querySelector("#"+e),n);r.render(),r.update()}function getRequestForPartnerStudentGrade(e,t){""!=t&&null!=t||(t=USER_ID);var a={},n={};return n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userType=USER_ROLE,n.userId=t,a.authentication=n,a}function getPartnerStudentGrade(e,t,a,n,r){return $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/get-partner-student-list-gradewise",data:JSON.stringify(getRequestForPartnerCommissionRate(e,a,n,r)),dataType:"json",async:!1,global:!1,success:function(e){if("0"==e.status||"2"==e.status||"3"==e.status)"3"==e.status&&redirectLoginPage();else{if("ONE_TO_ONE"==n&&"enrollment"==r){var a=getRegisterDataByGrade(e,"one_to_one");getEnrollmentChart(t,a.lable,a.series)}else if("ONE_TO_ONE_FLEX"==n&&"enrollment"==r){var s=getRegisterDataByGrade(e,"f_one_to_one");getEnrollmentChart(t,s.lable,s.series)}else if("BATCH"==n&&"enrollment"==r){var o=getRegisterDataByGrade(e,"group");getEnrollmentChart(t,o.lable,o.series)}else if("SCHOLARSHIP"==n&&"enrollment"==r){var l=getRegisterDataByGrade(e,"self");getEnrollmentChart(t,l.lable,l.series)}else if("SSP"==n&&"enrollment"==r){var i=getRegisterDataByGrade(e,"ssp");getEnrollmentChart(t,i.lable,i.series)}else if("SSP"==n&&"exact-path-enrollment"==r){var d=getRegisterDataByGrade(e,"elpss");getEnrollmentChart(t,d.lable,d.series)}if("ONE_TO_ONE"==n&&"exact-path-enrollment"==r){var u=getRegisterDataByGrade(e,"el_one_to_one");getEnrollmentChart(t,u.lable,u.series)}else if("BATCH"==n&&"exact-path-enrollment"==r){var c=getRegisterDataByGrade(e,"el_group");getEnrollmentChart(t,c.lable,c.series)}else if("SCHOLARSHIP"==n&&"exact-path-enrollment"==r){var g=getRegisterDataByGrade(e,"el_self");getEnrollmentChart(t,g.lable,g.series)}else if("DUAL_DIPLOMA"==n&&"enrollment"==r){var p=getRegisterDataByGrade(e,"dual");getEnrollmentChart(t,p.lable,p.series)}}},error:function(e){checkonlineOfflineStatus()}}),!0}function getRegisterDataByGrade(e,t){var a=[],n=[],r=[],s=0,o="",l=0,i="",d=0,u="",c=0,g="",p=0,m="",f=0,h="",y=e.gradeWiseStudentList;if(y.length>0){for(let e=0;e<y.length;e++){const a=y[e];"dual"==t?4!=a.standard_id&&5!=a.standard_id&&6!=a.standard_id&&7!=a.standard_id||(s+=parseInt(a.totalStudent),o="Grade 9 - 12"):"el_one_to_one"==t||"el_self"==t?11==a.standard_id?(s+=parseInt(a.totalStudent),o="Basic | Beginner"):1==a.standard_id?(l+=parseInt(a.totalStudent),i="Middle | Intermediate"):4==a.standard_id&&(d+=parseInt(a.totalStudent),u="Pro | Advanced"):11==a.standard_id||12==a.standard_id||13==a.standard_id||14==a.standard_id||15==a.standard_id||16==a.standard_id?(s+=parseInt(a.totalStudent),o="Grade K - 5"):1==a.standard_id||2==a.standard_id||3==a.standard_id?(l+=parseInt(a.totalStudent),i="Grade 6 - 8"):4==a.standard_id||5==a.standard_id||6==a.standard_id||7==a.standard_id?(d+=parseInt(a.totalStudent),u="Grade 9 - 12"):9!=a.standard_id&&10!=a.standard_id&&19!=a.standard_id&&20!=a.standard_id&&21!=a.standard_id||(19==a.standard_id?(c+=parseInt(a.totalStudent),g="Grade K - 5"):9==a.standard_id?(p+=parseInt(a.totalStudent),m="Grade 6 - 8"):10!=a.standard_id&&20!=a.standard_id&&21!=a.standard_id||(f+=parseInt(a.totalStudent),h="Grade 9 - 12"))}return n="dual"==t?[s]:"f_one_to_one"==t?[c,p,f]:[s,l,d],r="dual"==t?[o]:"f_one_to_one"==t?[g,m,h]:[o,i,u],a.series=n,a.lable=r,a}}function applyDiscountMsgShow(e){if("0"==$("#"+e).val())$("#discountMsgTag").html(""),$("#discountMsgTag").hide(),$("#discountMsgTag").attr("data-discount-code",""),$("#discountMsgTag").attr("data-discount-value",""),$("#discountMsgTag").attr("data-discount-type","");else{var t="P"==$("#"+e+" option:selected").attr("discounttype")?"%":" USD";$("#discountMsgTag").html('<b class="full text-success">All enrollments links now have a '+$("#"+e).val()+t+" discount</b>"),$("#discountMsgTag").show(),$("#discountMsgTag").attr("data-discount-code",$("#"+e+" option:selected").attr("discountCode")),$("#discountMsgTag").attr("data-discount-value",$("#"+e).val()),$("#discountMsgTag").attr("data-discount-type",$("#"+e+" option:selected").attr("discounttype"))}}function callB2BDashboardLead(e,t){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","b2b-dashboard-lead"),data:JSON.stringify(getRequestForB2bDashboard(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else{var t=e.leadCountDetailDTO;""!=t.totalLeads&&$("#totalB2bLead").text(t.totalLeads),""!=t.totalConverted&&$("#convertB2bLead").text(t.totalConverted),""!=t.unattendedLead&&$("#unattendedB2bLead").text(t.unattendedLead),""!=t.followupLead1&&$("#positiveB2bLead").text(t.followupLead1)}},error:function(e){console.log(e)}})}function getRequestForB2bDashboard(e,t){var a={},n={};return n.schoolId=SCHOOL_ID,n.userId=USER_ID,n.moduleId=e,n.leadFrom="LEAD",n.clickFrom="list",n.currentPage=0,n.leadType=t,a.leadModifyDTO=n,a.leadModifyDetailDTO={},a.leadStudentDetailDTO={},a.leadDemoInfo={},a.leadCallFollowupDTO={},a.leadCountDetailDTO={},a}