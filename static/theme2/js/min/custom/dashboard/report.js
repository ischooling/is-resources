function schoolWiseReport(t){var e="/dashboard/school-data-reports?moduleId="+moduleId+"&schoolId="+t;getAsPost(e,"_self"),customLoader(!1)}function getReportData(t){console.log("Content for : ",t),"LIVE-SCHOOL"==t?($("#errMsg").text(""),$("#liveSchoolTour").show(),$("#schoolListRpt").hide(),$("#teacherFreesessionSlot").hide()):"STUDENT-LIST"==t?($("#errMsg").text(""),$("#liveSchoolTour").hide(),$("#schoolListRpt").show(),$("#teacherFreesessionSlot").hide()):"TEACHER-FREE-SESSION"==t?($("#errMsg").text(""),$("#liveSchoolTour").hide(),$("#schoolListRpt").hide(),$("#teacherFreesessionSlot").show()):($("#errMsg").text(""),$("#liveSchoolTour").hide(),$("#schoolListRpt").hide(),$("#teacherFreesessionSlot").hide())}function getRequestForStudentReport(t,e,a,s){var d,r={};if(r.reportTitle=t,r.reportType=a,r.schoolId=SCHOOL_ID,r.loginUserId=USER_ID,r.callFrom=s,"search"==s){if(null!=$("#stdSerachschoolId").val()&&(r.schoolId=$("#stdSerachschoolId").val()),r.acSessionId=$("#academicYear").val(),null!=$("#enrollType").val()&&(r.enrollType=$("#enrollType").val()),null!=$("#standardId").val()&&(r.standardId=e),null!=$("#enrollType").val()&&(r.enrollType=$("#enrollType").val()),null!=$("#countryId").val()&&(r.countryId=$("#countryId").val()),null!=$("#stateId").val()&&(r.stateId=$("#stateId").val()),null!=$("#cityId").val()&&(r.cityId=$("#cityId").val()),""!=$("#stdStartDateSearch").val()&&null!=$("#stdStartDateSearch").val()){var l=$("#stdStartDateSearch").val(),o=l.split("-")[2]+"-"+l.split("-")[0]+"-"+l.split("-")[1];r.startDate=o}if(""!=$("#stdEndDateSearch").val()&&null!=$("#stdEndDateSearch").val()){var n=$("#stdEndDateSearch").val(),c=n.split("-")[2]+"-"+n.split("-")[0]+"-"+n.split("-")[1];r.endDate=c}null!=$("#datetype").val()&&(r.datetype=$("#datetype").val()),null!=$("#selectReportData").val()&&(r.selectReportData=$("#selectReportData").val()),null!=$("#studentEmail").val()&&(r.emailid=$("#studentEmail").val()),null!=$("#studentName").val()&&(r.studentName=$("#studentName").val()),null!=$("#standardId").val()&&(r.standardId=$("#standardId").val())}else r.acSessionId=$("#acSessionId").val(),r.standardId=e,r.schoolId=SCHOOL_ID;"countrywise"==t&&((d=e.split("-")).length>1&&(r.standardId=d[0],r.countryId=d[1]));if("monthwise"==t&&(d=e.split("-")).length>1){r.standardId=d[0];var i=new Date(d[1]+"-"+d[2]+"-01"),u=new Date(i.getFullYear(),i.getMonth(),1),h=new Date(i.getFullYear(),i.getMonth()+1,0);o=u.getFullYear()+"-"+(u.getMonth()+1)+"-"+u.getDate();r.startDate=o;var m=h.getFullYear()+"-"+(h.getMonth()+1)+"-"+h.getDate();r.endDate=m}return r}function getReportStudentCount(t,e,a,s){""==s&&(s=$("#callfrom").val()),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","report-enrolled-student"),data:JSON.stringify(getRequestForStudentReport(t,e,a,s)),dataType:"json",cache:!1,timeout:6e5,async:!0,success:function(e){if(console.log(e),"0"==e.status||"2"==e.status||"FAILED"==e.statusResponse.status||"3"==e.status)"3"==e.status?redirectLoginPage():"theme2"==tt?$("#adminStudentReport").append(""):tt;else if("group"==a){var d="";d="countrywise"==t||"monthwise"==t?reportStudentCounty(e.adminStudentReportList,t):reportStudentGrade(e.adminStudentReport,t),$("."+t).html(""),$("."+t).append(d),"search"==s&&$("#studentReportAdvanceSearch").modal("hide")}else{var r="";r="countrywise"==t||"monthwise"==t?reportStudentGradeList(e.adminStudentReportList[0]):"end-semester"==t?reportEndSemStudentList(e.endStudentEndSemesterList):reportStudentGradeList(e.adminStudentReport),"end-semester"==t?($("#reportEndSemesterTable").dataTable().fnClearTable(),$("#reportEndSemesterTable").dataTable().fnDraw(),$("#reportEndSemesterTable").dataTable().fnDestroy(),$("#student_list_end_semester").html(""),$("#student_list_end_semester").html(r),$("#reportEndSemesterTable").DataTable(),$("#studentReportAdvanceSearch").modal("hide")):($("#filterStudentList").html(""),$("#filterStudentList").html(r),$("#studentReportListPopup").modal("show"),$("#stdReportList").dataTable().fnDestroy(),$("#stdReportList").DataTable({columnDefs:[{targets:[0],orderable:!1}],order:[[1,"asc"]]}),callCheckboxAll())}},error:function(t){"theme2"==tt?showMessageTheme2(2,TECHNICAL_GLITCH,"",!0):"theme1"==tt&&showMessage(!0,TECHNICAL_GLITCH)}})}function reportStudentGrade(t,e){var a=t.adminStudentGradeReport,s="",d="";if(null!=a&&a.length>0){for(s='<td class="bold">'+t.reportTitle+"</td>",md=0;md<a.length;md++){var r=0==a[md].totalStudent?"-":a[md].totalStudent,l="getReportStudentCount('"+e+"','"+a[md].standardId+"','list','');";if("-"==r)d+='<td class="text-center">-</td>';else{var o="text-dark";"enrolled"!=e&&"fresh"!=e&&"nextgrade"!=e&&"enrolled-adv"!=e&&"partial-pay"!=e&&"bookseat-adv"!=e&&"bookseat"!=e&&"repeatgrade"!=e&&"flexgrade"!=e&&"migrate-same-session"!=e||(o="text-white"),d+='<td class="text-center"><a href="javascript:void(0);" onclick="'+l+'" class="'+o+'">'+r+"</a></td>"}}var n="text-dark";"enrolled"!=e&&"fresh"!=e&&"nextgrade"!=e&&"enrolled-adv"!=e&&"partial-pay"!=e&&"bookseat-adv"!=e&&"bookseat"!=e&&"repeatgrade"!=e&&"flexgrade"!=e&&"migrate-same-session"!=e||(n="text-white"),s+='<td class="text-center"><a href="javascript:void(0);" onclick="'+("getReportStudentCount('"+e+"','','list','');")+'" class="'+n+'">'+t.totalStudent+"</a></td>"}return s+d}function reportStudentCounty(t,e){var a="";if(null!=t&&t.length>0)for(c=0;c<t.length;c++){var s="getReportStudentCount('"+e+"','0-"+t[c].reportid+"','list','');";a+="<tr>",a+='<td class="bold">'+t[c].reportTitle+"</td>",a+='<td class="text-center"><a href="javascript:void(0);" onclick="'+s+'">'+t[c].totalStudent+"</a></td>";var d=t[c].adminStudentGradeReport,r="";if(null!=d&&d.length>0){for(md=0;md<d.length;md++){var l=0==d[md].totalStudent?"-":d[md].totalStudent,o="getReportStudentCount('"+e+"','"+d[md].standardId+"-"+t[c].reportid+"','list','');";if("-"==l)r+='<td class="text-center">-</td>';else{r+='<td class="text-center"><a href="javascript:void(0);" onclick="'+o+'" class="text-dark">'+l+"</a></td>"}}a+=r}a+="</tr>"}return a}function reportStudentGradeList(t){console.log(t),$("#gradeStudentTitle").html(t.reportTitle);var e=t.adminStudentGradeReport,a="",s="";if(e.length>0)for(md=0;md<e.length;md++){var d='<input type="checkbox" class="checkUserid" value="'+e[md].userid+'"/>';"Y"==e[md].leadStatus&&(d=""),s="REGISTRATION_FRESH"==e[md].enrollType||"REGISTRATION_REGISTER"==e[md].enrollType||"REGISTRATION_FLEX_COURSE"==e[md].enrollType?"Fresh":"Progression",a+="<tr>",a+='<td class="text-center">&nbsp;&nbsp;'+d+"</td>",a+='<td class="text-left">'+e[md].stdName+"</td>",a+='<td class="text-left">'+e[md].email+"</td>",a+='<td class="text-left">'+e[md].grade+"</td>",a+='<td class="text-left">'+e[md].registername+"</td>",a+='<td class="text-left">'+s+"</td>",a+="</tr>"}return a}function reportEndSemStudentList(t){var e="",a=1;if(t.length>0)for(md=0;md<t.length;md++){var s=t[md];e+="<tr>",e+='<td class="text-center">'+a+"</td>",e+='<td class="text-left">'+s.rollno+"<br/>"+s.stdName+"</td>",e+='<td class="text-left">'+s.stdEmail+"<br/>+"+s.stdPhoneNo+"<br/>"+s.cityName+" | "+s.countryName+"</td>",e+='<td class="text-left">'+s.standardName+" | "+s.registerType+"</td>",e+='<td><span class="text-left">'+s.enrollStart+" - "+s.enrollEnd+"</span> "+(s.dueDays<0?"<br/>overdue by":"")+' <span style="font-size:14px;" class="float-right bold '+(s.dueDays>0?"text-success":"text-danger")+'">'+s.dueDays+"</span></td>",e+="</tr>",a+=1}return e}function callCheckboxAll(){$("#select_all_user").on("click",(function(){var t="";this.checked?$(".checkUserid").each((function(){this.checked=!0,t=t+","+$(this).val()})):$(".checkUserid").each((function(){this.checked=!1,t=t.replace(","+$(this).val(),"")})),$("#stdLeadNoMove").val(t)})),$(".checkUserid").on("click",(function(){var t=$("#stdLeadNoMove").val();$(".checkUserid:checked").length==$(".checkUserid").length?$("#select_all_user").prop("checked",!0):$("#select_all_user").prop("checked",!1),t=this.checked?t+","+$(this).val():t.replace(","+$(this).val(),""),$("#stdLeadNoMove").val(t)}))}function moveStudentToLead(t){t?hideMessageTheme2(""):hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","student-move-tolead"),data:JSON.stringify(getRequestForMoveStudentData()),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?t?showMessageTheme2(0,e.message,"",!0):showMessage(!0,e.message):t?(showMessageTheme2(1,e.message,"",!1),$("#stdLeadNoMove").val(""),$("#moveStudentAsLeads").modal("hide")):(showMessage(!0,e.message),$("#stdLeadNoMove").val(""),$("#moveStudentAsLeads").modal("hide")),!1},error:function(t){return!1}})}function getRequestForMoveStudentData(){var t={},e={},a={},s=$("#stdLeadNoMove").val(),d={};return d.leadNo=s.substring(1,s.lenght),d.assignTo=$("#leadStudentAssignMove").val(),a.leadModifyDTO=d,e.hash=getHash(),e.schoolId=SCHOOL_ID,e.schoolUUID=SCHOOL_UUID,e.userId=USER_ID,e.userType="COMMON",t.authentication=e,t.leadCommonDTO=a,t}function getRequestForUserLogHistory(t,e,a,s){var d={};return d.userId=e,d.reportTitle=t,d.schoolId=SCHOOL_ID,d.callFrom=s,d}function getUserLogHistory(t,e,a,s){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","user-logs-history"),data:JSON.stringify(getRequestForUserLogHistory(t,e,a,s)),dataType:"json",cache:!1,timeout:6e5,async:!0,success:function(e){if("0"==e.status||"2"==e.status||"3"==e.status)"3"==e.status?redirectLoginPage():"theme2"==tt||tt;else{var a=userLogList(e.usersLogList,t);$("."+t).html(""),$("."+t).append(a),$("#"+t).dataTable().fnDestroy(),$("#"+t).DataTable()}},error:function(t){"theme2"==tt?showMessageTheme2(2,TECHNICAL_GLITCH,"",!0):"theme1"==tt&&showMessage(!0,TECHNICAL_GLITCH)}})}function userLogList(t,e){var a="",s=1;if(t.length>0)for(md=0;md<t.length;md++){if(a+="<tr>",a+='<td class="text-center">&nbsp;&nbsp;'+s+++"</td>",a+='<td class="text-left">'+t[md].columnName+"</td>",a+='<td class="text-left">'+t[md].prevValue+"</td>","selected-course_history"==e)a+='<td class="text-left">'+highlight(""+t[md].changeValue,""+t[md].prevValue)+"</td>";else a+='<td class="text-left">'+t[md].changeValue+"</td>";a+='<td class="text-left">'+t[md].changeBy+"</td>",a+='<td class="text-left">'+t[md].changeDate+"</td>",a+="</tr>"}return a}function highlight(t,e){var a="",s=t.split(",");if(s.length>0)for(var d=0;s.length>d;d++)e.includes($.trim(s[d]))?a+=", "+s[d]:(a+=' <span style="background-color:yellow;">',a+=s[d],a+="</span>");return a.substr(1,a.length)}$("#startDate").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#endDate").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#studStartDate").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#studEndDate").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#startDateTeacher").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#endDateTeacher").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#paymentStartDate").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#paymentEndDate").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#startDateTeacherC").datepicker({autoclose:!0,format:"mm-dd-yyyy"}),$("#endDateTeacherC").datepicker({autoclose:!0,format:"mm-dd-yyyy"});