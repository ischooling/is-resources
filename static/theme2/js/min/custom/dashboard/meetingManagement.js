var currentPageOneDay=1,currentPageRecurring=1,currentPageRecurringRecording=1,currentTabId="oneDayMeetings",selectedHostKey=null,selectedRole=null,selectedHostName=null,selectedHostTimezone=null,selectedHostTimezoneName=null,selectedHostTimezoneUTC=null,isHaveRecurringMeetings=null,hostsData=getHostsOnly();const allowedUsers=getSettingsByTypeAndKey("CONFIGURATION","ALLOW_SEEING_ALL_MEETINGS");var allowedUserIds=JSON.parse(allowedUsers).data.metaValue.split(",").map((e=>e.trim()));const isUserAllowed=allowedUserIds.includes(USER_ID.toString());var selectedAttendees=[],cachedUserList=[],recordingTitle=null,timeOptions=[],getRecordingLimit=getSettingsByTypeAndKey("CONFIGURATION","SHOW_RECORDINGS_LIMIT"),recordingLimit=(getRecordingLimit=JSON.parse(getRecordingLimit)).data.metaValue;const isUserAllowedRecordings=fetchUserIdToShowRecordings();for(let e=0;e<24;e++)for(let t=0;t<60;t+=5){let n=e.toString().padStart(2,"0")+t.toString().padStart(2,"0");timeOptions.push(n)}function updateAvailableTimes(){const e=changeDateFormat(convertTZ(new Date,selectedHostTimezoneName??USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss"),[t,n]=e.split(" "),[a,i]=n.split(":").map(Number),o=60*a+i,r=$("#when").datepicker("getDate"),s=$("#hour"),l=$("#ampm");s.empty(),l.empty();const d=r&&changeDateFormat(r,"yyyy-mm-dd")===t,c=timeOptions.filter((e=>{const t=parseInt(e.substring(0,2),10),n=parseInt(e.substring(2),10);return!d||60*t+n>o}));c.forEach((e=>{const t=formatTime(e);s.append($("<option>",{value:e,text:t}))}));[...new Set(c.map((e=>parseInt(e.substring(0,2),10)<12?"AM":"PM")))].forEach((e=>{l.append($("<option>",{value:e,text:e}))})),s.on("change",(function(){const e=$(this).val(),t=parseInt(e?.substring(0,2),10)<12?"AM":"PM";l.empty(),l.append($("<option>",{value:t,text:t}))})),s.trigger("change")}function formatTime(e){const t=parseInt(e.substring(0,2),10);return`${t%12==0?12:t%12}:${e.substring(2)} ${t<12?"AM":"PM"}`}function saveFilterState(){var e=getFilterState();let t=$("#filterHostUserId").val();Array.isArray(t)||(t=t?[t]:[]),e.filterHostUserId=t.join(","),e.filterGeneralMeetingType=$("#filterGeneralMeetingType").val(),e.filterDateDuration=$("#filterDateDuration").val(),e.filterMeetingStartDate=$("#filterMeetingStartDate").val(),e.filterMeetingEndDate=$("#filterMeetingEndDate").val()}function fetchMetaValue(){try{"false"==getSettingsByTypeAndKey("CONFIGURATION","SHOW_RECURRING_MEETINGS")&&($('label:contains("Recurring meeting")').hide(),$("#recurringTab").hide())}catch(e){console.error("Error retrieving settings:",e)}}function fetchUserIdToShowRecurringMeeting(){try{const e=getSettingsByTypeAndKey("CONFIGURATION","RECURRING_ACCESS_USERS"),t=JSON.parse(e).data.metaValue.split(",").map((e=>e.trim())).includes(USER_ID.toString());t||($('label:contains("Recurring meeting")').hide(),$("#recurringTab").hide()),!t&&isHaveRecurringMeetings>0&&($("#recurringTab").show(),$(".trRecur").removeClass("hover-blue"),$(".tdRecur").removeClass("hover-blue"),$(".tdRecur").attr("style","cursor: auto !important;padding-left: 12px !important;"),$(".tdRecur").off("click").removeAttr("onclick"),$(".tdBtns").attr("style","display: none;"),$(".meetingHostNameTd").attr("style","display: none;"),$(".btnRecur").attr("disabled","true"),$(".btnRecur").css("display","none"),"recurringMeetings"==currentTabId&&($("#scheduleMeetingBtn").hide(),$(".tabs").css("height","60px")))}catch(e){console.error("Error retrieving settings:",e)}}function fetchUserIdToShowRecordings(){try{const e=getSettingsByTypeAndKey("CONFIGURATION","ALL_RECORDINGS_ACCESS_USERS");return JSON.parse(e).data.metaValue.split(",").map((e=>e.trim())).includes(USER_ID.toString())}catch(e){console.error("Error retrieving settings:",e)}}async function fetchUserIdToShowAllMeeting(){customLoader(!0);try{if(isUserAllowed)$("#filterHostUserId").select2({placeholder:"Select Hosts",allowClear:!0,multiple:!0});else{$("<style>").prop("type","text/css").html("\n          #select2-host-container{\n            cursor: not-allowed !important;\n          }\n          #select2-filterHostUserId-container{\n            cursor: not-allowed !important;\n          }\n        ").appendTo("head"),$("#filterHostUserId").attr("disabled",!0);var e=getHostDetails(USER_ID);getHostList(e),getHostListForFilter(e,isUserAllowed),$("#filterHostUserId").select2({placeholder:"Select Host",allowClear:!0}),getAllTimeZone(USER_TIMEZONE),$("#host").attr("disabled",!0),$("#timezone").attr("disabled",!0),$("#meetingHostNameTh").css("display","none"),$("#recurringMeetingHostTh").css("display","none"),$(".meetingHostNameTd").css("display","none"),$("#meetingTitleTh").css("width","25%"),$("#meetingDurationTh").css("width","30%"),$("#recurringMeetingTitleTh").css("width","40%"),$("#recurringMeetingGeneralMeetingTypeTh").css("width","40%")}}catch(e){console.error("Error retrieving settings:",e)}customLoader(!1)}function resetRequiredFormData(e){$(e).val(""),$(e).trigger("change"),$("#generalMeetingType").val(""),$("#generalMeetingType").trigger("change"),$("#topic").val(""),$("#attendees").val(""),selectedAttendees=[],$(".badge").remove(),$("#when").val(""),$("#hour").val(""),$("#hour").trigger("change"),$("#durationHour").val("00"),$("#durationMinute").val("00"),getAllTimeZone({key:""}),fetchUserIdToShowAllMeeting()}function getMeetingType(){const e=$('input[name="meetingType"]:checked').val();return"2"==e?($("#attendeesContainer").hide(),$("#whenContainer").hide(),$("#durationContainer").hide(),$("#when, #hour, #ampm, #durationHour, #durationMinute").prop("required",!1)):($("#attendeesContainer").css("display","flex"),$("#whenContainer").css("display","flex"),$("#durationContainer").css("display","flex"),$("#when, #hour, #ampm, #durationHour, #durationMinute").prop("required",!0)),e}function renderMeetingManagementContent(){$("#meetingManagementMainDiv").append(getMeetingManagementContent()),fetchUserIdToShowAllMeeting(),fetchUserIdToShowRecurringMeeting(),"recurringMeetings"===currentTabId&&($("#filterDateDuration").hide(),$("#filterMeetingStartDate").hide(),$("#filterMeetingEndDate").hide()),$(document).on("click",(function(e){$(e.target).closest("#dynamic-attendees-list").length||$("#dynamic-attendees-list").hide()})),$("#attendees").off("keypress").on("keypress",(function(e){if("Enter"===e.key)if(e.preventDefault(),1===cachedUserList.length){const e=cachedUserList[0];addAttendee(e.userId,e.userName),$("#dynamic-attendees-list").hide(),$(this).val("")}else handleAddAttendee(),$("#dynamic-attendees-list").hide()})),$("<style>").prop("type","text/css").html("\n    .unique-loader {\n      height: 100svh;\n      width: 100vw;\n      position: fixed;\n      top: 0;\n      right: 0;\n      background-color: #00000055;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      z-index: 99999999;\n    }\n\n    .loader-bg {\n      background: rgba(0, 0, 0, 0.5);\n      width: 100%;\n      height: 100%;\n      min-height: 100%;\n      z-index: 9999;\n      left: 0;\n      top: 0;\n      position: fixed;\n    }\n\n    .new-loader-2024 {\n      width: 13%;\n    }\n\n    .tabs {\n      display: flex;\n      gap: 30px;\n      margin-bottom: 10px;\n      position: relative;\n      border-bottom: 2px solid #e3e3e3;\n    }\n\n    .tab-button {\n      padding: 0px;\n      cursor: pointer;\n      border: none;\n      background-color: transparent;\n      position: relative;\n      transition: color 0.3s ease;\n      font-size: 16px;\n      color: #888888;\n      font-weight: bold;\n    }\n\n    .tab-button:focus {\n     outline: 0px auto -webkit-focus-ring-color;\n    }\n\n    .tab-button.active {\n      color: #027FFF;\n    }\n\n    .active-line {\n      position: absolute;\n      bottom: -2px;\n      height: 2px;\n      background-color: #027FFF;\n      transition: all 0.3s ease;\n      border-radius: 50px;\n    }\n   \n    .disabled {\n      cursor: not-allowed !important;\n    }\n    .page-item.active .page-link {\n      z-index: 1;\n      background-color: #E4F2FF !important;\n      color: black !important;\n      border-radius: 6px !important;\n      border: 1px solid #027FFF !important;\n    }\n    .select2-container--default .select2-selection--multiple .select2-selection__rendered li {\n      margin-top: 5px !important;\n    }\n    .select2-container .select2-search--inline .select2-search__field {\n      margin-top: 5px !important;\n    }\n  ").appendTo("head"),setDateToToday("#filterMeetingStartDate, #filterMeetingEndDate"),getHostListForFilter(getHostDetails(USER_ID),isUserAllowed),getGeneralMeetingTypeList("#filterGeneralMeetingType"),fetchMeetings($("#filterHostUserId").val()),$("#filterMeetingStartDate, #filterMeetingEndDate").on("change",(function(){const e=changeDateFormat(new Date(this.value),"MMM-dd-yyyy");"undefined 0NaN, NaN"==e?$(this).val(""):$(this).val(e)})),$("#filterMeetingStartDate").datepicker({format:"M dd, yyyy",autoclose:!0}).on("changeDate",(function(e){$("#filterMeetingEndDate").val(""),$("#filterMeetingEndDate").datepicker("setStartDate",e.date)})),$("#filterMeetingEndDate").datepicker({format:"M dd, yyyy",autoclose:!0})}function backToList(e){null!=e?$(e).off("click").on("click",(function(){$("#meetingFormDiv, #savedMeetingLinkHtml").hide(),$("#filterFormAndList").show(),fetchUserIdToShowAllMeeting(),resetRequiredFormData("#host"),fetchMeetings($("#filterHostUserId").val())})):($("#meetingFormDiv, #savedMeetingLinkHtml").hide(),$("#filterFormAndList").show(),fetchUserIdToShowAllMeeting(),resetRequiredFormData("#host"),fetchMeetings($("#filterHostUserId").val()))}function setFilterDatesAccordingly(e,t,n){const a=$(e).val(),i=new Date,o=e=>{const t=e.getDate()-e.getDay();return new Date(e.setDate(t))};if("Today"===a){const e=changeDateFormat(i,"MMM-dd-yyyy");$(t+","+n).val(e).prop("disabled",!0)}else"Week"===a?($(t).val(changeDateFormat(o(i),"MMM-dd-yyyy")).prop("disabled",!0),$(n).val(changeDateFormat((e=>{const t=o(e);return new Date(t.setDate(t.getDate()+6))})(i),"MMM-dd-yyyy")).prop("disabled",!0)):"Month"===a?($(t).val(changeDateFormat((r=i,new Date(r.getFullYear(),r.getMonth(),1)),"MMM-dd-yyyy")).prop("disabled",!0),$(n).val(changeDateFormat((e=>new Date(e.getFullYear(),e.getMonth()+1,0))(i),"MMM-dd-yyyy")).prop("disabled",!0)):$(t+","+n).val("").prop("disabled",!1);var r}function setDateToToday(e){const t=new Date,n=changeDateFormat(t,"MMM-dd-yyyy");$(e).val(n).prop("disabled",!0)}function goToPage(e){1==$("#recurringMeetingModal").length?(currentPageRecurringRecording=e,applyRecurringRecordingFilters($("#recurringMeetingModal").data("entityId"))):("oneDayMeetings"===currentTabId?currentPageOneDay=e:"recurringMeetings"===currentTabId&&(currentPageRecurring=e),fetchMeetings($("#filterHostUserId").val()))}function renderPagination(e,t){let n=`\n    <nav aria-label="Page navigation">\n      <ul class="pagination justify-content-center">\n        <li class="page-item ${1===e?"disabled":""}">\n          <button class="page-link" onclick="goToPage(${e-1})"><i class="fa fa-chevron-left mr-2" style="font-size: 10px;"></i>Previous</button>\n        </li>`,a=Math.max(1,e-1),i=Math.min(t,e+1);a>1&&(n+='\n      <li class="page-item">\n        <button class="page-link" onclick="goToPage(1)">1</button>\n      </li>',a>2&&(n+='\n        <li class="page-item">\n          <span class="page-link" style="background: transparent; border: 0px; padding: 6px 0px;">...</span>\n        </li>'));for(let t=a;t<=i;t++)n+=`\n      <li class="page-item ${t===e?"active":""}">\n        <button class="page-link" onclick="goToPage(${t})">${t}</button>\n      </li>`;return i<t&&(i<t-1&&(n+='\n        <li class="page-item">\n          <span style="background: transparent; border: 0px; padding: 6px 0px;">...</span>\n        </li>'),n+=`\n      <li class="page-item">\n        <button class="page-link" onclick="goToPage(${t})">${t}</button>\n      </li>`),n+=`\n        <li class="page-item ${e===t?"disabled":""}">\n          <button class="page-link" onclick="goToPage(${e+1})">Next<i class="fa fa-chevron-right ml-2" style="font-size: 10px;"></i></button>\n        </li>\n      </ul>\n    </nav>`,n}async function fetchMeetings(e){customLoader(!0),e=(e=[e]).join(",");const t={title:$("#filterTitle").val(),hostUserId:e,meetingType:$("#filterGeneralMeetingType").val(),meetingStartDate:""==$("#filterMeetingStartDate").val()?"":changeDateFormat(new Date($("#filterMeetingStartDate").val()),"yyyy-mm-dd"),meetingEndDate:""==$("#filterMeetingEndDate").val()?"":changeDateFormat(new Date($("#filterMeetingEndDate").val()),"yyyy-mm-dd"),limit:$("#limit").val()?$("#limit").val():10,pageNo:"oneDayMeetings"===currentTabId?currentPageOneDay:currentPageRecurring,userId:USER_ID};$.ajax({url:BASE_URL+CONTEXT_PATH+"api/v1/get-all-meetings",method:"POST",data:JSON.stringify(t),contentType:"application/json",success:function(e){const t=JSON.parse(e);var n=t.data.meetingsTotalPages,a=t.data.recurringMeetingsTotalPages;isHaveRecurringMeetings=t.data.recurringMeetingsTotalPages;const i=renderMeetings(t.data.meetings,!1,n,a),o=renderMeetings(t.data.recurringMeetings,!0,n,a),r="oneDayMeetings"===currentTabId?renderPagination(currentPageOneDay,n):renderPagination(currentPageRecurring,a),s=`\n        <div class="tabs" style="position: relative;">\n          <button class="tab-button" id="oneDayTab" onclick="showTab('oneDayMeetings')">One Day Meetings</button>\n          <button class="tab-button" id="recurringTab" onclick="showTab('recurringMeetings')">Recurring Meetings</button>\n          <div class="active-line"></div>\n          <button onclick="showMeetingForm()" class="btn my-3 ml-auto rounded scheduleAButtonRight" style="width: max-content; background-color: #027FFF; padding: 10px 20px; font-weight: bold; cursor: pointer;" id="scheduleMeetingBtn">Schedule a New Meeting</button>\n        </div>\n        ${0==t.data.meetingsTotalPages&&0==t.data.recurringMeetingsTotalPages?'\n            <div class="d-flex flex-column justify-content-center align-items-center" style="height: 250px;">\n              <h1 style="font-weight: bold;">Welcome To IS Meetings!</h1>\n              <button onclick="showMeetingForm()" class="btn my-3 rounded" style="width: max-content; background-color: #027FFF; padding: 10px 20px; font-weight: bold; cursor: pointer;" id="scheduleMeetingBtn">Schedule a New Meeting</button>\n            </div>\n          ':`\n            <div class="tab-content">\n              <div id="oneDayMeetings" class="tab-pane">${i}</div>\n              <div id="recurringMeetings" class="tab-pane">${o}</div>\n            </div>\n            ${r}\n          `}\n      `;$("#meetingTableContainer").html(s),0==t.data.meetingsTotalPages&&0==t.data.recurringMeetingsTotalPages&&($(".scheduleAButtonRight").hide(),$(".tabs").css("padding","16px 0px")),0==n&&"oneDayMeetings"==currentTabId||0==a&&"recurringMeetings"==currentTabId?$(".pagination").hide():$(".pagination").show(),setTimeout((()=>{$(".tab-button").removeClass("hover-blue"),$("#"+("oneDayMeetings"===currentTabId?"oneDayTab":"recurringTab")).addClass("active"),$(".tab-pane").hide(),$(`#${currentTabId}`).show();const e=$(".tab-button.active");$(".active-line").css({width:e.outerWidth(),left:e.position()?.left})}),100),fetchMetaValue(),fetchUserIdToShowAllMeeting(),fetchUserIdToShowRecurringMeeting()},error:function(){showMessageTheme2(0,"Failed to fetch meetings.")}}),customLoader(!1)}function showTab(e){currentTabId=e,$(".tab-button").removeClass("hover-blue"),$("#"+("oneDayMeetings"===e?"oneDayTab":"recurringTab")).addClass("active"),$(".tab-pane").hide(),$(`#${e}`).show();const t=$(".tab-button.active");$(".active-line").css({width:t.outerWidth(),left:t.position()?.left}),"recurringMeetings"===e?($("#filterDateDuration").hide(),$("#filterMeetingStartDate").hide(),$("#filterMeetingEndDate").hide()):($("#filterMeeting").css("display","flex"),$("#filterDateDuration").show(),$("#filterMeetingStartDate").show(),$("#filterMeetingEndDate").show()),fetchMeetings($("#filterHostUserId").val()),fetchUserIdToShowAllMeeting(),fetchUserIdToShowRecurringMeeting()}function applyFilters(){$("#filterMeeting").off("submit").on("submit",(function(e){e.preventDefault(),fetchMeetings($("#filterHostUserId").val())}))}function resetFilter(){$("#filterHostUserId").val(""),$("#filterHostUserId").trigger("change"),$("#filterGeneralMeetingType").val(""),$("#filterGeneralMeetingType").trigger("change"),fetchUserIdToShowAllMeeting(),$("#filterDateDuration").val("Today"),setDateToToday("#filterMeetingStartDate, #filterMeetingEndDate"),currentPageOneDay=1,currentPageRecurring=1}function renderMeetings(e,t=!1,n,a){if($("<style>").prop("type","text/css").html("\n      .hover-blue:hover {\n        color: #027FFF;\n      }\n      table th:first-child{\n        border-radius:10px 0 0 10px;\n      }\n      table th:last-child{\n        border-radius:0 10px 10px 0;\n      }\n    ").appendTo("head"),!t&&0==n||!t&&0==e.length)return'\n      <div style="text-align: center; font-size: 18px; color: #6e6e6e; margin: 20px 0;">\n        No Meetings Found\n      </div>';if(t&&(0==a||0==e.length))return'\n      <div style="text-align: center; font-size: 18px; color: #6e6e6e; margin: 20px 0;">\n        No Recurring Meetings Found\n      </div>';let i=t?"Recurring Meetings":"One Day Meetings",o=`\n    <div class="meeting-list">\n      <table id="mainTable" class="w-100">\n        <thead style="background-color: #EEEEEE;">\n          ${"Recurring Meetings"==i?'\n              <tr style="font-size: 14px;">\n                <th id="recurringMeetingTitleTh" class="p-3" style="padding-left:16px !important;border-bottom: 0; border-top: 0px; width: 30%;font-weight: bold;">Meeting Title</th>\n                <th id="recurringMeetingGeneralMeetingTypeTh" class="p-3" style="padding-left:16px !important;border-bottom: 0; border-top: 0px; width: 30%;font-weight: bold;">Meeting Type</th>\n                <th id="recurringMeetingHostTh" class="p-3" style="padding-left:16px !important;border-bottom: 0; border-top: 0px; width: 20%;font-weight: bold;">Host</th>\n                <th id="recurringMeetingActionTh" class="p-3" style="border-bottom: 0; border-top: 0px; font-weight: bold;">Actions</th>\n              </tr>\n            ':'\n              <tr style="font-size: 14px;">\n                <th id="meetingTitleTh" class="p-3" style="padding-left:16px !important;border-bottom: 0; border-top: 0px; font-weight: bold;width: 20%;">Meeting Title</th>\n                <th id="meetingGeneralMeetingTypeTh" class="p-3" style="padding-left:16px !important;border-bottom: 0; border-top: 0px; font-weight: bold;width: 20%;">Meeting Type</th>\n                <th id="meetingHostNameTh" class="p-3" style="padding-left:16px !important;border-bottom: 0; border-top: 0px; font-weight: bold;width: 20%;">Host</th>\n                <th id="meetingDurationTh" class="p-3" style="border-bottom: 0; border-top: 0px; font-weight: bold;width: 20%;">Duration/Timezone</th>\n                <th class="p-3" style="border-bottom: 0; border-top: 0px; font-weight: bold;">Actions</th>\n              </tr>\n            '}\n        </thead>\n        <tbody>`,r=null;return e.forEach(((e,t)=>{const n=new Date(changeDateFormat(convertTZ(new Date,USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss"))>new Date(e.endDateTime?.replace(" ","T")),a=(new Date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),s=new Date(e.startDateTime?.split(" ")[0]).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})===a?"Today":changeDateFormat(new Date(e.startDateTime?.split(" ")[0]),"MMM-dd-yyyy"),l=changeDateFormat(new Date(e.startDateTime?.split(" ")[0]),"MMM-dd-yyyy"),d=e.timeRange?.split("-")[0];var c=e.title.replace(/'/g,"\\'"),g=new Date;g.setDate(g.getDate()-recordingLimit),r!=s&&"undefined 0NaN, NaN"!=s&&(r=s,o+=`\n        <tr>\n          <td colspan="5">\n            <div class="rounded p-3 my-2" style="background-color: #FFEDD9; font-weight: bold;">\n              ${s}\n            </div>\n          </td>\n        </tr>`),o+=`\n      <tr id="meetingRow${e.meetingId}" class="${n?"":"hover-blue"} trRecur" style="font-weight: bold; border-bottom: 1px solid #eee;">\n        ${"Recurring Meetings"==i?`\n          <td\n            onclick="showMeetingDetails(${e.meetingId})"\n            style="cursor: pointer; padding-left: 12px !important;"\n            class="hover-blue py-4 tdRecur">\n            ${e.title}\n          </td>\n          <td\n            onclick="showMeetingDetails(${e.meetingId})"\n            style="cursor: pointer; padding-left: 12px !important;"\n            class="hover-blue py-4 tdRecur">\n            ${e.gmType}\n          </td>\n          <td\n            onclick="showMeetingDetails(${e.meetingId})"\n            style="cursor: pointer; padding-left: 12px !important;"\n            class="hover-blue py-4 tdRecur meetingHostNameTd">\n            ${e.hostName}\n          </td>\n          <td class=''>\n            <button onclick="startLensUrl('${e.meetingId}', '${c}', '${l}', '${d}')" class="btn rounded btnRecur tdBtns" style="padding: 6px 14px; font-size: 16px; background-color: #027FFF; font-weight: bold; text-transform: capitalize;">Start</button>\n            <button onclick="showWarningMessage('Are you sure you want to delete this meeting?', 'deleteMeeting(${e.meetingId})')" style="border: 0; background: transparent; color: #FF0000 !important; padding: 5px; box-shadow: 0px 0px transparent;" class="btn btn-sm btnRecur tdBtns"><i class="fa fa-trash" style="font-size: 20px;"></i></button>\n            <button onclick="copyJoinUrl('${e.meetingId}')" style="border: 0; background: transparent; color: #3E3E3E !important; padding: 5px; box-shadow: 0px 0px transparent;" class="btn btn-sm btnRecur tdBtns" title="Copy invite"><i style="font-size: 20px;" class="fa fa-clone"></i></button>\n            ${e.recordingsCount>0?`<button onclick="showRecurringMeetingRecordings('${e.meetingId}','${e.title}','${e.hostName}')" style="border: 0; background: transparent; color: #027FFF !important; padding: 5px; box-shadow: 0px 0px transparent;" class="btn btn-sm" title="Play Recording"><i class="fa fa-video-camera" style="font-size: 20px;"></i></button>`:""}\n          </td>\n        `:`\n          <td\n            onclick="${n?"":`event.preventDefault(); showMeetingDetails(${e.meetingId})`}"\n            style="cursor: ${n?"":"pointer"}; padding-left: 12px !important;"\n            class="py-4 ${n?"":"hover-blue"}">\n            ${e.title}\n          </td>\n\n          <td\n            onclick="${n?"":`event.preventDefault(); showMeetingDetails(${e.meetingId})`}"\n            style="cursor: ${n?"":"pointer"}; padding-left: 12px !important;"\n            class="py-4 ${n?"":"hover-blue"}">\n            ${e.gmType}\n          </td>\n\n          <td\n            onclick="${n?"":`event.preventDefault(); showMeetingDetails(${e.meetingId})`}"\n            style="cursor: ${n?"":"pointer"}; padding-left: 12px !important;"\n            class="py-4 meetingHostNameTd ${n?"":"hover-blue"}">\n            ${e.hostName}\n          </td>\n\n          <td\n            onclick="${n?"":`event.preventDefault(); showMeetingDetails(${e.meetingId})`}"\n            style="cursor: ${n?"":"pointer"};"\n            class="${n?"":"hover-blue"}">\n            ${e.timeRange}\n            <br/>\n            ${e.timezoneName}\n          </td>\n          <td>\n            <button onclick="startLensUrl('${e.meetingId}', '${c}', '${l}', '${d}')" class="btn rounded" style="padding: 6px 14px; font-size: 16px; background-color: #027FFF; font-weight: bold; text-transform: capitalize;" ${n?"disabled":""}>Start</button>\n            <button onclick="showWarningMessage('Are you sure you want to delete this meeting?', 'deleteMeeting(${e.meetingId})')" style="border: 0; background: transparent; color: #FF0000 !important; padding: 5px; box-shadow: 0px 0px transparent;" class="btn btn-sm" ${n?"disabled":""}><i class="fa fa-trash" style="font-size: 20px;"></i></button>\n            <button onclick="copyJoinUrl('${e.meetingId}')" style="border: 0; background: transparent; color: #3E3E3E !important; padding: 5px; box-shadow: 0px 0px transparent;" class="btn btn-sm" title="Copy invite" ${n?"disabled":""}><i style="font-size: 20px;" class="fa fa-clone"></i></button>\n            ${isUserAllowedRecordings&&e.recordingsCount>0||!isUserAllowedRecordings&&e.recordingsCount>0&&new Date(l).setHours(0,0,0,0)>=new Date(g).setHours(0,0,0,0)?`<button onclick="openRecordingModal('${e.meetingId}', 'GENERAL_MEETINGS','${e.startDateTime?.split(" ")[0]}', '${e.title}', '${e.timeRange.split("-")[0]}', '${e.hostName}')" \n                    style="border: 0; background: transparent; color: #027FFF !important; padding: 5px; box-shadow: 0px 0px transparent;" \n                    class="btn btn-sm" title="Play Recording">\n                <i class="fa fa-video-camera" style="font-size: 20px;"></i>\n              </button>`:""}\n          </td>\n        `}\n      </tr>\n    `})),o+="\n        </tbody>\n      </table>\n    </div>",o}function showMeetingForm(){$("#meetingFormDiv").show(),$("#filterFormAndList, #savedMeetingLinkHtml").hide(),$("#meetingTypeContainer").css("display","flex"),"recurringMeetings"==currentTabId?$('input[name="meetingType"][value="2"]').prop("checked",!0):$('input[name="meetingType"][value="1"]').prop("checked",!0),$("#when").datepicker({format:"M dd, yyyy",startDate:new Date(changeDateFormat(convertTZ(new Date,selectedHostTimezoneName??USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss")),autoclose:!0}).on("changeDate",updateAvailableTimes),$("#hour").select2({placeholder:"Select Time",allowClear:!0}),getMeetingType(),fetchMetaValue(),fetchUserIdToShowRecurringMeeting(),getHostList(),getAllTimeZone(),initializeMeetingForm(),fetchUserIdToShowAllMeeting(),updateAvailableTimes(),getGeneralMeetingTypeList("#generalMeetingType"),$("<style>").prop("type","text/css").html("\n      #select2-timezone-container{\n        cursor: not-allowed !important;\n      }\n    ").appendTo("head"),backToList("#backFromForm")}function updateNewDateInCalender(){$("#when").datepicker("update",""),$("#when").datepicker("remove"),$("#when").datepicker({format:"M dd, yyyy",startDate:new Date(changeDateFormat(convertTZ(new Date,selectedHostTimezoneName??USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss")),autoclose:!0})}function initializeMeetingForm(){$("#meetingForm").off("submit").on("submit",(function(e){e.preventDefault();submitMeetingForm(getMeetingFormData())})),$("#meetingForm").on("keypress",(function(e){13===e.keyCode&&("attendees"===e.target.id?(e.preventDefault(),handleAddAttendee(),$("#dynamic-attendees-list").hide()):e.preventDefault())}))}function getMeetingFormData(){const e=$("#when").val(),t=new Date(e),n=`${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")}/${t.getFullYear()}`,a=getDayId(),i=getMeetingType();return"2"===i?{userId:USER_ID,gmType:$("#generalMeetingType").val(),title:$("#topic").val(),hostUserId:$("#host").val(),timezone:$("#timezone").val(),schoolId:SCHOOL_ID,meetingType:i}:{userId:USER_ID,gmType:$("#generalMeetingType").val(),title:$("#topic").val(),startDate:n,startTime:convertToAmPmForSaveBody(`${$("#hour").val()}`),duration:`${$("#durationHour").val()}:${$("#durationMinute").val()}`,hostUserId:$("#host").val(),attendees:selectedAttendees.map((e=>e.userId)).join(",").trim(),timezone:$("#timezone").val(),schoolId:SCHOOL_ID,dayId:a,meetingType:i}}function convertToAmPmForSaveBody(e){const t=parseInt(e.slice(0,2),10);return`${t%12||12}:${e.slice(2,4)} ${t>=12?"PM":"AM"}`}function convertToAmPm(e){const[t,n]=e.split(":"),a=parseInt(t,10);return`${a%12||12}:${n} ${a>=12?"PM":"AM"}`}function submitMeetingForm(e){if(""==$("#generalMeetingType").val())showMessageTheme2(0,"Please select a topic.");else{if("00:00"==e.duration)return void showErrorPopup("The duration cannot be set to 00 hours and 00 minutes. Please specify a valid time.");""!=$("#attendees").val()?showMessageTheme2(0,"Please clear the 'Attendees' field or select attendee(s) to move forward."):$.ajax({url:BASE_URL+CONTEXT_PATH+"api/v1/save-councellor-meeting",method:"POST",contentType:"application/json",data:JSON.stringify(e),success:function(t){const n=JSON.parse(t);if("failed"==n.status){const e=n.data.title,t=changeDateFormat(new Date($("#when").val()),"MMM-dd-yyyy"),a=convertToAmPm(n.data.startTime),i=convertToAmPm(n.data.endTime);return void showConflictPopUp(e,t,a+" - "+i)}const a=n.data.meetingId,i={key:n.data.hostUserId,extra:n.data.hostName,extra1:n.data.hostEmail,extra4:n.data.roleName},o={key:n.data.timezone,extra:n.data.offset,value:n.data.countryTimezone},r=n.data.allAttendees;savedMeetingDetails(a,e,i,o,r)},error:function(){showMessageTheme2(0,"Failed to save the meeting.")}})}}function deleteMeeting(e){const t={meetingId:e,type:"D"};$.ajax({url:BASE_URL+CONTEXT_PATH+"api/v1/update-councellor-meeting",method:"POST",contentType:"application/json",data:JSON.stringify(t),success:function(){customLoader(!1),showMessageTheme2(1,"Meeting Deleted Successfully"),$("#meetingRow"+e).remove(),backToList()},error:function(){customLoader(!1),showMessageTheme2(0,"Failed to delete the meeting.")}})}function showMeetingDetails(e){$.ajax({url:BASE_URL+CONTEXT_PATH+`api/v1/get-meeting-details?meetingId=${e}&userId=${USER_ID}`,method:"GET",contentType:"application/json",success:function(t){try{if(!t)throw new Error("Empty or invalid response received.");{const n=JSON.parse(t),a={title:n.data.title,startDate:n.data.meetingStartDateTime?.split(" ")[0],startTime:n.data.meetingStartDateTime?.split(" ")[1],duration:n.data.duration,timezone:n.data.countryTimezone,attendeesEmail:n.data.attendeesEmail,meetingStatus:n.data.meetingStatus,meetingType:n.data.meetingType,meetingEndDateTime:n.data.meetingEndDateTime,gmType:n.data.gmType},i={key:n.data.hostUserId,extra:n.data.hostName,extra1:n.data.hostEmail,extra4:n.data.roleName},o={key:n.data.timezone,extra:n.data.offset,value:n.data.countryTimezone},r=n.data.allAttendees;savedMeetingDetails(e,a,i,o,r)}}catch(e){console.error("Error parsing JSON response: ",e.message),showMessageTheme2(0,"Failed to parse the meeting data.")}}})}function savedMeetingDetails(e,t,n,a,i){let o=null,r=null,s=null;"1"==t.meetingType&&(o=t.duration.split(":")[0],r=t.duration.split(":")[1],s=changeDateFormat(new Date(t.startDate),"MMM-dd-yyyy"));let l=joinLensUrl(""+e,t.title);const d="1"==t.meetingType?"One Day Meeting":"Recurring Meeting",c=new Date(changeDateFormat(convertTZ(new Date,USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss")),g=new Date(t.meetingEndDateTime?.replace(" ","T"));var p=t.title.replace(/'/g,"\\'");let u="Not Available";i?.length>0&&(u='<ul style="list-style: none; padding: 0;">',u+=i?.map((e=>{let t;switch(e.attendee.emailSent){case"Y":t='<span data-toggle="tooltip" data-placement="top" data-original-title="Email Sent"><i class="fa fa-check-circle" style="color: #228B22; font-size:16px;" aria-hidden="true"></i></span>';break;case"N":t='<span data-toggle="tooltip" data-placement="top" data-original-title="Email Not Sent"><i class="fa fa-times-circle" style="color: #D22B2B; font-size:16px;" aria-hidden="true"></i></span>';break;case"U":t='<span data-toggle="tooltip" data-placement="top" data-original-title="Unverified"><i class="fa fa-minus-circle" style="color: #E5741A; font-size:16px;" aria-hidden="true"></i></span>';break;default:t=""}return`<li style="display: flex; align-items: center; gap: 8px;">\n          ${e.attendee.attendeeName}  ${""==e.attendee.enrollmentNo?"":" | "+e.attendee.enrollmentNo} ${t}\n      </li>`})).join(""),u+="</ul>"),$("#formDataTitle").text("Manage `"+t.title+"`"),$("#generalMeetingTypeTitle").text(t.gmType),$("#formDataTitle1").text(t.title),$("#hostDetailsExtra").text(n.extra),$("#meetingTypeName").text(d),"1"==t.meetingType?$("#meetingTypeDiv").html(`<div style="display: flex; align-items: center; padding: 12px;">\n        <div style="font-size: 14px; color: #666; width: 40%;"><strong>Attendees</strong></div>\n        <div id="attendeesSaved" style="font-size: 14px; width: 80%;">${u}</div>\n      </div>\n      \n      <div id="saveWhenContainer" style="display: flex; align-items: center; padding: 12px;">\n        <div style="font-size: 14px; color: #666; width: 40%;"><strong>When</strong></div>\n        <div id="formattedDateAndFormDataStartTime" style="font-size: 14px; width: 80%;">${s} ${moment(t.startTime,"h:mm a").format("h:mm a")}</div>\n      </div>\n\n      <div id="saveDurationContainer" style="display: flex; align-items: center; padding: 12px;">\n        <div style="font-size: 14px; color: #666; width: 40%;"><strong>Duration</strong></div>\n        <div id="hourAndMin" style="font-size: 14px; width: 80%;">${o} Hour(s) ${r} Minute(s)</div>\n      </div>`):$("#meetingTypeDiv").html("<div></div>"),$("#timezoneDetailsExtraAndTimezoneDetailsValue").text("("+a.extra+") "+a.value),$("#joinUrl").text(l),c>g&&($("#startLensUrlBtn").prop("disabled",!0),$("#deleteMeetingBtn").prop("disabled",!0)),$("#startLensUrlBtn").attr("onclick",`startLensUrl(${e}, '${p}', '${s}', '${t.startTime}')`),$("#deleteMeetingBtn").attr("onclick",`showWarningMessage('Are you sure you want to delete this meeting?', "deleteMeeting(${e})")`),c>g&&("recurringMeetings"==currentTabId?($("#startLensUrlBtn").prop("disabled",!1),$("#copyJoinUrlBtn").prop("disabled",!1)):($("#startLensUrlBtn").prop("disabled",!0),$("#copyJoinUrlBtn").prop("disabled",!0))),$("#copyJoinUrlBtn").attr("onclick",`copyJoinUrl(${e})`),$("#savedMeetingLinkHtml").show(),$("#filterFormAndList, #meetingFormDiv").hide(),backToList("#backFromSaved"),$('[data-toggle="tooltip"]').tooltip()}function getHostsOnly(){var e={};return $.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForHostList("GET-ALL-HOST-LIST")),dataType:"json",cache:!1,timeout:6e5,async:!1,success:function(t){e=t},error:function(e){console.log(e)}}),e}var onChangeHostVar;function getHostList(e){const t=hostsData.mastersData.allHostList;onChangeHostVar=t;const n=$("#host");n.empty(),n.append('<option value="">Select Host</option>'),t.forEach((e=>{const t=`<option value="${e.key}">${e.extra}</option>`;n.append(t)})),e&&n.val(e?.key),n.select2({placeholder:"Select Host",allowClear:!0}),selectedHostKey=e?e.key:null,selectedHostName=e?e.extra:null,selectedRole=e?e.extra4:null,selectedHostTimezone=e?e.extra3:null,selectedHostTimezoneName=e?e.extra5:null,selectedHostTimezoneUTC=e?e.extra2:null}function onChangeHost(e){if(""!=(selectedHostKey=$(e).val())){const e=onChangeHostVar?.find((e=>e.key===selectedHostKey));selectedHostName=e?e.extra:null,selectedRole=e?e.extra4:null,selectedHostTimezone=e?e.extra3:null,selectedHostTimezoneName=e?e.extra5:null,selectedHostTimezoneUTC=e?e.extra2:null,getAllTimeZone(selectedHostTimezone?{key:selectedHostTimezone,value:selectedHostTimezoneName,extra:selectedHostTimezoneUTC}:null)}}function getHostListForFilter(e,t){const n=hostsData.mastersData.allHostList;var a=getFilterState(e.key);const i=$("#filterHostUserId");if(i.empty(),n.forEach((e=>{const t=`<option value="${e.key}">${e.extra}</option>`;i.append(t)})),t);else if(""!=a.filterHostUserId){const e=a.filterHostUserId.split(",");i.val(e).trigger("change")}else i.val(e.key);i.off("change").on("change",(function(){currentPageOneDay=1,currentPageRecurring=1;var e=$(this).val();Array.isArray(e)||(e=[e]),""!==a.filterHostUserId&&(a.filterHostUserId=e.join(","))}))}function getAllTimeZone(e){$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster("","TIMEZONE-LIST","")),dataType:"json",cache:!1,timeout:6e5,async:!1,success:function(t){const n=t.mastersData.countryTimeZones,a=$("#timezone");if(a.empty(),a.append('<option value="">Select Timezone</option>'),n.forEach((t=>{const n=`<option ${e===t.value?"selected":""} value="${t.key}">(${t.extra}) ${t.value}</option>`;a.append(n)})),e){const t=n.find((t=>t.value===e))?.key;t?a.val(t):a.val(e.key)}a.select2({placeholder:"Select Timezone",allowClear:!0})},error:function(e){console.error(e)}})}function startLensResponse(e,t,n,a){$.ajax({type:"GET",contentType:"application/json",url:e,dataType:"json",success:function(e){"1"==e.status?(window.open(e.redirectUrl,"_blank"),showStartMeetingPopup(t,n,a,e.redirectUrl)):"3"==e.status?redirectLoginPage():showMessageTheme2(0,e.message)}})}function encode(e){return window.btoa(e)}function startLensUrl(e,t,n,a){(null==a||null==a&&"recurringMeetings"==currentTabId)&&(a="");var i={};i.entityId=e,i.entityType="GENERAL_MEETINGS";let o=BASE_URL+CONTEXT_PATH+SCHOOL_ID+"/start-general?payload=";o+=encode(JSON.stringify(i)),startLensResponse(o,t,n,a)}function joinLensUrl(e){var t={};t.entityId=e,t.entityType="GENERAL_MEETINGS";let n=BASE_URL+CONTEXT_PATH+SCHOOL_ID+"/join-general?payload=";return n+=encode(JSON.stringify(t)),n}function copyJoinUrl(e){let t=joinLensUrl(e);t?navigator.clipboard.writeText(t).then((function(){showMessageTheme2(1,"URL copied successfully!")})):showMessageTheme2(0,"Url Invalid")}function startLensRecording(e){var t={};t.meetingId=e;let n=BASE_URL+CONTEXT_PATH+SCHOOL_ID+"/lens-session-recording?payload=";n+=encode(JSON.stringify(t)),window.open(n,"_blank")}function getDayId(){const e=$("#when").val();if(!e)return null;return new Date(e).getDay()+1}function getScheduleList(){const e=getDayId(),t=selectedHostKey,n=new Date($("#when").val()),a=`${changeDateFormat(n,"yyyy-mm-dd")} ${(new Date).toTimeString().split(" ")[0]}`,i=n.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}),o={teacherUserId:+t,dayId:e,startDate:a,userId:+USER_ID};t&&e&&$.ajax({url:BASE_URL+CONTEXT_PATH+UNIQUEUUID+"/api/v1/dashboard/get-schedule",method:"POST",contentType:"application/json",data:JSON.stringify(o),success:function(e){try{const t=JSON.parse(e).data.schedule;t&&t.length>0?($("#scheduleAndMeetingContainer").css("display","flex"),$("#scheduleSection").show(),$("#scheduleContent").html(`\n            <h3 class="mb-4 mt-0 text-center text-white rounded mx-3 py-2 px-3" style="font-weight: bold !important; background-color: #027FFF;">Teacher's Schedule for ${i}.</h3>\n            ${t.map((e=>`<p class="px-4 py-2 mx-5" style="background-color: #FFE6E2; border: 1px solid #F23B22; color: #F23B22; border-radius: 16px;">${e.timeRange}</p>`)).join("")}\n            <p class="mb-4 mx-3 text-center" style="font-weight: bold !important; color: #F23B22;">\n              Do not schedule meetings within these time ranges.\n            </p>\n          `)):($("#scheduleAndMeetingContainer").css("display","flex"),$("#scheduleSection").show(),$("#scheduleContent").html(`\n            <h3 class="mb-4 mt-0 text-center text-white rounded mx-3 py-2 px-3" style="font-weight: bold !important; background-color: #027FFF;">Teacher's Schedule for ${i}.</h3>\n            <p class="text-center" style="font-size: 16px !important; font-weight: bold !important; color: #03BB17;">No meetings for now</p>\n          `))}catch(e){console.error("Failed to fetch schedule:",e),$("#scheduleContent").html("<p>Error loading schedule.</p>")}}})}function checkAndFetchSchedule(){const e=$("#when").val();selectedHostKey=$("#host").val(),e&&selectedHostKey&&"TEACHER"==selectedRole&&"0"!==selectedHostKey?getScheduleList():($("#scheduleAndMeetingContainer").css("display","none"),$("#scheduleSection").hide())}function getRequiredDateTime(){const e=$("#when").val();if(!e)return null;const[t,n,a]=e.replace(",","").split(" "),i=new Date(`${t} 1, 2000`).getMonth(),o=(new Date(a,i,parseInt(n)),`${a}-${String(i+1).padStart(2,"0")}-${String(n).padStart(2,"0")}`),r=$("#hour").val();if(!r)return null;const[s,l]=[r.substring(0,2),r.substring(2)];return`${o} ${String(s).padStart(2,"0")}:${l}:00`}$(document).on("change","#filterMeeting input, #filterMeeting select",(function(){saveFilterState()}));var isFetching=!1;function getMeetingList(){if(isFetching)return;isFetching=!0;const e=getRequiredDateTime(),t=new Date($("#when").val()).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"});if(!e)return;const n={meetingStartDate:e,hostUserId:$("#host").val(),userId:USER_ID};$.ajax({url:BASE_URL+CONTEXT_PATH+"api/v1/get-scheduled-meetings",method:"POST",contentType:"application/json",data:JSON.stringify(n),success:function(e){isFetching=!1;try{const n=JSON.parse(e).data.meetings;n&&n.length>0?($("#scheduleAndMeetingContainer").css("display","flex"),$("#meetingSection").show(),$("#meetingContent").html(`\n            <h3 class="mb-4 mt-0 text-center text-white rounded mx-3 py-2 px-3" style="font-weight: bold !important; background-color: #027FFF;">Existing meetings on ${t}.</h3>\n            <div style="max-height:80vh; overflow-y:auto;">\n              ${n.map((e=>`<p class="px-4 py-2 mx-5 meeting-item relative"\n                  data-details="Type: ${e.eventName}\nWhen: ${e.timeRange}\nInvitee Name: ${e.inviteeName}\nDuration: ${e.duration}\nTimezone: ${e.timezone}"\n                  style="background-color: #FFE6E2; border: 1px solid #F23B22; color: #F23B22; border-radius: 16px;">${e.timeRange}</p>`)).join("")}\n            </div>\n            <p class="mb-4 mx-3 text-center" style="font-weight: bold !important; color: #F23B22;">\n              Do not schedule meetings within these time ranges.\n            </p>\n          `)):($("#scheduleAndMeetingContainer").css("display","flex"),$("#meetingSection").show(),$("#meetingContent").html(`\n            <h3 class="mb-4 mt-0 text-center text-white rounded mx-3 py-2 px-3" style="font-weight: bold !important; background-color: #027FFF;">Existing meetings on ${t}.</h3>\n            <p class="text-center" style="font-size: 16px !important; font-weight: bold !important; color: #03BB17;">No meetings for now</p>\n          `))}catch(e){console.error("Failed to fetch meetings:",e),$("#meetingContent").html("<p>Error loading meetings.</p>")}}})}function hideConflictTooltip(){$("#tooltip").remove()}function checkAndFetchMeetings(){const e=getRequiredDateTime();selectedHostKey=$("#host").val(),e&&selectedHostKey&&"0"!==selectedHostKey?getMeetingList():($("#scheduleAndMeetingContainer").css("display","none"),$("#meetingSection").hide())}function openRecordingModal(e,t,n,a,i,o){const r={entityId:e,entityName:t,meetingDate:changeDateFormat(new Date(n),"yyyy-mm-dd"),meetingType:"GENERAL_MEETING"};$.ajax({type:"POST",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/api/v1/leads/get-event-recordings",data:JSON.stringify(r),contentType:"application/json",success:function(e){const t=JSON.parse(e);if(0===t.statusCode&&"success"===t.status){const e=t.data.recordingUrls;e&&e.length>0?populateRecordingModal(e,n,a,i,o):showMessageTheme2(0,"No recordings available.","",!0)}else showMessageTheme2(0,`Error: ${t.message}`,"",!0)},error:function(e){console.error("Error Fetching the data:",e.message)}})}function playRecording(e,t){var n=$("#videoModal");$.ajax({type:"GET",contentType:"application/json",dataType:"json",url:getURLForSignVideo(e),success:function(e){if(0==e.status){const a=e.url;recordingTitle=t,0==n.length?$("body").append(`\n            <div id="videoModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 10000;">\n              <div style="background: white; border-radius: 12px; overflow: hidden; width: 70%; max-width: 70%;margin: auto; margin-top:50px;">\n                <div class="">\n                  <div class="d-flex justify-content-between align-items-center" style="padding: 15px 10px; background: #027FFF;">\n                    <h5 class="text-white mb-0" style="font-size: 18px; font-weight: bold;">${recordingTitle}</h5>\n                    <button onclick="closeVideoModal();" type="button" class="text-white btn btn-sm btn-danger" data-bs-dismiss="modal" aria-label="Close" style="font-size: 20px !important; margin: 0; padding: 0px 8px;">&times;</button>\n                  </div>\n                  <div class="" style="padding: 20px;">\n                    <video class="videoTag w-100" style="height: 70vh; overflow-y: auto;" controls>\n                      <source src="${a}" type="video/mp4" />\n                      Your browser does not support the video tag.\n                    </video>\n                  </div>\n                </div>\n              </div>\n            </div>\n          `):(n.find(".modal-title").text(t),n.find(".videoTag source").attr("src",a),n.find(".videoTag")[0]?.load()),$("#videoModal").modal("show")}else showMessageTheme2(0,e.message||"Failed to fetch video URL","",!0);customLoader(!1)},error:function(e){console.error("Error fetching signed video URL:",e.message),showMessageTheme2(0,"Error fetching video.","",!0),customLoader(!1)}})}function getURLForSignVideo(e){const t=JSON.stringify({url:e}),n=window.btoa(t);return BASE_URL+CONTEXT_PATH+"videos/signed-url?payload="+n}function getURLForTranscriptContent(e){var t=JSON.stringify({url:e}),n=window.btoa(t);return BASE_URL+CONTEXT_PATH+"transcript/show-content?payload="+n}function convertToVTT(e){if(!e.endsWith(".mp4"))return null;const t=new URL(e),n=t.pathname.replace(/\/([^\/]+)-(\d+\.\d+)\.mp4$/,"/$1-transcript-$2.vtt");let a=t.origin+n;if(a===e){const t="https://ischoolingwise.s3.us-east-1.amazonaws.com/recordings/";a=`${t}${e.split(t)[1].split("-")[0]}-transcript-1.1.vtt`}return a}function displayVTT(e,t){const n=$("#transcript-modal-body");(n.empty(),e.includes("<Error><Code>"))?n.append('<p style="font-size: 18px;">No Transcript Available</p>'):e.split("\n").forEach((e=>{var t=$("<p></p>").text(e);n.append(t)}));$("#transcriptModalTitle").html(t),$("#transcriptModal").modal("show")}function showVTTFile(e,t){0===$("#transcriptModal").length&&$("body").append(`\n      <div id="transcriptModal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: flex; justify-content: center; align-items: center; z-index: 10000;">\n        <div style="background: white; border-radius: 12px; overflow: hidden; width: 70%; max-width: 70%;margin: auto; margin-top:50px;">\n          <div class="" style="height: 100%; display: flex; flex-direction: column;">\n            <div class="d-flex justify-content-between align-items-center" style="padding: 15px 10px; background: #027FFF;">\n              <h5 id="transcriptModalTitle" class="text-white mb-0" style="font-size: 18px; font-weight: bold;">${t}</h5>\n              <button type="button" class="text-white btn btn-sm btn-danger" data-bs-dismiss="modal" aria-label="Close" style="font-size: 20px !important; margin: 0; padding: 0px 8px;" onclick="closeTranscriptModal();">&times;</button>\n            </div>\n            <div id="transcript-modal-body" class="text-left" style="flex-grow: 1; padding: 20px; height: 70vh; overflow-y: auto;">\n              \x3c!-- Transcript content will be populated here --\x3e\n            </div>\n          </div>\n        </div>\n      </div>\n    `),customLoader(!0);const n=convertToVTT(e);$.ajax({type:"GET",contentType:"application/json",dataType:"json",url:getURLForTranscriptContent(n),success:function(e){customLoader(!1),displayVTT(e.content,t)},error:function(){customLoader(!1),showMessageTheme2(0,"Failed to load transcript.","",!0)}})}function closeAllVideoModal(){$("#recordingModal").modal("hide")}function closeVideoModal(){const e=$("#videoModal .videoTag")[0];e&&(e.pause(),e.currentTime=0),$("#videoModal").modal("hide"),$("#videoModal").remove()}function closeTranscriptModal(){$("#transcriptModal").modal("hide")}function getFilterState(e){return{filterHostUserId:e,filterDateDuration:"Today",filterMeetingStartDate:"",filterMeetingEndDate:""}}function getHostDetails(e){return{key:e}}function handleAddAttendee(){const e=$("#attendees").val().trim();e.length>0&&(validateEmail(e)?addAttendee(e):showMessageTheme2(0,"The attendee selection seems incorrect. Please choose a valid attendee"))}function getAttendeesList(){var e=$("#attendees").val().trim();e.length>=3?$.ajax({url:BASE_URL+CONTEXT_PATH+`api/v1/get-all-user-list?searchKeyWords=${e}`,method:"GET",contentType:"application/json",async:!0,global:!1,success:function(e){try{const t="string"==typeof e?JSON.parse(e):e;cachedUserList=t.data?.userList||[],$("#dynamic-attendees-list").empty(),"success"===t.status&&cachedUserList.length?($("#dynamic-attendees-list").show(),cachedUserList.forEach((e=>{selectedAttendees.some((t=>t.userId===e.userId))||$("#dynamic-attendees-list").append(`<li class="rounded px-3 py-1 my-2 selectable" \n                      style="background-color:white; cursor:pointer;" \n                      data-user="${e.userId}">\n                    ${e.userName} | ${e.enrollmentNo}\n                  </li>`)})),$(".selectable").on("click",(function(){addAttendee($(this).data("user"),$(this).text().trim()),$("#dynamic-attendees-list").hide(),$("#attendees").val("")}))):$("#dynamic-attendees-list").hide()}catch(e){console.error("Error parsing JSON response: ",e.message),showMessageTheme2(0,"Failed to parse the attendees data.")}},error:function(e){checkonlineOfflineStatus()||(console.error("Error fetching user list: ",e),showMessageTheme2(0,"Please enter a valid name or email."))}}):$("#dynamic-attendees-list").hide()}function addAttendee(e,t){selectedAttendees.some((t=>t.userId==e))?showMessageTheme2(0,"Already added, select another one."):(selectedAttendees.push({userId:e,userName:t}),renderSelectedAttendees(),$("#attendees").val(""))}function renderSelectedAttendees(){$("#selected-attendees-list").empty(),selectedAttendees.forEach((e=>{$("#selected-attendees-list").append(`<span class="badge bg-white p-2 m-2 rounded d-flex align-items-center" \n          style="gap:10px;color:black;font-size:12px;text-transform: none;">\n        ${null==e.userName?e.userId:e.userName}\n        <button data-user="${e.userId}" class="btn-close" \n          style="background: red; color: white; border: none; padding: 1px 5px; \n          border-radius: 50%; cursor: pointer; font-size: 17px;">\n          &times;\n        </button>\n      </span>`)})),bindRemoveAttendeeEvent()}function bindRemoveAttendeeEvent(){$(".btn-close").off("click").on("click",(function(){const e=$(this).data("user");selectedAttendees=selectedAttendees.filter((t=>t.userId!=e)),renderSelectedAttendees()}))}function getCurrentWeekDates(){let e=new Date,t=new Date(e.setDate(e.getDate()-e.getDay())),n=new Date(e.setDate(e.getDate()-e.getDay()+6));return{startOfWeek:changeDateFormat(t,"yyyy-mm-dd"),endOfWeek:changeDateFormat(n,"yyyy-mm-dd")}}function showRecurringMeetingRecordings(e,t,n){const{startOfWeek:a,endOfWeek:i}=getCurrentWeekDates();var o={entityId:e,meetingStartDate:a,meetingEndDate:i,limit:10,pageNo:currentPageRecurringRecording};$.ajax({url:BASE_URL+CONTEXT_PATH+"api/v1/get-recurring-recordings-list",type:"POST",data:JSON.stringify(o),contentType:"application/json",success:function(o){var r=JSON.parse(o);try{populateRecurringRecording(r.data,t,n,e,a,i,r.recordingsTotalPages),0!=r.recordingsTotalPages&&$("#recurringPaginationContainer").html(renderPagination(currentPageRecurringRecording,r.recordingsTotalPages))}catch(e){console.log("Error Fetching Data:",e)}}})}function toggleRecording(e){$(`#recording-${e}`).slideToggle()}function closeRecurringModal(){$("#recurringMeetingModal").removeClass("open"),$("#recurringMeetingBackdrop").fadeOut(200),setTimeout((()=>{$("#recurringMeetingModal").remove(),$("#recurringMeetingBackdrop").remove(),$("body").css("overflow","auto")}),300),currentPageRecurringRecording=1}function applyRecurringRecordingFilters(e){event.preventDefault();var t={entityId:e,meetingStartDate:""==$("#filterRecurringMeetingStartDate").val()?"":changeDateFormat(new Date($("#filterRecurringMeetingStartDate").val()),"yyyy-mm-dd"),meetingEndDate:""==$("#filterRecurringMeetingEndDate").val()?"":changeDateFormat(new Date($("#filterRecurringMeetingEndDate").val()),"yyyy-mm-dd"),limit:10,pageNo:currentPageRecurringRecording};$.ajax({url:BASE_URL+CONTEXT_PATH+"api/v1/get-recurring-recordings-list",type:"POST",data:JSON.stringify(t),contentType:"application/json",success:function(t){var n=JSON.parse(t);try{updateRecordingsTable(n.data),$("#recurringMeetingModal").data("entityId",e),n.recordingsTotalPages>0?$("#recurringPaginationContainer").html(renderPagination(currentPageRecurringRecording,n.recordingsTotalPages)):$("#recurringPaginationContainer").html("")}catch(e){console.log("Error Fetching Data:",e)}}})}function getGeneralMeetingTypeList(e){$.ajax({type:"GET",contentType:"application/json",dataType:"json",url:BASE_URL+CONTEXT_PATH+"api/v1/get-meeting-types",success:function(t){var n=t.data.meetingTypes,a=$(e);a.empty(),a.append('<option value="">Select General Meeting Type</option>'),n&&n.length>0&&n.forEach((function(e){a.append(`<option value="${e}">${e}</option>`)})),a.append('<option value="Other">Other</option>'),$(a).select2({placeholder:"Select General Meeting Type",allowClear:!0})},error:function(){console.error("Failed to load meeting types.")}})}$(document).on("mouseover",".meeting-item",(function(){const e=$(this).data("details");showConflictTooltip(e,this)})),$(document).on("mouseout",".meeting-item",(function(){hideConflictTooltip()})),$(document).on("mouseout",".meeting-item",(function(){hideConflictTooltip()}));