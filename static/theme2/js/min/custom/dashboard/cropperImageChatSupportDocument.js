var cropper,currentInputId,currentThumbId,base64URLElementID,viewBtn,removeBtn,canvas,index,fileName="",fileType="",docType="",base64URL="",standardID="",uploadDocs=[],showAddMoreBtnArray=[3,4,5];function convertToBase64(e,a){var t=document.querySelector("#"+e).files[0],o=new FileReader;o.onload=function(t){var o;base64URL=t.target.result;var r=Math.random();o="pdf"===a?"abc"+(r=r.toString().split(".")[1])+"."+a:"file"+(r=r.toString().split(".")[1])+"."+a,$("#"+e).parent().attr("data-PDFURL",base64URL),$("#"+e).parent().attr("fileName",o),$("#"+e).parent().attr("uploaded","Y")},o.readAsDataURL(t)}function cropImageChatSupport(e,a,t,o,r,d,p,n){var l=$("#"+a)[0].files[0].size;if(Math.round(l/1024)<=5120){currentInputId=a,currentThumbId=t,base64URLElementID=o,viewBtn=p,docType=r,index=n,standardID=d;var s=e.target.files;if("pdf"==(fileType=(fileType=s[0].type.split("/"))[1]))convertToBase64(a,"pdf"),$("#"+base64URLElementID).attr("src",PATH_FOLDER_IMAGE2+"pdf.jpg"+SCRIPT_VERSION),$("#"+base64URLElementID).attr("thumbType","pdf"),$("#"+base64URLElementID).hide(),$("#"+viewBtn).show(),$("#documentType"+index).attr("disabled",!0);else if("jpg"==fileType||"jpeg"==fileType||"png"==fileType){var i,c,u=function(e){currentInputId.value="",$("#cropModalImgChatSuport").attr("src",""),setTimeout((function(){$("#cropModalImgChatSuport").attr("src",e),$("#cropModalChatSuport").modal("show"),"Profile Image"==docType?$("#crop").text("Crop & Save"):$("#crop").text("Crop")}),10)};if(s&&s.length>0){c=s[0];var m=Math.random();m=m.toString().split(".")[1],fileName="file"+m+"."+fileType,URL?u(URL.createObjectURL(c)):FileReader&&((i=new FileReader).onload=function(e){u(i.result)},i.readAsDataURL(c))}$("#"+a).val("")}else $("#"+a).val(""),showMessageTheme2(2,"Please upload files in PDF, JPG, PNG, and JPEG Format")}else $("#"+a).val(""),showMessageTheme2(2,"Please upload files in PDF, JPG, PNG, and JPEG with max size of 5MB")}function cropImgfun(){customLoader(!0),cropper&&(canvas=cropper.getCroppedCanvas({}),$("#"+base64URLElementID).attr("thumbType","img"),$("#"+base64URLElementID).attr("data-PDFURL",canvas.toDataURL()),$("#"+base64URLElementID).attr("fileName",fileName),$("#"+base64URLElementID).attr("uploaded","Y"),$("#"+base64URLElementID).hide(),$("#"+viewBtn).show(),$("#documentType"+index).attr("disabled",!0),$("#"+currentInputId).parent().children().hasClass("file-select-name")&&$("#"+currentInputId).parent().find(".file-select-name").text(fileObj.fileName),console.log(uploadDocs),canvas.toBlob((function(e){(new FormData).append("avatar",e,"avatar.jpg")})),"Profile Image"==docType&&saveDocs(USER_ID,standardID,docType),customLoader(!1)),$("#cropModalChatSuport").modal("hide")}function rotateImage(){cropper&&cropper.rotate(90)}function viewAttachmentChatSupport(e,a,t,o){var r=$("#"+o).attr("thumbType");base64URL=$("#"+o).attr("data-PDFURL"),console.log(base64URL),"I"==t&&"pdf"!=r?($("#"+a+" .upload_img img").attr("src",base64URL),$("#"+a+" .upload_img").removeClass("d-none"),$("#"+a+" .upload_pdf").addClass("d-none")):($("#"+a+" .upload_pdf .pre_upload_pdf").remove(),$("#"+a+" .upload_pdf#pre_upload_pdf_div").append('<object type="application/pdf" class="pre_upload_pdf full" style="height: 400px;" data="'+base64URL+'"></object>'),$("#"+a+" .upload_pdf a.download-pdf-btn").attr("href",base64URL),$("#"+a+" .upload_pdf").removeClass("d-none"),$("#"+a+" .upload_img").addClass("d-none")),$("#"+a).modal("show")}function resetChatSupportFormElement(){removeUploadImageChatSupport(this,"OD3","OD3Icon","Other Document 3","","OD3div","OD3ViewAndRemoveBtn",3),$("#chatDate").val(""),$("#chatDate").data("datepicker").clearDates(),$("#OD3").val(""),uploadDocs=[]}function removeUploadImageChatSupport(e,a,t,o,r,d,p,n){$("#"+p).hide(),$("#"+d).show(),$("#"+d).attr("filename",""),$("#"+d).attr("uploaded","D"),$("#"+d).attr("thumbtype",""),$("#"+d).attr("data-pdfurl",""),$("#"+a).val(""),$(".removeDocBtn").each((function(e){$(this).attr("style"),$("#allDocsNotUploaded").show(),$("#allDocsUploaded").hide()}))}$(document).on("shown.bs.modal","#cropModalChatSuport",(function(){cropper=new Cropper($("#cropModalImgChatSuport")[0],{aspectRatio:NaN})})).on("hidden.bs.modal","#cropModalChatSuport",(function(){null!=cropper&&(cropper.destroy(),cropper=null)})),$(document).on("hidden.bs.modal",(function(e){"0"==$(".modal.show").length?($("body").css({"padding-right":"0"}),$("body").removeClass("modal-open")):($("body").css({"padding-right":"17px"}),$("body").addClass("modal-open"))}));