var cropper,currentInputId,currentThumbId,canvas,fileName="",fileType="",docType="",base64URL="",standardID="",uploadDocs=[];function addDocs(e,a){$.each(e,(function(o,t){t.docType==a.docType&&(e[o]=a)}))}function convertToBase64(e,a){var o=document.querySelector("#"+e).files[0],t=new FileReader;t.onload=function(o){var t;base64URL=o.target.result;var r=Math.random();t="pdf"===a?"abc"+(r=r.toString().split(".")[1])+"."+a:"file"+(r=r.toString().split(".")[1])+"."+a,$("#"+e).parent().attr("data-PDFURL",base64URL);var d=new Object({filePath:base64URL,fileName:t,docType,imgID:currentThumbId});uploadDocs.some((e=>e.docType===d.docType))||uploadDocs.push(d),addDocs(uploadDocs,d),console.log(uploadDocs)},t.readAsDataURL(o)}function cropImage(e,a,o,t,r){var d=$("#"+a)[0].files[0].size;if(Math.round(d/1024)<=5120){currentInputId=a,currentThumbId=o,docType=t,standardID=r;var p=e.target.files;if("pdf"==(fileType=(fileType=p[0].type.split("/"))[1])){if("Profile Image"==docType)return showMessageTheme2(2,"Please upload files in JPG, PNG, and JPEG with max size of 5MB"),$("#"+a).val(""),!1;convertToBase64(a,"pdf"),$("#"+currentThumbId).attr("src",PATH_FOLDER_IMAGE2+"pdf.jpg"+SCRIPT_VERSION),$("#"+currentThumbId).attr("thumbType","pdf"),$("#"+currentInputId+"Remove").show(),$("#"+currentInputId+"div").hide()}else if("jpg"==fileType||"jpeg"==fileType||"png"==fileType){var n,c,l=function(e){currentInputId.value="",$("#cropModalImg").attr("src",""),setTimeout((function(){$("#cropModalImg").attr("src",e),$("#cropModal").modal("show"),"Profile Image"==docType?$("#crop").text("Crop & Save"):$("#crop").text("Crop")}),10)};if(p&&p.length>0){c=p[0];var s=Math.random();s=s.toString().split(".")[1],fileName="file"+s+"."+fileType,URL?l(URL.createObjectURL(c)):FileReader&&((n=new FileReader).onload=function(e){l(n.result)},n.readAsDataURL(c))}$("#"+a).val("")}else $("#"+a).val(""),showMessageTheme2(2,"Please upload files in PDF, JPG, PNG, and JPEG Format")}else $("#"+a).val(""),showMessageTheme2(2,"Please upload files in PDF, JPG, PNG, and JPEG with max size of 5MB")}function rotateImage(){cropper&&cropper.rotate(90)}function viewAttachment(e,a,o){var t=$(e).find("img").attr("thumbType");if("I"==o&&"pdf"==t)var r=$(e).next().attr("data-PDFURL");else if("P"==o&&""==t)r=$(e).attr("data-PDFURL");else r=$(e).find("img").attr("src");console.log(r),"I"==o&&"pdf"!=t?($("#"+a+" .upload_img img").attr("src",r),$("#"+a+" .upload_img").removeClass("d-none"),$("#"+a+" .upload_pdf").addClass("d-none")):($("#"+a+" .upload_pdf .pre_upload_pdf").remove(),$("#"+a+" .upload_pdf#pre_upload_pdf_div").append('<object type="application/pdf" class="pre_upload_pdf full" style="height: 400px;" data="'+r+'"></object>'),$("#"+a+" .upload_pdf a.download-pdf-btn").attr("href",r),$("#"+a+" .upload_pdf").removeClass("d-none"),$("#"+a+" .upload_img").addClass("d-none")),$("#"+a).modal("show")}$(document).ready((function(){$("#cropModal").on("shown.bs.modal",(function(){cropper=new Cropper($("#cropModalImg")[0],{aspectRatio:NaN})})).on("hidden.bs.modal",(function(){cropper&&(cropper.destroy(),cropper=null)})),$("#crop").on("click",(function(){if(customLoader(!0),$("#cropModal").modal("hide"),cropper){canvas=cropper.getCroppedCanvas({}),$("#"+currentThumbId).attr("src"),$("#"+currentThumbId).attr("src",canvas.toDataURL()),$("#"+currentThumbId).attr("thumbType","img"),$("#"+currentInputId).parent().attr("data-PDFURL",canvas.toDataURL()),$("#"+currentInputId).parent().attr("fileName",fileName),$("#"+currentInputId+"Remove").show(),$("#"+currentInputId+"div").hide();var e=new Object({filePath:canvas.toDataURL(),fileName,docType,imgID:currentThumbId});uploadDocs.some((a=>a.docType===e.docType))||uploadDocs.push(e),addDocs(uploadDocs,e),$("#"+currentInputId).parent().children().hasClass("file-select-name")&&$("#"+currentInputId).parent().find(".file-select-name").text(e.fileName),console.log(uploadDocs),canvas.toBlob((function(e){(new FormData).append("avatar",e,"avatar.jpg")})),"Profile Image"==docType&&saveDocs(USER_ID,standardID,docType),customLoader(!1)}}))}));