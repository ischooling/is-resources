var watiTemplateContent,itiAltPhoneNumber,itiPhoneNumber;function validateRequestForLeadSave(e,t,a,o){hideMessage("");if("leadlist"==a){if(null==$("#"+e+" #leadUpdateSource").val()||"0"==$("#"+e+" #leadUpdateSource").val())return t?showMessageTheme2(0,"Please select Lead Source","",!0):showMessage(!0,"Please select Lead Source"),!1}else if("leadlistPopup"==a||"new-leadlistPopup"==a){if("edit"!=$("#"+e+" #countrolType").val()){if(null==$("#"+e+" #leadSource").val()||"0"==$("#"+e+" #leadSource").val()||""==$("#"+e+" #leadSource").val())return t?showMessageTheme2(0,"Please select Lead Source","",!0):showMessage(!0,"Please select Lead Source"),!1;if("B2B"!=o&&(null==$("#"+e+" #leadGrade").val()||""==$("#"+e+" #leadGrade").val()))return t?showMessageTheme2(0,"Please choose grade","",!0):showMessage(!0,"Please choose grade"),!1}if(null==$("#"+e+" #leademailId").val()||""==$("#"+e+" #leademailId").val()){if(!t)return showMessage(!0,"Please fill Email"),!1;if(null==$("#"+e+" #phoneNo").val()||""==$("#"+e+" #phoneNo").val())return showMessageTheme2(0,"Please enter email or phone no","",!0),!1}if(null!=$("#"+e+" #leademailId").val()&&""!=$("#"+e+" #leademailId").val()&&!validateEmail($("#"+e+" #leademailId").val()))return t?showMessageTheme2(0,"Email is either empty or invalid","",!0):showMessage(!0,"Email is either empty or invalid"),!1;if(null==$("#"+e+" #phoneNo").val()||""==$("#"+e+" #phoneNo").val()){if(!t)return showMessage(!0,"Please enter phone no"),!1;if(null==$("#"+e+" #leademailId").val()||""==$("#"+e+" #leademailId").val())return showMessageTheme2(0,"Please enter email or phone no","",!0),!1}if(""!=$("#"+e+" #phoneNo").val()&&null!=$("#"+e+" #phoneNo").val()&&(null==$("#"+e+" #isdCode").val()||"0"==$("#"+e+" #isdCode").val()))return t?showMessageTheme2(0,"Please choose ISD Code","",!0):showMessage(!0,"Please choose ISD Code"),!1;if(null==$("#"+e+" #leadstdfname").val()||""==$("#"+e+" #leadstdfname").val())return t?showMessageTheme2(0,"Please enter Student's First Name","",!0):showMessage(!0,"Please enter Student's First Name"),!1;if("edit"!=$("#"+e+" #countrolType").val()){if(null==$("#"+e+" #leadStatus").val()||""==$("#"+e+" #leadStatus").val())return t?showMessageTheme2(0,"Please choose Lead Status","",!0):showMessage(!0,"Please choose Lead Status"),!1;if(null==$("#"+e+" #leadAssignTo").val()||0==$("#"+e+" #leadAssignTo").val())return t?showMessageTheme2(0,"Please select Lead Assigned To","",!0):showMessage(!0,"Please select Lead Assigned To"),!1}}else if("dashboard"==a){if(null==$("#"+e+" #leadSource").val()||"0"==$("#"+e+" #leadSource").val())return t?showMessageTheme2(0,"Please select Lead Source","",!0):showMessage(!0,"Please select Lead Source"),!1;if(null==$("#"+e+" #phoneNo").val()||""==$("#"+e+" #phoneNo").val())return t?showMessageTheme2(0,"Please enter phone no","",!0):showMessage(!0,"Please enter phone no"),!1;if(null==$("#"+e+" #leadAssignTo").val()||0==$("#"+e+" #leadAssignTo").val())return t?showMessageTheme2(0,"Please select Lead Assigned To","",!0):showMessage(!0,"Please select Lead Assigned To"),!1}else{if("leadMergeDataPopupForm"!=e&&"leadMergeDataPopupB2BForm"!=e){if(null==$("#"+e+" #leadSource").val()||"0"==$("#"+e+" #leadSource").val())return t?showMessageTheme2(0,"Please select Lead Source","",!0):showMessage(!0,"Please select Lead Source"),!1;if(null==$("#"+e+" #leademailId").val()||""==$("#"+e+" #leademailId").val()){if(!t)return showMessage(!0,"Please fill Email"),!1;if(null==$("#"+e+" #phoneNo").val()||""==$("#"+e+" #phoneNo").val())return showMessageTheme2(0,"Please enter email or phone no","",!0),!1}if(null!=$("#"+e+" #leademailId").val()&&""!=$("#"+e+" #leademailId").val()&&!validateEmail($("#"+e+" #leademailId").val()))return t?showMessageTheme2(0,"Email is either empty or invalid","",!0):showMessage(!0,"Email is either empty or invalid"),!1;if(null==$("#"+e+" #phoneNo").val()||""==$("#"+e+" #phoneNo").val()){if(!t)return showMessage(!0,"Please enter phone no"),!1;if(null==$("#"+e+" #leademailId").val()||""==$("#"+e+" #leademailId").val())return showMessageTheme2(0,"Please enter email or phone no","",!0),!1}if(""!=$("#"+e+" #phoneNo").val()&&null!=$("#"+e+" #phoneNo").val()&&(null==$("#"+e+" #isdCode").val()||"0"==$("#"+e+" #isdCode").val()))return t?showMessageTheme2(0,"Please choose ISD Code","",!0):showMessage(!0,"Please choose ISD Code"),!1;if(null==$("#"+e+" #leadstdfname").val()||""==$("#"+e+" #leadstdfname").val())return t?showMessageTheme2(0,"Please enter Student's First Name","",!0):showMessage(!0,"Please enter Student's First Name"),!1;if(null==$("#"+e+" #leadStatus").val()||""==$("#"+e+" #leadStatus").val())return t?showMessageTheme2(0,"Please choose Lead Status","",!0):showMessage(!0,"Please choose Lead Status"),!1;if(null==$("#"+e+" #leadAssignTo").val()||0==$("#"+e+" #leadAssignTo").val())return t?showMessageTheme2(0,"Please select Lead Assigned To","",!0):showMessage(!0,"Please select Lead Assigned To"),!1;if(null==$("#"+e+" #leadRemark").val()||""==$("#"+e+" #leadRemark").val())return t?showMessageTheme2(0,"Please fill Lead Remarks","",!0):showMessage(!0,"Please fill Lead Remarks"),!1}if("B2B"!=o&&(null==$("#"+e+" #leadGrade").val()||""==$("#"+e+" #leadGrade").val()))return t?showMessageTheme2(0,"Please choose grade","",!0):showMessage(!0,"Please choose grade"),!1}return!0}function submitLeads(e,t,a,o,l,n,s,r,d){if(o?hideMessageTheme2(""):hideMessage(""),!validateRequestForLeadSave(e,o,l,s))return!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","save-leads-form-data"),data:JSON.stringify(getRequestForLeadSave(e,l,s)),dataType:"json",cache:!1,timeout:6e5,success:function(t){return"0"==t.status||"FAILED"==t.status||"EXCEPTION"==t.status||"SESSIONOUT"==t.status?o?showMessageTheme2(0,t.message,"",!0):showMessage(!0,t.message):($("#documentDiv").html(""),o?"leadlist"==l?window.location.reload():"leadlistPopup"==l?(showMessageTheme2(1,t.message,"",!0),$("#"+n).modal("hide"),$(".b2cLeadsource").hide(),$(".b2bLeadsource").hide(),$(".b2bLeadstatus").hide(),$(".b2cLeadstatus").hide(),s=$("#leadType").val(),setTimeout((function(){advanceLeadSearchStudent("advanceLeadNewSearchForm","","advance-search","","0","new",!0,"",""+s)}),100)):"new-leadlistPopup"==l||"new-leadMergePopup"==l?(showMessageTheme2(1,t.message,"",!0),$("#"+n).modal("hide"),$(".b2cLeadsource").hide(),$(".b2bLeadsource").hide(),$(".b2bLeadstatus").hide(),$(".b2cLeadstatus").hide(),s=$("#leadType").val(),setTimeout((function(){getLeadDataList("advanceLeadNewSearchForm","advance-search","list","0","new",!0,"",r,d)}),100)):(showMessageTheme2(1,t.message,"",!0),$("#"+n).modal("hide"),advanceLeadSearchStudent("advanceLeadNewSearchForm","","advance-search","","0","new",!0,"",""+s)):(showMessage(!1,t.message),$("#"+e)[0].reset(),setTimeout((function(){if("dashboard"==l){$("#addNewLeadModal").modal("hide"),$(".modal-backdrop").remove();var e="/dashboard/lead-data-list?moduleId="+moduleId+"&leadFrom=LEAD&clickFrom=list&startDate=&endDate=&country=0&campaign=&currentPage=0&euid="+ENCRYPTED_USER_ID+"&leadType="+s;getAsPost(e),customLoader(!1)}else window.location.reload()}),800)),$("#"+e)[0].reset(),$("#"+e+" #leadId").val(""),$("#"+e+" #parentleadId").val(""),$("#"+e+" #academicId").val(""),$("#"+e+" #leadNo").val(""),$("#"+e+" #rawLeadId").val(""),$("#"+e+" #relationType").val(""),$("#"+e+" #leadSourceGroup").val(""),$("#"+e+" #countrolType").val(""),$("#"+e+" #mergeLeads").val(""),$("#"+e+" #leadTagging").val(0).trigger("change"),$("#leadNoMove").val(""),$("#leadDataList .checkLead").prop("checked",!1)),!1},error:function(e){return!1}})}function getRequestForLeadSave(e,t,a){var o={},l={},n={},s={},r={},d={},i={},c={};if(s.isUserWise=!1,s.isLeadSearch=!1,s.leadType=a,"leadlist"==t)s.leadSource=$("#leadUpdateSource").val(),s.leadId=$("#leadUpdateId").val(),s.leadDataFrom="leadlist";else if("leadlistPopup"==t||"new-leadlistPopup"==t||"new-leadMergePopup"==t)s.leadSource=$("#"+e+" #leadSource").val(),s.leadId=$("#"+e+" #leadId").val(),r.stdDob=$("#"+e+" #leadDOB").val(),r.gender=$("#"+e+" #leadGender option:selected").val(),r.standard=$("#"+e+" #leadGrade option:selected").val(),r.email=$("#"+e+" #leademailId").val(),r.isdCountryCode=$("#"+e+" #pCountryCode").val(),r.isdCode=$("#"+e+" #isdCode").val(),r.phoneNo=$("#"+e+" #phoneNo").val(),r.emailAlternet=$("#"+e+" #leademailAlternet").val(),r.isdCountryCodeAlter=$("#"+e+" #pCountryCodeAlter").val(),r.isdCodeAlter=$("#"+e+" #isdCodeAlter").val(),r.phoneNoAlter=$("#"+e+" #phoneNoAlter").val(),r.stdFname=escapeCharacters($("#"+e+" #leadstdfname").val()),r.stdMname=escapeCharacters($("#"+e+" #leadstdmname").val()),r.stdLname=escapeCharacters($("#"+e+" #leadstdlname").val()),r.gurdianFname=escapeCharacters($("#"+e+" #leadGuardfname").val()),r.gurdianMname=escapeCharacters($("#"+e+" #leadGuardmname").val()),r.gurdianLname=escapeCharacters($("#"+e+" #leadGuardlname").val()),r.country=$("#"+e+" #countryId option:selected").val(),r.state=$("#"+e+" #stateId option:selected").val(),r.city=$("#"+e+" #cityId option:selected").val(),r.address=escapeCharacters($("#"+e+" #leadAdd").val()),r.pincode=$("#"+e+" #leadPin").val(),s.leadAddName=$("#"+e+" #leadAdder").val(),s.controlType=$("#"+e+" #countrolType").val(),s.assignTo=$("#"+e+" #leadAssignTo").val(),c.leadFollowStatus=$("#"+e+" #leadStatus").val(),s.leadStatus=$("#"+e+" #leadStatus").val(),s.parentleadId=$("#"+e+" #parentleadId").val(),d.remarks=escapeCharacters($("#leadRemark").val()),c.leadTagging=$("#"+e+" #leadTagging").val(),d.mergeLeadsId=$("#"+e+" #mergeLeads").val(),s.leadDataFrom="leadlistPopup";else if("dashboard"==t)s.leadSource=$("#leadSource").val(),s.assignTo=$("#leadAssignTo").val(),r.isdCode=$("#isdCode option:selected").val(),r.phoneNo=$("#phoneNo").val(),r.gurdianFname=escapeCharacters($("#leadGuardfname").val()),s.leadStatus="Assigned Working",s.leadDataFrom="dashboard",d.controlType="add";else{null!=$("#"+e+" #leadSource").val()&&(s.leadSource=$("#"+e+" #leadSource").val()),r.stdDob=$("#"+e+" #leadDOB").val(),r.gender=$("#"+e+" #leadGender option:selected").val(),r.email=$("#"+e+" #leademailId").val(),r.isdCountryCode=$("#"+e+" #pCountryCode").val(),r.isdCode=$("#"+e+" #isdCode").val(),r.phoneNo=$("#"+e+" #phoneNo").val(),r.emailAlternet=$("#"+e+" #leademailAlternet").val(),r.isdCountryCodeAlter=$("#"+e+" #pCountryCodeAlter").val(),r.isdCodeAlter=$("#"+e+" #isdCodeAlter").val(),r.phoneNoAlter=$("#"+e+" #phoneNoAlter").val(),r.stdFname=escapeCharacters($("#"+e+" #leadstdfname").val()),r.stdMname=escapeCharacters($("#"+e+" #leadstdmname").val()),r.stdLname=escapeCharacters($("#"+e+" #leadstdlname").val()),r.standard=$("#"+e+" #leadGrade option:selected").val(),r.gurdianFname=escapeCharacters($("#"+e+" #leadGuardfname").val()),r.gurdianMname=escapeCharacters($("#"+e+" #leadGuardmname").val()),r.gurdianLname=escapeCharacters($("#"+e+" #leadGuardlname").val()),r.country=$("#"+e+" #countryId option:selected").val(),r.state=$("#"+e+" #stateId option:selected").val(),r.city=$("#"+e+" #cityId option:selected").val(),r.address=escapeCharacters($("#"+e+" #leadAdd").val()),r.pincode=$("#"+e+" #leadPin").val(),s.parentleadId=$("#"+e+" #parentleadId").val(),s.leadId=$("#"+e+" #leadId").val(),s.leadNo=$("#"+e+" #leadNo").val(),s.academicId=$("#"+e+" #academicId").val(),s.leadOthers=$("#"+e+" #leadOthers").val(),s.leadDate=$("#"+e+" #leadDate").val(),s.leadMsg=escapeCharacters($("#"+e+" #leadStdMsg").val()),null!=$("#"+e+" #leadStatus").val()&&(s.leadStatus=$("#"+e+" #leadStatus").val()),null!=$("#"+e+" #leadAssignTo").val()&&(s.assignTo=$("#"+e+" #leadAssignTo option:selected").val(),s.assignName=$.trim($("#"+e+" #leadAssignTo option:selected").text().split("-")[0]),i.leadAssignUserEmail=$.trim($("#"+e+" #leadAssignTo option:selected").text().split("-")[1].replace("(","").replace(")",""))),i.rawLeadId=$("#"+e+" #rawLeadId").val(),i.demoSessionDateTime=$("#"+e+" #demoSessionDateTime").val(),null!=$("#"+e+" #leadDemoAssign").val()&&(i.demoAssignTo=$("#"+e+" #leadDemoAssign option:selected").val());var u="N";"B2B"==a&&null!=$("#"+e+" #checkWtsupno").val()&&$("#"+e+" #checkWtsupno").is(":checked")&&(u="Y"),d.checkWtsupNo=u,d.priority=$("#"+e+" #leadPriority").val(),d.remarks=escapeCharacters($("#"+e+" #leadRemark").val()),s.leadAddName=$("#"+e+" #leadAdder").val(),s.controlType=$("#"+e+" #countrolType").val(),d.mergeLeadsId=$("#"+e+" #mergeLeads").val()}return""==$("#"+e+" #leadSupportTo").val()&&null==$("#"+e+" #leadSupportTo").val()?s.leadSupportTo=0:s.leadSupportTo=$("#"+e+" #leadSupportTo").val(),n.leadModifyDTO=s,n.leadModifyDetailDTO=d,n.leadDemoInfo=i,n.leadStudentDetailDTO=r,n.leadCallFollowupDTO=c,l.hash=getHash(),l.schoolId=SCHOOL_ID,l.schoolUUID=SCHOOL_UUID,l.userId=USER_ID,l.userType="COMMON",o.authentication=l,o.leadCommonDTO=n,o.uploadDocuments=getUploadedDocuments(),o}function leadFollowup(e,t){$.ajax({type:"POST",url:getURLForHTML("dashboard","lead-followup"),data:{leadId:e,moduleId:t},dataType:"html",success:function(e){if(""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?showMessage(!0,t[1]):($("#followupContent").html(e),$("#followupform").modal("show"),$(".followCall").css("display","none"),$(".followMail").css("display","none"),$(".iNotSure").css("display","none"),$(".heNotSure").css("display","none"),$(".meetingSlotsDate").css("display","none"),$("#followupform").modal("show")),!1}return!1}})}function validateRequestForLeadFollowupSave(e,t,a){t?hideMessageTheme2(""):hideMessage(""),$(".errorLeadCls").css("display","none"),$("#errorMessageLead").html("");if(null==$("#"+e+" #followMed").val()||""==$("#"+e+" #followMed").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),t?(showMessageTheme2(0,"Please select Connected Through.","",!0),$("#errorMessageLead").html("Please select Connected Through.")):$("#errorMessageLead").html("Please select Connected Through."),!1;if(null==$("#"+e+" #callWith").val()||""==$("#"+e+" #callWith").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),t?(showMessageTheme2(0,"Select follow up last call with","",!0),$("#errorMessageLead").html("Select follow up last call with")):$("#errorMessageLead").html("Select follow up last call with"),!1;if(null==$("#"+e+" #leadStatus").val()||""==$("#"+e+" #leadStatus").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),t?(showMessageTheme2(0,"Select follow up lead Status","",!0),$("#errorMessageLead").html("Select follow up lead Status")):$("#errorMessageLead").html("Select follow up lead Status"),!1;if("B2B"==a){var o=$("#"+e+" #leadStatus").val(),l=$("#"+e+" #epdetailStatus").val();if("Converted & On Boarding | Hot"==o&&"Y"!=l)return showMessageTheme2(0,"Please update the Enrollment Partner Form before creating the partner dashboard.","",!0),!1}if(""==$("#"+e+" #nextDate").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),t?(showMessageTheme2(0,"Select next follow up","",!0),$("#errorMessageLead").html("Select next follow up")):$("#errorMessageLead").html("Select next follow up"),!1;if("CUSTOM"==$("#"+e+" #nextDate").val()&&(null==$("#"+e+" #notSureCallscheduleDate").val()||""==$("#"+e+" #notSureCallscheduleDate").val()))return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),t?(showMessageTheme2(0,"Enter follow up next date","",!0),$("#errorMessageLead").html("Enter follow up next date")):$("#errorMessageLead").html("Enter follow up next date"),!1;if("Demo Reschedule"==$("#"+e+" #leadStatus").val()){if(null==$("#"+e+" #bookMeeetingDate").val()||""==$("#"+e+" #bookMeeetingDate").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),$("#errorMessageLead").html("Please select a booked meeting date"),!1;if(null==$("#"+e+" #countryTimezoneId").val()||""==$("#"+e+" #countryTimezoneId").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),$("#errorMessageLead").html("Please select a country Timezone"),!1;if(null==$("input[name='slotTime']:checked").val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),t?(showMessageTheme2(0,"Please select any one Slot.","",!0),$("#errorMessageLead").html("Please select any one Slot.")):$("#errorMessageLead").html("Please select any one Slot."),!1}return!0}function submitLeadFollowupSave(e,t,a,o,l,n,s){$(".errorLeadCls").css("display","none"),$(".errorLeadCls").removeClass("success"),$("#errorMessageLead").html("");var r=$("#"+e+" #leadType").val();if(hideMessageTheme2(""),!validateRequestForLeadFollowupSave(e,o,r))return!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","save-leads-followup"),data:JSON.stringify(getRequestForLeadFollowupSave(e)),dataType:"json",cache:!1,timeout:6e5,success:function(d){return"0"==d.status||"2"==d.status?(o?(showMessageTheme2(0,d.message,"",!0),$("#errorMessageLead").html(d.message)):($(".errorLeadCls").css("display","block"),$("#errorMessageLead").html(d.message)),!1):(o?(showMessageTheme2(1,d.message,"",!1),$(".errorLeadCls").css("display","block"),$(".errorLeadCls").addClass("success"),$("#errorMessageLead").html(d.message),setTimeout((function(){$("#"+e)[0].reset(),$("#"+e+" #callWith").val("").trigger("change"),$("#"+e+" #leadStatus").val("").trigger("change"),$("#"+l).modal("hide"),"time-available"==a||"lead-list-update"==a||("new-lead-list"==a?getLeadDataList("advanceLeadNewSearchForm","advance-search","list",d.extra,"new",!0,"",n,s):advanceLeadSearchStudent("advanceLeadNewSearchForm",t,"advance-search","list",d.extra,"new",!0,"",r)),customLoader(!1)}),300)):($(".errorLeadCls").css("display","block"),$(".errorLeadCls").addClass("success"),$("#errorMessageLead").html(d.message)),setTimeout((function(){$("#followupform").modal("hide")}),300),!1)},error:function(e){return!1}})}function getRequestForLeadFollowupSave(e){var t={},a={},o={},l={},n={},s={};return l.leadId=$("#"+e+" #leadId").val(),s.followupBy=$("#"+e+" #followMed").val(),$("input[name=leadTypeCategory]").is(":checked")&&(n.leadCategory=$("input[name=leadTypeCategory]:checked").val()),""!=$("#tentativeDate").val()?n.tentativeDate=$("#"+e+" #tentativeDate").val():n.tentativeDate="",""!=$("#"+e+" #followupRemarks").val()&&(s.followRemarks=escapeCharacters($("#"+e+" #followupRemarks").val())),s.followupRemarkBy=$("#"+e+" #followupRemarkBy").val(),s.callStatus=$("#"+e+" #callStatus").val(),s.toCall=$("#"+e+" #callWith").val(),s.leadFollowStatus=$("#"+e+" #leadStatus").val(),l.leadStatus=$("#"+e+" #leadStatus").val(),"Call Completed"!=$("#"+e+" #leadStatus").val()&&"Not Answering | Not reachable | Switch off"!=$("#"+e+" #leadStatus").val()||(s.callBadge="followup1"),"Call Completed | Hot"!=$("#"+e+" #leadStatus").val()&&"Call Completed | Warm"!=$("#"+e+" #leadStatus").val()&&"Call Completed | Cold"!=$("#"+e+" #leadStatus").val()||(s.callBadge="calldoneb2b"),"Positive to enrollment"==$("#"+e+" #leadStatus").val()&&(s.callBadge="positive"),"Share details over WhatsApp | e-mail"!=$("#"+e+" #leadStatus").val()&&"Phone | WhatsApp Call"!=$("#"+e+" #leadStatus").val()&&"Reached out on WhatsApp"!=$("#"+e+" #leadStatus").val()&&"Reached out on Phone Call"!=$("#"+e+" #leadStatus").val()&&"Reached out on Email"!=$("#"+e+" #leadStatus").val()||(s.callBadge="followup2"),"Need time"!=$("#"+e+" #leadStatus").val()&&"Other"!=$("#"+e+" #leadStatus").val()&&"Class Demo Needed"!=$("#"+e+" #leadStatus").val()&&"Class Demo Completed"!=$("#"+e+" #leadStatus").val()||(s.callBadge="followup3"),"Duplicate lead"!=$("#"+e+" #leadStatus").val()&&"Invalid | Cold"!=$("#"+e+" #leadStatus").val()||(s.callBadge="red"),"Rejected | Cold"==$("#"+e+" #leadStatus").val()&&(s.callBadge="rejected"),"Demo Needed"!=$("#"+e+" #leadStatus").val()&&"Demo Completed"!=$("#"+e+" #leadStatus").val()&&"Demo Reschedule"!=$("#"+e+" #leadStatus").val()&&"Demo Booked"!=$("#"+e+" #leadStatus").val()||(s.callBadge="yellow"),"Connect to Impact Recommended"!=$("#"+e+" #leadStatus").val()&&"Connect to Impact Booked"!=$("#"+e+" #leadStatus").val()&&"Connect to Impact Completed"!=$("#"+e+" #leadStatus").val()||(s.callBadge="cti"),"Booked Seat"==$("#"+e+" #leadStatus").val()&&(s.callBadge="darkgreen"),"Neutral"==$("#"+e+" #leadStatus").val()&&(s.callBadge="neutral"),"Assigned Working"!=$("#"+e+" #leadStatus").val()&&"Basic Details not Filled | Cold"!=$("#"+e+" #leadStatus").val()||(s.callBadge="gray"),"Converted"!=$("#"+e+" #leadStatus").val()&&"Converted & On Boarding | Hot"!=$("#"+e+" #leadStatus").val()||(s.callBadge="green"),"Looking for next year"==$("#"+e+" #leadStatus").val()&&(s.callBadge="nextyear"),"Request Under Review | Warm"==$("#"+e+" #leadStatus").val()&&(s.callBadge="under-review"),"Interested to Interview | Warm"!=$("#"+e+" #leadStatus").val()&&"Interested to Interview | Cold"!=$("#"+e+" #leadStatus").val()&&"Interested to Interview | Hot"!=$("#"+e+" #leadStatus").val()||(s.callBadge="int-inerview"),"Moving for the Next meeting | Warm"!=$("#"+e+" #leadStatus").val()&&"Moving for the Next meeting | Cold"!=$("#"+e+" #leadStatus").val()&&"Moving for the Next meeting | Hot"!=$("#"+e+" #leadStatus").val()||(s.callBadge="move-inerview"),"Interview Booked | Cold"==$("#"+e+" #leadStatus").val()&&(s.callBadge="inter-booked"),"Invalid"==$("#"+e+" #leadStatus").val()&&(s.callBadge="red"),""!=$("#"+e+" #nextDate").val()&&(s.customDate=$("#"+e+" #nextDate").val(),""!=$("#"+e+" #notSureHours").val()&&""!=$("#"+e+" #notSureMins").val()?s.callHrs=$("#"+e+" #notSureHours").val()+":"+$("#"+e+" #notSureMins").val()+" "+$("#"+e+" #notSureAMPM").val():callHrs="","CUSTOM"==$("#"+e+" #nextDate").val()?""!=$("#"+e+" #notSureCallscheduleDate").val()&&(s.notSureCallscheduleDate=$("#"+e+" #notSureCallscheduleDate").val()+" "+$("#"+e+" #notSureHours").val()+":"+$("#"+e+" #notSureMins").val()+" "+$("#"+e+" #notSureAMPM").val()):s.notSureCallscheduleDate=""),o.leadModifyDTO=l,o.leadModifyDetailDTO=n,o.leadCallFollowupDTO=s,o.leadDemoInfo={},a.hash=getHash(),a.schoolId=SCHOOL_ID,a.schoolUUID=SCHOOL_UUID,a.userId=USER_ID,a.userType="COMMON",t.currentPage=$("#"+e+" #currentPage").val(),t.authentication=a,t.leadCommonDTO=o,t}function leadFollowupActivityLogs(e,t,a){$.ajax({type:"POST",url:getURLForHTML("dashboard","lead-activity-logs"),data:{leadId:e,moduleId:t,logType:a},dataType:"html",success:function(e){if(""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?showMessage(!0,t[1]):"editLog"==a?($("#tblLeadEditLog").html(e),$("#editLogsTab").css("display","block"),$("#followupLogsTab").css("display","none")):($("#tblLeadFollowLog").html(e),$("#followupLogsTab").css("display","block"),$("#editLogsTab").css("display","none")),!1}return!1}})}function demoRequestAccept(e,t,a,o,l){hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","demo-request-accepted"),data:JSON.stringify(getRequestForDemoRequestAcceptSave(e,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"FAILED"==e.status||"EXCEPTION"==e.status||"SESSIONOUT"==e.status?showMessage(!0,e.message):(showMessage(!1,e.message),"pool"==l?setTimeout((function(){callDashboardPageSchool(t,"request-demo")}),3e3):"accept"==l&&callDashboardPageSchool(t,"accept-demo-list")),!1},error:function(e){return!1}})}function getRequestForDemoRequestAcceptSave(e,t,a){var o={},l={},n={},s={},r={};return r.rawLeadId=e,s.controlType=a,n.leadDemoInfo=r,n.leadModifyDTO=s,l.hash=getHash(),l.schoolId=SCHOOL_ID,l.schoolUUID=SCHOOL_UUID,l.userId=t,l.userType="COMMON",o.authentication=l,o.leadCommonDTO=n,o}function validateRequestLeadFreeSlotList(e){return hideMessage(""),null!=$("#"+e+" #bookMeeetingDate").val()&&""!=$("#"+e+" #bookMeeetingDate").val()||(showMessage(!0,"Please select book meeting date"),!1)}function showLeadFreeSlotList(e,t){if(hideMessage(""),!validateRequestLeadFreeSlotList(e))return!1;var a=$("#"+e+" #bookMeeetingDate").val(),o=$("#"+e+" #countryTimezoneId").val();$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","lead-free-slot-list"),data:JSON.stringify({moduleId:t,date:a,countryTimezoneId:o,lat:"",lon:"",requestType:"REQUESTDEMO",book:"Y"}),dataType:"html",success:function(e){if(""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?(showMessage(!0,t[1]),$("#freeSlotList").html("")):$("#freeSlotList").html(e),!1}return!1},error:function(e){showMessage(!0,e.responseText)}})}function discardRawDemoData(e,t,a,o){hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-raw-list-discard-request"),data:JSON.stringify(getRequestForDiscardRawDemoData(e,t,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?showMessage(!0,e.message):(showMessage(!1,e.message),setTimeout((function(){callDashboardPageSchool(a,"raw-lead-list")}),3e3)),!1},error:function(e){return!1}})}function getRequestForDiscardRawDemoData(e,t,a){var o={},l={},n={};return n.leadSourceId=t,n.leadSourceName=e,n.userId=a,l.hash=getHash(),l.userId=a,l.userType="COMMON",o.authentication=l,o.rawDiscardDTO=n,o}function discardLeadsData(e,t,a,o,l,n,s,r,d){n?hideMessageTheme2(""):hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-discard-request"),data:JSON.stringify(getRequestForDiscardLeadsData(e,a,o,l)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?n?showMessageTheme2(0,e.message,"",!0):showMessage(!0,e.message):n?(showMessageTheme2(1,e.message,"",!1),"new-leads"==d?getLeadDataList("advanceLeadNewSearchForm","advance-search","list","0","new",!0,"",OBJECT_RIGHTS,ROLE_MODULE):advanceLeadSearchStudent("advanceLeadNewSearchForm",t,"advance-search","list",s,"new",!0,"",r)):(showMessage(!1,e.message),setTimeout((function(){callForDashboardData("formIdIfAny","lead-list?moduleId="+t+"&leadFrom="+a+"&clickFrom=list&currentPage=0")}),3e3)),!1},error:function(e){return!1}})}function getRequestForDiscardLeadsData(e,t,a,o){var l={},n={},s={},r={};return r.leadId=e,r.clickFrom=t,r.leadSourceName=a,s.leadModifyDTO=r,n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userId=o,n.userType="COMMON",l.authentication=n,l.leadCommonDTO=s,l}function feedbackLeadsData(e,t,a,o,l){hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-update-remarks"),data:JSON.stringify(getRequestForRemarkLeadsData(e,t,a,o,l)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"!=e.status&&"2"!=e.status||showMessage(!0,e.message),!1},error:function(e){return!1}})}function getRequestForRemarkLeadsData(e,t,a,o,l){var n={},s={},r={};return r.id=t,r.superRemark=a,r.callVerify=e,r.superRemarkBy=o,s.hash=getHash(),s.schoolId=SCHOOL_ID,s.schoolUUID=SCHOOL_UUID,s.userId=l,s.userType="COMMON",n.authentication=s,n.leadCommonDTO=r,n}function getPendingNotCall(){$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","send-lead-notcall-cron"),dataType:"json",cache:!1,timeout:6e5,async:!1,success:function(e){if(""!=e){$(".custom_modal_wrapper").addClass("show-wrapper"),$(".custom-modal ul").empty();var t="";return $.each(e.leadCommonDTO,(function(e,a){t=(t=t+' <li class="modal_item" id="li'+a.leadId+'" style="top:0">')+' <p class="message">Lead Source.: '+a.leadSourceName+"<br/>Lead no.: "+a.leadNo+"<br/>Grade: "+a.standardName+"<br/>Student name: "+a.stdFname+"<br/>Phone No: "+a.isdCode+" "+a.phoneNo+"<br/>Next Call: "+a.notSureCallscheduleDateString+"<br/></p>",t=(t+=' <div class="input-wrapper">')+' <button type="button" class="submit-btn" onclick="leadFollowup('+a.leadId+', 111);">Call</button>',t+=" </div></li>"})),$(".custom-modal ul").append(t),$(".custom-modal ul").addClass("show-item"),!1}}})}function advanceLeadSearchStudent(e,t,a,o,l,n,s,r,d){checkTextBox(e);var i=0;if(null!=$("#leadsFollowCount").val()&&(i=$("#leadsFollowCount").val()),""!=$("#"+e+" #leadStartDateSearch").val()&&""!=$("#"+e+" #leadEndDateSearch").val()&&""==$("#"+e+" #searchDateType option:selected").val())return $(".leadErrorText").html("Please select type for date"),!1;""==t&&(t=$("#"+e+" #leadFromSearchModuleId").val()),""==o&&(o=$("#"+e+" #clickFromSearch").val()),""==l&&(l=$("#"+e+" #currentPageSearch").val()),$("#leadAdvanceSearch").modal("hide"),customLoader(!0),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","advance-lead-search-content"),data:JSON.stringify(getCallRequestForAdvanceLeadSearchStudent(e,t,a,o,l,n,s,r,d,"Y")),dataType:"html",global:!1,success:function(c){if(customLoader(!1),""!=c){var u;return"FAILED"==(u=c.split("|"))[0]||"EXCEPTION"==u[0]||"SESSIONOUT"==u[0]?"SESSIONOUT"==u[0]?redirectLoginPage():(s?showMessageTheme2(1,data.message,"",!1):showMessage(!0,u[1]),$("#leadAdvanceSearch").modal("show")):(s?($("#leadAdvanceSearch").modal("hide"),$("#leadSourceList").html(c)):($("#advLeadSerch").modal("hide"),$("#leadSourceList").html(c)),$("#leadDataList .checkLead").prop("checked",!1),callTotalCountLeads(e,t,a,o,l,n,s,r,d,"Y",i,"")),!1}},error:function(e){checkonlineOfflineStatus()||(console.log(e),customLoader(!1))}})}function getCallRequestForAdvanceLeadSearchStudent(e,t,a,o,l,n,s,r,d,i){$(".leadErrorText").html("");var c={},u={},p=0;null!=$("#leadsFollowCount").val()&&(p=null!=$("#leadsFollowCount").val()?$("#leadsFollowCount").val():"");var h="";null!=$("#leadsShortBy").val()&&(h=$("#leadsShortBy").val());var m="";null!=$("#leadsShortType").val()&&(m=$("#leadsShortType").val());var g={},v={},f={},b={},y={},T={};g.clickBy=r;var w=escapeCharacters($("#"+e+" #leadFullSearch").val());w=null!=w?w.replace("+",""):"",g.leadFullSearch=w,g.showAllLeadsData=null!=$("#"+e+" #restrictedDataShow").val()?$("#"+e+" #restrictedDataShow").val():"",g.leadNo=null!=$("#"+e+" #leadNoSearch").val()?$("#"+e+" #leadNoSearch").val():"",""==d&&(d=$("#"+e+" #leadType").val()),g.leadType=d,g.leadSources=null!=$("#"+e+" #leadSourceSearch").val()?$("#"+e+" #leadSourceSearch").val():"",g.assignTos=null!=$("#"+e+" #leadAssignToSearch").val()?$("#"+e+" #leadAssignToSearch").val():"",g.leadStatuses=$("#"+e+" #leadStatusSearch").val(),g.leadAdderId=$("#"+e+" #leadCreatedBy").val(),$("#"+e+" #checkByLead").is(":checked")?v.onlyLead="Y":v.onlyLead="N",$("#"+e+" #checkByLeadDemo").is(":checked")?v.onlyLeadDemo="Y":v.onlyLeadDemo="N",$("#"+e+" #checkLeadStatus").is(":checked")?v.withLeadStatus="Y":v.withLeadStatus="N",f.stdFname=$("#"+e+" #leadstdfnameSearch").val(),f.gurdianFname=$("#"+e+" #leadParentfnameSearch").val(),f.country=$("#"+e+" #countryId option:selected").val(),f.state=$("#"+e+" #stateId option:selected").val(),f.city=$("#"+e+" #cityId option:selected").val(),f.standard=$("#"+e+" #leadGradeSearch option:selected").val(),f.email=$("#"+e+" #leademailIdSearch").val(),f.phoneNo=$("#"+e+" #phoneNoSearch").val(),y.interestedFor=$("#"+e+" #interestedForSearch").val(),y.callStatus=$("#"+e+" #callStatusSearch").val(),y.followupBy=$("#"+e+" #followMedSearch option:selected").val(),y.toCall=$("#"+e+" #callWithSearch").val(),y.leadTagging=$("#"+e+" #leadTagSearch").val(),v.acadmicYear=null!=$("#"+e+" #leadAcadmicYear").val()?$("#"+e+" #leadAcadmicYear").val():"",v.priority=null!=$("#"+e+" #leadPrioritySearch").val()?$("#"+e+" #leadPrioritySearch").val():"",v.utmSource=null!=$("#"+e+" #utmSourceSearch").val()?$("#"+e+" #utmSourceSearch").val():"",v.utmCampaigns=null!=$("#"+e+" #leadSearchCampaign").val()?$("#"+e+" #leadSearchCampaign").val():[],v.leadTemplate=null!=$("#"+e+" #leadSearchTemplate").val()?$("#"+e+" #leadSearchTemplate").val():[],v.deliveredStatus=null!=$("#"+e+" #leadSearchDeliveredStatus").val()?$("#"+e+" #leadSearchDeliveredStatus").val():"",b.demoAssignTo=null!=$("#"+e+" #leadDemoAssignSearch option:selected").val()?$("#"+e+" #leadDemoAssignSearch option:selected").val():"",g.leadStartDate=null!=$("#"+e+" #leadStartDateSearch").val()?$("#"+e+" #leadStartDateSearch").val():"",g.leadEndDate=null!=$("#"+e+" #leadEndDateSearch").val()?$("#"+e+" #leadEndDateSearch").val():"",g.searchDateType=null!=$("#"+e+" #searchDateType option:selected").val()?$("#"+e+" #searchDateType option:selected").val():"",null!=h&&""!=h&&(g.shortBy=h),null!=m&&""!=m&&(g.shortType=m),y.leadFollowStatus=null!=$("#"+e+" #leadStatusSearch").val()?$("#"+e+" #leadStatusSearch").val().toString():"",T.totalCallDay=p,g.curentStage=null!=$("#"+e+" #studentStage").val()?$("#"+e+" #studentStage").val():"",g.activeStatus=null!=i&&""!=i?i:"N",null==l&&(l=0),v.newTheme=n,v.moduleId=t,v.schoolUUID=SCHOOL_UUID,g.leadFrom=a,g.clickFrom=o,g.userId=USER_ID,g.schoolId=SCHOOL_ID,c.leadModifyDTO=g,c.leadModifyDetailDTO=v,c.leadStudentDetailDTO=f,c.leadCallFollowupDTO=y,c.leadDemoInfo=b,c.leadCountDetailDTO=T,u.leadCommonDTO=c,u.currentPage=l;var S=10,L=null!=$("#leadsPagging").val()?$("#leadsPagging").val():"10";return""!=L&&null!=L&&(S=L),u.recordsPerPage=S,u}function advanceLeadSearchStudentReset(e,t){$("#"+e+" #leadNoSearch").val("").trigger("change"),$("#"+e+" #leadSourceSearch").val("").trigger("change"),$("#"+e+" #leadStatusSearch").val("").trigger("change"),$("#"+e+" #leadFullSearch").val(""),"B2B"==t||($("#"+e+" #leadAssignToSearch").val("").trigger("change"),$("#"+e+" #leadDemoAssignSearch").val("").trigger("change")),$("#"+e+" #followMedSearch").val("").trigger("change"),$("#"+e+" #leademailIdSearch").val(""),$("#"+e+" #phoneNoSearch").val(""),$("#"+e+" #leadstdfnameSearch").val(""),$("#"+e+" #leadParentfnameSearch").val(""),$("#"+e+" #leadGradeSearch").val(0).trigger("change"),$("#"+e+" #countryId").val(0).trigger("change"),$("#"+e+" #leadPrioritySearch").val("").trigger("change"),$("#"+e+" #callWithSearch").val("").trigger("change"),$("#"+e+" input[name='callBadgeSearch']").prop("checked",!1),$("#"+e+" #searchStatusOfLead").val("").trigger("change"),$("#"+e+" #leadStartDateSearch").val(""),$("#"+e+" #leadEndDateSearch").val(""),$("#"+e+" #leadModifyStartDateSearch").val(""),$("#"+e+" #leadModifyEndDateSearch").val(""),$("#"+e+" #leadCallStartDateSearch").val(""),$("#"+e+" #leadCallEndDateSearch").val(""),$("#"+e+" #utmSourceSearch").val("").trigger("change"),$("#"+e+" #clsrmBkedDateSearch").val(""),$("#"+e+" #clsrmBkedLastDateSearch").val(""),$("#"+e+" #leadSearchTemplate").val("").trigger("change"),$("#"+e+" #leadSearchDeliveredStatus").val("ALL").trigger("change"),$("#"+e+" #leadSearchCampaign").val("").trigger("change")}function moveLeadsData(e,t,a,o,l,n,s){l?hideMessageTheme2(""):hideMessage("");var r=$("#moveLeadNewForm #leadDemoAssignMove").val();if(null==r||0==r||""==r)return showMessageTheme2(0,"Please choose counselor","",!1),!1;var d=$("#moveLeadNewForm #moveRemarks").val();if(null==d||""==d)return showMessageTheme2(0,"Please fill Remarks","",!1),!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-move"),data:JSON.stringify(getRequestForMoveLeadsData(e)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.statusCode||"2"==e.statusCode?l?showMessageTheme2(0,e.message,"",!0):showMessage(!0,e.message):l?(showMessageTheme2(1,e.message,"",!1),$("#leadNoMove").val(""),$("#moveLeads").modal("hide"),"new-leadmove"==a?(callTotalCountLeads("advanceLeadNewSearchForm",""+s.moduleId,"advance-search",""+n.clickFrom,"0","new",!0,"",""+n.leadType,"Y","0","new-lead"),getLeadDataList("advanceLeadNewSearchForm","advance-search","list",o,"new",!0,"",n,s)):setTimeout((function(){location.reload()}),1e3)):(showMessage(!0,e.message),$("#moveLeads").modal("hide"),setTimeout((function(){callForDashboardData("formIdIfAny","lead-list?moduleId="+t+"&leadFrom="+a+"&clickFrom=list&currentPage="+o)}),1500)),!1},error:function(e){return!1}})}function getRequestForMoveLeadsData(e){var t,a={},o={},l={},n={},s={},r=$("#leadNoMove").val(),d=$("#discardPermission").val(),i="";return null!=$("#leadWithRemark").val()&&$("#leadWithRemark").is(":checked")&&(i=$("#leadWithRemark").val()),t="withDemo"==$('input:radio[name="leadDemoAssignTo"]:checked').val()?"Y":"withoutDemo"==$('input:radio[name="leadDemoAssignTo"]:checked').val()?"Z":"OnlyDemo"==$('input:radio[name="leadDemoAssignTo"]:checked').val()?"O":"N","B2B"==$("#leadIntrestedTo").val()&&(t="Y"),n.leadNo=r.substring(1,r.lenght),n.assignTo=$("#leadDemoAssignMove").val(),n.authDiscardPermission=d,s.demoStatus=t,n.intrestFor=$("#leadIntrestedTo").val(),n.moveRemarks=escapeCharacters($("#moveLeadNewForm #moveRemarks").val()),n.leadWithRemark=i,l.leadModifyDTO=n,l.leadDemoInfo=s,l.leadModifyDetailDTO={},l.leadCallFollowupDTO={},l.leadStudentDetailDTO={},l.leadCountDetailDTO={},o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=e,o.userType="COMMON",a.authentication=o,a.leadCommonDTO=l,a}function verifyCallFn(e,t){var a=$("#teamMemberRemark"+t).val(),o=$("#superRemarkBy"+t).val();if(""==$("#teamMemberRemark"+t).val())return $(".errorLeadCls").fadeIn(),setTimeout((function(){$(".errorLeadCls").fadeOut()}),5e3),$("#errorMessageLead").html("Please fill team member feedback."),!1;feedbackLeadsData(e,t,a,o,"${userId}")}function getCounselorReportData(e){$.ajax({type:"POST",url:getURLForHTML("dashboard","counselor-lead-search-content"),data:"assignTo="+e,dataType:"html",cache:!1,timeout:6e5,success:function(e){if(""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?"SESSIONOUT"==t[0]?redirectLoginPage():showMessage(!0,t[1]):($("#counselorRptcontent").html(e),$("#counselorReport").modal("show")),!1}}})}function getScheduleCall(e){customLoader(!1),$.ajax({type:"POST",url:getURLForHTML("dashboard","counselor-lead-schedule"),data:"assignTo="+e,dataType:"html",cache:!1,timeout:6e5,async:!1,success:function(e){if(""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?"SESSIONOUT"==t[0]?redirectLoginPage():showMessage(!0,t[1]):($("#scheduleMessageContent").html(e),$(".custom-overlay, .fixed-message-card").show()),!1}}})}function dashboardRequestDemo(e){var t="",a="",o="";dateFrom=$("#formdate").val(),dateto=$("#todate").val(),t=""!=dateFrom&&null!=dateFrom?dateFrom.split("-")[2]+"-"+dateFrom.split("-")[0]+"-"+dateFrom.split("-")[1]:"",a=""!=dateto&&null!=dateto?dateto.split("-")[2]+"-"+dateto.split("-")[0]+"-"+dateto.split("-")[1]:"",o=e?"counselor-leads-by-filter?todayDate="+t+"&toDate="+a+"&standard="+$("#standardDashboard").val():"get-request-demo-user";var l={};l.todayDate=t,l.toDate=a,l.userId=USER_ID,$.ajax({global:!1,type:"POST",contentType:"application/json",url:getURLForHTML("dashboard",o),data:JSON.stringify(l),dataType:"html",cache:!1,timeout:6e5,success:function(t){if(""!=t){var a;return"FAILED"==(a=t.split("|"))[0]||"EXCEPTION"==a[0]||"SESSIONOUT"==a[0]?"SESSIONOUT"==a[0]?redirectLoginPage():showMessage(!0,a[1]):e?$("#counselorLeadReportTable").html(t):$("#dashboardDemoLead").html(t),!1}},error:function(e){checkonlineOfflineStatus()||showMessage(!0,e.responseText)}})}function saveLeadAssignToCounselor(e,t,a,o,l){customLoader(!0),l?hideMessageTheme2(""):hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","save-assign-lead-tocounselor"),data:JSON.stringify(getRequestForLeadAssignToCounselor(e,t,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?l?showMessageTheme2(0,e.message,"",!0):showMessage(!0,e.message):l?(showMessageTheme2(1,e.message,"",!0),setTimeout((function(){location.reload()}),1500)):showMessage(!0,e.message),customLoader(!1),!1},error:function(e){return customLoader(!1),!1}})}function getRequestForLeadAssignToCounselor(e,t,a,o){var l={},n={},s={},r=[];if("dashboard"==a){var d={};d.assignTo=e;var i=$("#"+t+" #assignActiveCouns").val();null==i||(d.counselorActive=i);var c=$("#"+t+" #hoursFrom").val()+":"+$("#"+t+" #minsFrom").val(),u=$("#"+t+" #hoursTo").val()+":"+$("#"+t+" #minsTo").val();"undefined:undefined"!=c&&(d.availableStartTime=c+":00",d.availableEndTime=u+":00");var p=$("#"+t+" #hoursFrom2").val()+":"+$("#"+t+" #minsFrom2").val(),h=$("#"+t+" #hoursTo2").val()+":"+$("#"+t+" #minsTo2").val();"undefined:undefined"!=p&&(d.availableStartTime2=p+":00",d.availableEndTime2=h+":00"),d.assignUserType=o,r.push(d)}else $("#"+t+" tr.assignItem").each((function(){var e={},t=[],a=$(this).find("td .assignto").val();e.assignUserType=o,e.assignTo=$(this).find("td .assignto").val(),e.orderBy=$(this).find("td .rowindex").val(),e.totalAssignLead=$(this).find("td .totalAssignLead").val(),e.totalAssignDemo=$(this).find("td .totalAssignDemo").val();var l=$(this).find("td .leadCountry").select2("val");null!=l&&(e.leadCountry=l.toString());var n=$(this).find("td .leadCampain").select2("val");null!=n&&(e.leadCampain=n.toString()),e.onlyCountryChk=0,$(this).find("td .onlyCountryChk").is(":checked")&&null!=l&&l.length>0&&(e.onlyCountryChk=1),e.onlyCampainChk=0,$(this).find("td .onlyCampainChk").is(":checked")&&null!=n&&n.length>0&&(e.onlyCampainChk=1);var s=$(this).find("td .assignActiveCouns").val();null==s||(e.counselorActive=s),"Y"==s&&$(".leave_dates"+a+" li").each((function(){if("LEAVE"!=$(this).find("p").attr("data-leave-type")){var e=$(this).find("p").text();""!=e&&t.push(e)}})),t.length>0&&(e.counselorLeaveDate=t),r.push(e)}));return s.leadLastCallList=r,n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userId=e,n.userType="COMMON",l.authentication=n,l.leadCommonDTO=s,l}function saveInactiveAssignCounselor(e,t,a,o,l){l?hideMessageTheme2(""):hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","inactive-assign-counselor"),data:JSON.stringify(getRequestForInactiveAssignCounselor(e,t,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?l?showMessageTheme2(0,e.message,"",!0):showMessage(!0,e.message):(l?showMessageTheme2(1,e.message,"",!0):showMessage(!0,e.message),setTimeout((function(){location.reload()}),1500)),!1},error:function(e){return!1}})}function getRequestForInactiveAssignCounselor(e,t,a,o){var l={},n={},s={},r={},d={},i={};return r.orderBy=a,r.counselorActivate=t,i.assignTo=e,d.assignUserType=o,s.leadDemoInfo=r,s.leadModifyDTO=i,s.leadCallFollowupDTO=d,n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userId=e,n.userType="COMMON",l.authentication=n,l.leadCommonDTO=s,l}function leadsDataLogDelete(e,t){hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","leadlog-delete"),data:JSON.stringify(getRequestForDeleteLeadsLogData(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?showMessageTheme2(0,e.message,"",!0):(showMessageTheme2(1,e.message,"",!1),setTimeout((function(){location.reload()}),1500)),!1},error:function(e){return!1}})}function getRequestForDeleteLeadsLogData(e,t){var a={},o={},l={};return l.id=e,o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=t,o.userType="COMMON",a.authentication=o,a.leadCommonDTO=l,a}function callStudentSignupStage(e,t){hideMessageTheme2(""),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","student-enroll-stage"),data:JSON.stringify(getRequestForStudentSignupStage(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else{var t="";for(i=0;i<e.signupStudentList.length;i++){var a=e.signupStudentList[i],o="primary";"Completed"==a.profileStatus?o="success":"Partial Entry"==a.profileStatus&&(o="warning"),t=(t=(t=(t=(t=(t=(t+="<tr>")+' <td class="text-center text-muted" style="width: 80px;">'+i+"</td>")+' <td class="text-center" style="width: 80px;"><img width="40" class="rounded-circle" src="'+a.photo+'"></td> ')+' <td class="text-left">'+a.firstName+"<br/>"+a.communicationEmail+"<br/>"+a.contactNumber+"</td> ")+' <td class="text-left">'+a.countryName+"/ <br/>"+a.countryTimezone+"</td> ")+' <td class="text-center"><div class="badge badge-pill badge-'+o+'">'+a.profileStatus+"</div></td> ")+' <td class="text-center">'+a.profileDate+"</td> ",t+=' <td class="text-center" style="width: 200px;"></td> ',t+=' <td class="text-center"> ',t+=' <div role="group" class="btn-group-sm btn-group"> ',t+=' <button class="btn-shadow btn btn-primary">View</button></div></td> ',t+=" </tr> "}$("#todyEnrollStatusTbody").html(t)}},error:function(e){console.log(e)}})}function getRequestForStudentSignupStage(e,t){return request={},authentication={},authentication.hash=getHash(),authentication.schoolId=SCHOOL_ID,authentication.schoolUUID=SCHOOL_UUID,authentication.userId=t,request.authentication=authentication,request}function callDemoCountDetails(e,t,a){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-demo-count-report"),data:JSON.stringify(getRequestForDemoCountDetails(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else if(null!=e.demoCountList)for(i=0;i<e.demoCountList.length;i++){var t=e.demoCountList[i];$("#totalDemoCounselor").html(t.totalDemo),$("#todayDemoCounselor").html(t.todayDemo),$("#totalAcceptedCounselor").html(t.accepted),$("#totalCompleteCounselor").html(t.demoYes),$("#todayCompleteCounselor").html(t.todayDemoYes),$("#totalInCompleteCounselor").html(t.demoNo),$("#todayInCompleteCounselor").html(t.todayDemoNo),$("#totalRescheduleCounselor").html(t.totalReschedule),$("#totalInvalidCounselor").html(t.totalInvalid),$("#demoConversionCounselor").html(t.demoConversion)}},error:function(e){console.log(e)}})}function getRequestForDemoCountDetails(e,t){return request={},authentication={},authentication.hash=getHash(),authentication.schoolId=SCHOOL_ID,authentication.schoolUUID=SCHOOL_UUID,authentication.userId=t,request.authentication=authentication,request}function callLeadCountDetails(e,t){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-lead-count-report"),data:JSON.stringify(getRequestForLeadCountDetails(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else if(null!=e.leadCountList)for(i=0;i<e.leadCountList.length;i++){var t=e.leadCountList[i];$("#totalLeadCounselor").html(t.totalLead),$("#todayLeadCounselor").html(t.todayLead),$("#positiveLeadCounselor").html(t.positiveLead),$("#todayPositiveLeadCounselor").html(t.todayPositiveLead),$("#scrapLeadCounselor").html(t.scrap),$("#leadConversionCounselor").html(t.leadConversion),$("#totalEnrollCounselor").html(t.converted),$("#todayEnrollCounselor").html(t.todayConverted),$("#totalBookedCounselor").html(t.reserved),$("#todayBookedCounselor").html(t.todayReserved),$("#totalCliCounselor").html(t.totalCli),$("#todayCliCounselor").html(t.todayCli),$("#conversionCounselor").html(t.conversionRate)}},error:function(e){console.log(e)}})}function getRequestForLeadCountDetails(e,t){return request={},authentication={},authentication.hash=getHash(),authentication.schoolId=SCHOOL_ID,authentication.schoolUUID=SCHOOL_UUID,authentication.userId=t,request.authentication=authentication,request}function callLeadsByLeadId(e,t,a,o,l,n,s){"true"==s||"addLeadClone"==o||"add"==o?($(".b2cLeadsource").show(),$(".b2bLeadsource").show(),$(".b2bLeadstatus").show(),$(".b2cLeadstatus").show()):($(".b2cLeadsource").hide(),$(".b2bLeadsource").hide(),$(".b2bLeadstatus").hide(),$(".b2cLeadstatus").hide());var r=n.includes("-"),d=n;r&&(d=n.split("-")[0],n=n.split("-")[1],callLeadStatusList(e,n,"leadStatus",!1)),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("/api/v1/leads","get-lead-data-byid"),data:JSON.stringify(getRequestForLeadsByLeadId(e,t,a,d,o)),dataType:"json",cache:!1,timeout:6e5,success:function(r){if("0"==r.status||"2"==r.status)showMessage(!0,r.message);else if($("#"+l).modal({backdrop:"static",keyboard:!1}),"add"==o?$("#leadFormText").text("Add new lead"):"addLeadClone"==o?$("#leadFormText").text("Add clone lead"):"edit"==o&&$("#leadFormText").text("Update lead"),callLeadStatusList(""+e,n,"leadStatus",!1),callLeadSourceList(""+e,n,"leadSource",!0),callPCountries(""+e,0,"countryId"),getTggingMasterList(""+e,"leadTagging"),$("#"+e+" #leadTagging").select2({theme:"bootstrap4",dropdownParent:"#"+e}),null!=r.leadDashboardCommon){if(null!=r.leadDashboardCommon.leadCommonDTO){var d=r.leadDashboardCommon.leadCommonDTO[0];"addLeadClone"==o?($("#"+e+" #parentleadId").val(d.leadModifyDTO.leadId),$("#"+e+" #academicId").val(d.leadModifyDTO.academicId)):($("#"+e+" #leadId").val(d.leadModifyDTO.leadId),$("#"+e+" #academicId").val(d.leadModifyDTO.academicId),$("#"+e+" #leadNo").val(d.leadModifyDTO.leadNo),$("#"+e+" #leadNoText").html(d.leadModifyDTO.leadNo),$("#"+e+" #rawLeadId").val(d.leadDemoInfo.rawLeadId),$("#"+e+" #relationType").val(d.leadStudentDetailDTO.relationType)),setTimeout((function(){$("#"+e+" #leadSource").val(d.leadModifyDTO.leadSource).trigger("change")}),1e3),$("#"+e+" #leadGrade").val(d.leadStudentDetailDTO.standard),$("#"+e+" #leadDOB").val(d.leadStudentDetailDTO.stdDob),$("#"+e+" #leadGender").val(d.leadStudentDetailDTO.gender),$("#"+e+" #leademailId").val(d.leadStudentDetailDTO.email),$("#"+e+" #phoneNo").val(d.leadStudentDetailDTO.phoneNo),$("#"+e+" #leadTagging").val(d.leadCallFollowupDTO.leadTagging).trigger("change"),$("#"+e+" #leademailAlternet").val(d.leadStudentDetailDTO.emailAlternet),null==d.leadStudentDetailDTO.isdCountryCode||""==d.leadStudentDetailDTO.isdCountryCode?($("#"+e+" #pCountryCode").val("us"),$("#"+e+" #isdCode").val("1")):($("#"+e+" #pCountryCode").val(d.leadStudentDetailDTO.isdCountryCode),$("#"+e+" #isdCode").val(d.leadStudentDetailDTO.isdCode)),null==d.leadStudentDetailDTO.isdCountryCodeAlter||""==d.leadStudentDetailDTO.isdCountryCodeAlter?($("#"+e+" #pCountryCodeAlter").val("us"),$("#"+e+" #isdCodeAlter").val("1")):($("#"+e+" #pCountryCodeAlter").val(d.leadStudentDetailDTO.isdCountryCodeAlter),$("#"+e+" #isdCodeAlter").val(d.leadStudentDetailDTO.isdCodeAlter)),itiPhoneNumber&&"function"==typeof itiPhoneNumber.destroy&&itiPhoneNumber.destroy();var i=document.querySelector("#"+e+" #phoneNo");(itiPhoneNumber=window.intlTelInput(i,{})).setCountry($("#"+e+" #pCountryCode").val()),i.addEventListener("countrychange",(function(t){$("#"+e+" #pCountryCode").val(itiPhoneNumber.getSelectedCountryData().iso2),$("#"+e+" #isdCode").val(itiPhoneNumber.getSelectedCountryData().dialCode)})),itiAltPhoneNumber&&"function"==typeof itiAltPhoneNumber.destroy&&itiAltPhoneNumber.destroy();var c=document.querySelector("#"+e+" #phoneNoAlter");itiAltPhoneNumber=window.intlTelInput(c,{}),c.addEventListener("countrychange",(function(t){$("#"+e+" #pCountryCodeAlter").val(itiAltPhoneNumber.getSelectedCountryData().iso2),$("#"+e+" #isdCodeAlter").val(itiAltPhoneNumber.getSelectedCountryData().dialCode)})),null==d.leadStudentDetailDTO.isdCountryCodeAlter&&""==d.leadStudentDetailDTO.isdCountryCodeAlter||itiAltPhoneNumber.setCountry($("#"+e+" #pCountryCodeAlter").val()),$("#"+e+" #countryId").val(d.leadStudentDetailDTO.country).trigger("change"),$("#"+e+" #phoneNoAlter").val(d.leadStudentDetailDTO.phoneNoAlter),$("#"+e+" #leadstdfname").val(d.leadStudentDetailDTO.stdFname),$("#"+e+" #leadstdmname").val(d.leadStudentDetailDTO.stdMname),$("#"+e+" #leadstdlname").val(d.leadStudentDetailDTO.stdLname),$("#"+e+" #leadGender").val(d.leadStudentDetailDTO.gender),$("#"+e+" #leadGuardfname").val(d.leadStudentDetailDTO.gurdianFname),$("#"+e+" #leadGuardmname").val(d.leadStudentDetailDTO.gurdianMname),$("#"+e+" #leadGuardlname").val(d.leadStudentDetailDTO.gurdianLname),$("#"+e+" #leadPin").val(d.leadStudentDetailDTO.pincode),$("#"+e+" #leadAdd").val(d.leadStudentDetailDTO.address),$("#"+e+" #leadSupportTo").val(d.leadStudentDetailDTO.relationType),$("#"+e+" #countrolType").val(o)}$("#"+e+" #countryId").on("change",(function(){callStates(""+e,this.value,"countryId")})),$("#"+e+" #stateId").on("change",(function(){callCities(""+e,this.value,"stateId")})),callLeadAssignUserList(""+e,n,"leadAssignTo",!0,s,USER_ID),setTimeout((function(){$("#"+e+" #leadAssignTo").val(r.leadDashboardCommon.leadCommonDTO[0].leadModifyDTO.assignTo).trigger("change"),$("#"+e+" #leadStatus").val(d.leadModifyDTO.leadStatus).trigger("change")}),1e3),setTimeout((function(){callStates(e,d.leadStudentDetailDTO.country,"countryId"),$("#"+e+" #stateId").val(d.leadStudentDetailDTO.state).trigger("change")}),1e3),setTimeout((function(){callCities(e,d.leadStudentDetailDTO.state,"stateId"),$("#"+e+" #cityId").val(d.leadStudentDetailDTO.city).trigger("change")}),1e3),$("#"+e+" #leadSource").select2({theme:"bootstrap4",dropdownParent:"#"+e}),$("#"+e+" #leadStatus").select2({theme:"bootstrap4",dropdownParent:"#"+e}),$("#"+e+" #leadAssignTo").select2({theme:"bootstrap4",dropdownParent:"#"+e}),$("#"+e+" #countryId").select2({theme:"bootstrap4",dropdownParent:"#"+e}),$("#"+e+" #stateId").select2({theme:"bootstrap4",dropdownParent:"#"+e}),$("#"+e+" #cityId").select2({theme:"bootstrap4",dropdownParent:"#"+e}),$("#"+e+" #leadGrade").select2({theme:"bootstrap4",dropdownParent:"#"+e}),renderDocumentContent(a,t,"LEAD-DOC"),showAddMoreBtnArray=[],$.each($('.upload-docs-wrapper[style*="display: none"]'),(function(){showAddMoreBtnArray.push(parseInt($(this).attr("index")))}))}},error:function(e){console.log(e)}})}function getRequestForLeadsByLeadId(e,t,a,o,l){var n={},s={},r={},d={isUserWise:!1,isLeadSearch:!0};return d.leadId=t,d.clickFrom="ByIdSearch",d.schoolId=SCHOOL_ID,d.leadType=o,d.controlType=l,r.leadModifyDTO=d,s.hash=getHash(),s.schoolId=SCHOOL_ID,s.schoolUUID=SCHOOL_UUID,s.userId=USER_ID,s.userType="COMMON",n.authentication=s,n.leadCommonDTO=r,n}function callLeadCountGradeWiseDetails(e,t){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-lead-count-gradewise-report"),data:JSON.stringify(getRequestForLeadCountGradeWiseDetails(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else{if(null!=e.leadCountGradewise){var t="";for(t+=" <thead><tr><th>#</th> ",i=0;i<e.leadCountGradewise.assignGrade.length;i++){t=t+" <th><b>"+(a=e.leadCountGradewise.assignGrade[i]).standardName+"</b></th> "}for(t+=" </tr> </thead> ",t+=" <tbody><tr><td><b>Total Lead</b></td> ",i=0;i<e.leadCountGradewise.assignGrade.length;i++){t=t+' <td><a href="javascript:void(0);" onclick="callLeadUrl(\'gradewisetotal-'+(a=e.leadCountGradewise.assignGrade[i]).standardId+'\');" class="full not-underline">'+a.leadCount+"</a></td> "}for(t+=" </tr><tr><td><b>Converted Lead</b></td> ",i=0;i<e.leadCountGradewise.assignGrade.length;i++){var a;t=t+' <td><a href="javascript:void(0);" onclick="callLeadUrl(\'cnvertgrdewisetotal-'+(a=e.leadCountGradewise.assignGrade[i]).standardId+'\');" class="full not-underline">'+a.tutionCount+"</a></td> "}t+=" </tr> </tbody> "}$("#dashboardGradeAssign").html(t)}},error:function(e){console.log(e)}})}function getRequestForLeadCountGradeWiseDetails(e,t){return request={},authentication={},authentication.hash=getHash(),authentication.schoolId=SCHOOL_ID,authentication.schoolUUID=SCHOOL_UUID,authentication.userId=t,request.authentication=authentication,request}function callGetOpenFollowup(e,t,a,o,l,n,s,r){$("#"+e+" #epdetailStatus").val(r),$("#"+e+" #leadId").val(t),$("#"+e+" #currentPage").val(l),$("#"+n).modal({backdrop:"static",keyboard:!1}),$(".tentative_date").css("display","none"),$("#"+e+" .meetingSlotsDate").css("display","none"),$("#"+e+" #bookMeeetingDate").val(""),$("#"+n+" #freeSlotList").html(""),$(".errorLeadCls").css("display","none"),$(".followCall").css({display:"none"}),$("#errorMessageLead").html(""),$("#Hot").prop("checked",!1),$("#Cold").prop("checked",!1),$("#Wram").prop("checked",!1),$(".leadTypeCategory").removeClass("active"),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("/api/v1/leads","get-lead-data-byid"),data:JSON.stringify(getRequestForGetOpenFollowup(e,t,a,s,r)),dataType:"json",cache:!1,timeout:6e5,success:function(t){if("0"==t.status||"2"==t.status)showMessage(!0,t.message);else{if(null!=t.leadDashboardCommon.leadCommonDTO){var a=t.leadDashboardCommon.leadCommonDTO[0];if("B2B"==s){a.leadStudentDetailDTO.stdFname,a.leadStudentDetailDTO.stdMname,a.leadStudentDetailDTO.stdLname;$("#"+e+" #callWith").val(a.leadStudentDetailDTO.stdFname),$("#notSureHours").val(a.leadCallFollowupDTO.callscheduleHourse),$("#notSureMins").val(a.leadCallFollowupDTO.callscheduleMin),$("#notSureAMPM").val(a.leadCallFollowupDTO.callAMPM)}else $("#"+e+" #followMed").val(a.leadCallFollowupDTO.followupBy),$("#"+e+" #callWith").val(a.leadCallFollowupDTO.toCall).trigger("change"),"Hot"==a.leadModifyDetailDTO.leadCategory?$("#Hot").trigger("click"):"Cold"==a.leadModifyDetailDTO.leadCategory?$("#Cold").trigger("click"):"Warm"==a.leadModifyDetailDTO.leadCategory&&$("#Warm").trigger("click");if(callLeadStatusList(""+e,""+s,"leadStatus",!1),$("#"+e+" #leadStatus").select2({theme:"bootstrap4",dropdownParent:"#"+e}),null!=t.leadDashboardCommon.leadCommonDTO[0].leadLastCallList){var o=t.leadDashboardCommon.leadCommonDTO[0].leadLastCallList,l="",n=1;for(i=0;i<o.length;i++)l=(l=(l=(l=(l=(l+="<tr>")+" <td>"+n+"</td>")+" <td>"+o[i].followupBy+" | "+o[i].callscheduleDateString+"</td>")+" <td>"+o[i].nextCallscheduleDateString+"</td>")+" <td>"+o[i].toCall+" | "+o[i].leadFollowStatus+"</td>")+" <td>"+o[i].followRemarks+"</td>",l+="</tr>",n+=1;$("#followupHistory").html(l)}}$("#"+e+" #notSureCallscheduleDate").datepicker({container:"#"+e,autoclose:!0,format:"mm-dd-yyyy"}),$("#"+e+" .nextCustomDate").css({display:"none"}),$("#"+e+" #nextDate").on("change",(function(){"CUSTOM"==$("#"+e+" #nextDate").val()?$("#"+e+" .nextCustomDate").css({display:"block"}):($("#"+e+" #notSureCallscheduleDate").val(""),$("#"+e+" .nextCustomDate").css({display:"none"})),""!=$("#"+e+" #nextDate").val()&&"NO FOLLOWUP"!=$("#"+e+" #nextDate").val()?$("#"+e+" .followCall").css({display:"block"}):$("#"+e+" .followCall").css({display:"none"})}))}},error:function(e){console.log(e)}})}function getRequestForGetOpenFollowup(e,t,a,o){var l={},n={},s={},r={isUserWise:!1,isLeadSearch:!0};return r.leadId=t,r.clickFrom="ByIdSearch",r.schoolId=SCHOOL_ID,r.leadType=o,s.leadModifyDTO=r,n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userId=USER_ID,n.userType="COMMON",l.authentication=n,l.leadCommonDTO=s,l}function openPopupAssignToCounselor(e,t,a,o,l,n){l?hideMessageTheme2(""):hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","popup-opento-counselor"),data:JSON.stringify(getRequestForOpenPopupAssignToCounselor(e,t,a,o,l,n)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?o>0&&(l?showMessageTheme2(0,e.message,"",!0):showMessage(!0,e.message)):o>0&&(l?showMessageTheme2(1,e.message,"",!0):showMessage(!0,e.message)),!1},error:function(e){return!1}})}function getRequestForOpenPopupAssignToCounselor(e,t,a,o,l,n){var s={},r={},d={},i={},c={};return i.assignTo=t,i.leadId=e,i.leadType=n,c.counselorActivate=o,d.leadModifyDTO=i,d.leadModifyDetailDTO={},d.leadDemoInfo=c,d.leadStudentDetailDTO={},d.leadCallFollowupDTO={},d.leadCountDetailDTO={},r.hash=getHash(),r.schoolId=SCHOOL_ID,r.schoolUUID=SCHOOL_UUID,r.userId=a,r.userType="COMMON",s.authentication=r,s.leadCommonDTO=d,s}function callLeadDemoCountDetails(e,t,a){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-lead-demo-count"),data:JSON.stringify(getRequestForLeadDemoCountDetails(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else if(null!=e.leadDemoCountList)for(i=0;i<e.leadDemoCountList.length;i++){var t=e.leadDemoCountList[i];$("#totalEnrollCounselor").html(t.converted),$("#demoConversionCounselor").html(t.conversionRate),$("#totalCompleteCounselor").html(t.demoYes),$("#totalRescheduleCounselor").html(t.totalReschedule),$("#totalInCompleteCounselor").html(t.demoNo),$("#totalBookedCounselor").html(t.reserved),$("#totalCliCounselor").html(t.cli),$("#totalInvalidCounselor").html(t.scrap),$("#totalFollowup").html(t.noOfCall)}},error:function(e){console.log(e)}})}function getRequestForLeadDemoCountDetails(e,t){return leadModifyDTO={},leadCommonDTO={},leadModifyDTO.schoolId=SCHOOL_ID,leadModifyDTO.userId=t,leadModifyDTO.leadStartDate=$("#demoStartDate").val(),leadModifyDTO.leadEndDate=$("#demoEndDate").val(),leadCommonDTO.leadModifyDTO=leadModifyDTO,leadCommonDTO}function getPingPopupScheduleCall(e){customLoader(!1),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","counselor-ping-lead-schedule"),data:JSON.stringify({assignTo:e}),dataType:"html",cache:!1,timeout:6e5,async:!1,success:function(e){if("\n\n"==e&&(e=e.replace("\n\n","")),""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?"SESSIONOUT"==t[0]?redirectLoginPage():showMessage(!0,t[1]):($("#schedulePingMessageContent").html(e),$(".custom-overlay, .fixed-message-card").show()),!1}}})}function callforLeadCalculate(e,t,a){return""==$("#"+e+" #targetLead").val()?(showMessageTheme2(1,"Please fill target","",!0),!1):""==$("#"+e+" #startDate").val()?(showMessageTheme2(1,"Please choose start date","",!0),!1):""==$("#"+e+" #endDate").val()?(showMessageTheme2(1,"Please choose end date","",!0),!1):void $.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","calculate-tolead"),data:JSON.stringify(getRequestForLeadCalculate(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else{var t=getLeadCalculatorHtml(e);$("#leadCalculateTbody").html(t),$("#dataMode").html($("#activeDataMode").val()),$("html, body").animate({scrollTop:$("#leadTargetCalculate").offset().top},800)}},error:function(e){console.log(e)}})}function getRequestForLeadCalculate(e){return leadCalcInputRequestDTO={},leadCalcInputRequestDTO.schoolId=SCHOOL_ID,leadCalcInputRequestDTO.totalTarget=$("#"+e+" #targetLead").val(),leadCalcInputRequestDTO.convertPercent=$("#"+e+" #conversionRate").val(),leadCalcInputRequestDTO.startDate=$("#"+e+" #startDate").val(),leadCalcInputRequestDTO.endDate=$("#"+e+" #endDate").val(),leadCalcInputRequestDTO.leadAttendSpentTime=$("#"+e+" #lspentTime").val(),leadCalcInputRequestDTO.dataType="WEEK",leadCalcInputRequestDTO.workingHrs=24,leadCalcInputRequestDTO}function getLeadCalculatorHtml(e){var t="";if("SUCCESS"==e.status){var a=e.leadCalculateDTO,o=a.leadCalculateWeeklyList;$("#enroll_target").html(" | "+a.targetTotalConvert),$("#no_of_days").html(" ("+a.totalduration+")"),$("#convert_rate").html(" ("+a.convertPercent+"%)"),$("#cal_total_leads").html(" | "+a.targetTotalRecieveLead),t+="<tr> ",t+='<td class="p-0 border-0"> ',t+='<table class="table table-bordered table-striped"> ',t+="<thead><tr><th>CURRENT</th><th>REQUIRED</th></tr></thead> ",t+="<tbody> ",t=(t=(t+="<tr> ")+"<td>"+a.currentTotalConvert+"</td> ")+"<td>"+a.remainTotalConvert+"</td> ",t+="</tr> ",t+="</tbody> ",t+="</table> ",t+="</td> ",t+='<td class="p-0 border-0"> ',t+='<table class="table table-bordered table-striped"> ',t+="<thead><tr><th>COMPLETED</th><th>REMAINING</th></tr></thead> ",t+="<tbody> ",t=(t=(t+="<tr> ")+"<td>"+a.currentTotalduration+"</td> ")+"<td>"+a.remainTotalduration+"</td> ",t+="</tr> ",t+="</tbody> ",t+="</table> ",t+="</td> ",t+='<td class="p-0 border-0"> ',t+='<table class="table table-bordered table-striped"> ',t+="<thead><tr><th>CURRENT</th><th>REQUIRED</th></tr></thead> ",t+="<tbody> ",t=(t=(t+="<tr> ")+"<td>"+a.currentConvertPercent+"%</td> ")+"<td>"+a.remainConvertPercent+"%</td> ",t+="</tr> ",t+="</tbody> ",t+="</table> ",t+="</td> ",t+='<td class="p-0 border-0"> ',t+='<table class="table table-bordered table-striped"> ',t+="<thead><tr><th>CURRENT</th><th>REQUIRED</th></tr></thead> ",t+="<tbody> ",t=(t=(t+="<tr> ")+"<td>"+a.currentTotalRecieveLead+"</td> ")+"<td>"+a.remainTotalRecieveLead+"</td> ",t+="</tr> ",t+="</tbody> ",t+="</table> ",t+="</td> ",t+="</tr> ",t+="<tr> ",t+='<td class="p-0 border-0"> ',t+='<table class="table table-bordered table-striped">',t+="<thead> ",t+='<th class="p-2 bg-danger text-white text">Projected</th> ',t+="</thead> ",t+="<tbody> ",t=(t+="<tr> ")+"<td>"+a.projectedEnrollment+"</td> ",t+="</tr> ",t+="</tbody> ",t+="</table> ",t+="</td> ",t+='<td colspan="6" class="border-0">&nbsp;</td> ',t+="</tr> ",t+="<tr> ",t+='<td colspan="8" class="border-0 p-0"> ',t+='<table class="table" style="font-size:11px"> ',t+="<tr> ",t+='<th class="border-0"></th> ',t+='<th class="bg-light border-dark border-0">LEAD PER DAY</th> ',t+='<th class="bg-light border-dark border-0">LEAD PER WEEK</th> ',t+='<th class="bg-light border-dark border-0">LEAD PER MONTH</th> ',t+='<th class="bg-light border-dark border-0">LEAD PER YEAR</th> ',t+="</tr> ",t+="<tr> ",t+='<th class="text-left border-dark">TARGET</th> ';for(var l=0;l<o.length;l++){t=t+'<td class="bg-light border-dark">'+(n=o[l]).targetReqRecievedLeadPerDay+"</td> "}t+="</tr> ",t+="<tr> ",t+='<td colspan="8" class="p-0 border-0" style="max-height:5px;overflow: hidden;font-size:3px">&nbsp;</td> ',t+="</tr> ",t+="<tr> ",t+='<th class="text-left border-dark">CURRENT</th> ';for(l=0;l<o.length;l++){t=t+'<td class="bg-light border-dark">'+(n=o[l]).curr_lead+"</td> "}t+="</tr> ",t+="<tr> ",t+='<td colspan="8" class="p-0 border-0" style="max-height:5px;overflow: hidden;font-size:3px">&nbsp;</td> ',t+="</tr> ",t+="<tr> ",t+='<th class="text-left  border-dark">REQUIRED</th> ';for(l=0;l<o.length;l++){t+='<td class="p-0 border-0"> ',t+='<table class="table table-bordered table-striped m-0"> ',t+="<thead><tr><th>CURRENT</th><th>REQUIRED</th></tr></thead> ",t+="<tbody> ",t=(t=(t+="<tr> ")+"<td>"+(n=o[l]).req_lead_by_enroll+"</td> ")+"<td>"+n.req_lead+"</td> ",t+="</tr> ",t+="</tbody> ",t+="</table> ",t+="</td> "}t+="</tr> ",t+="</table> ",t+="</td> ",t+="</tr> ",t+="<tr> ",t+='<td colspan="8" class="border-0 p-0"> ',t+='<table class="table" style="font-size:11px"> ',t+="<tr> ",t+='<th class="border-0"></th> ',t+='<th class="bg-light border-dark border-0">ENROLLED PER DAY</th> ',t+='<th class="bg-light border-dark border-0">ENROLLED PER WEEK</th> ',t+='<th class="bg-light border-dark border-0">ENROLLED PER MONTH</th> ',t+='<th class="bg-light border-dark border-0">ENROLLED PER YEAR</th> ',t+="</tr> ",t+="<tr> ",t+='<th class="text-left border-dark">TARGET</th> ';for(l=0;l<o.length;l++){t=t+'<td class="bg-light border-dark">'+(n=o[l]).targetConvertLeadPerDay+"</td> "}t+="</tr> ",t+="<tr> ",t+='<td colspan="8" class="p-0 border-0" style="max-height:5px;overflow: hidden;font-size:3px">&nbsp;</td> ',t+="</tr> ",t+="<tr> ",t+='<th class="text-left border-dark">CURRENT</th> ';for(l=0;l<o.length;l++){t=t+'<td class="bg-light border-dark">'+(n=o[l]).curr_enroll+"</td> "}t+="</tr> ",t+="<tr> ",t+='<td colspan="8" class="p-0 border-0" style="max-height:5px;overflow: hidden;font-size:3px">&nbsp;</td> ',t+="</tr> ",t+="<tr> ",t+='<th class="text-left  border-dark">REQUIRED</th> ';for(l=0;l<o.length;l++){var n;t=t+'<td class="bg-light border-dark">'+(n=o[l]).req_enroll+"</td> "}t+="</tr> ",t+="</table> ",t+="</td> ",t+="</tr> "}return t}function callLeadtimecountry(e,t,a){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","times-countries"),data:JSON.stringify(getRequestForLeadtimecountry(e,t,a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else{var t=getLeadTimeCountryHtml(e);$("#timescountry").html(t)}},error:function(e){console.log(e)}})}function callLeadAndEnrollmentWithCountry(e,t,a){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-enrolled-list-with-country"),data:JSON.stringify(getRequestForLeadtimecountry(e,t,a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else{var t=getLeadTopCountryHtml(e);$("#topcompany").html(t)}},error:function(e){console.log(e)}})}function getRequestForLeadtimecountry(e,t,a){var o={},l={};return l.schoolId=SCHOOL_ID,l.modeSearch=e,l.startDate=t,l.endDate=a,o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",l.authentication=o,l}function getLeadTimeCountryHtml(e){var t=e.leadTimeWiseList,a="";if(t.length>0)for(let e=0;e<t.length;e++){const o=t[e];a+="<tr><td>"+o.timeDuration+" ("+o.totalLead+")</td><td>"+(""==o.countryName?"N/A":o.countryName)+"</td></tr>"}return a}function getLeadTopCountryHtml(e){var t=0,a=0,o=0,l=0,n=e.dataList,s="";if(null!=n&&null!=n&&Object.entries(n).length>0){n=Object.fromEntries(Object.entries(n).sort(((e,t)=>t[1].leadCount-e[1].leadCount)));var r=0,d=0;for(const e in n){const c=n[e];var i=parseInt(c.groupStudentCount)+parseInt(c.otherStudentCount);s+="<tr><td>"+(r+=1)+"</td><td>"+(""==c.countryName?"N/A":c.countryName)+'</td><td class="text-center">'+c.leadCount+'</td><td class="text-center">'+c.totalStudentCount+'</td><td class="text-center">'+c.freshStudentCount+'</td><td class="text-center">'+i+"</td></tr>",t+=parseInt(c.leadCount),a+=parseInt(c.totalStudentCount),o+=parseInt(c.freshStudentCount),l+=parseInt(i),""==c.countryName&&(d+=1)}$("#totalStudentCount").text(a),$("#freshStudentCount").text(o),$("#newEnrollmentCount").text(l),$(".totalCountry").text(r-d),$(".totalTopCountry").text(t);var c=s.slice(0,-2);s=c}return s}function callLeadTotalStatuscountry(e,t,a,o){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","total-lead-countries"),data:JSON.stringify(getRequestForLeadTotalcountry(e,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else getTotalLeadsChart(e.leadTotalLeadCount,t)},error:function(e){console.log(e)}})}function getRequestForLeadTotalcountry(e,t,a){var o={},l={};return l.schoolId=SCHOOL_ID,l.modeSearch=e,l.startDate=t,l.endDate=a,o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",l.authentication=o,l}function getTotalLeadsChart(e,t){var a=[],o=[],l={};if(e.length>0){var n=[],s=[],r=[],d=[],i=[],c=[];for(let t=0;t<e.length;t++){const a=e[t];o.push(a.countryName)}for(let t=0;t<e.length;t++){const a=e[t];n.push(a.totalLead),s.push(a.enrolledLead),r.push(a.demoLead),d.push(a.scrapLead),i.push(a.positiveLead),c.push(a.demoDone)}l.name="Total Leads",l.data=n,a.push(l),(l={}).name="Enrolled",l.data=s,a.push(l),(l={}).name="Demo",l.data=r,a.push(l),(l={}).name="Demo Done",l.data=c,a.push(l),(l={}).name="Scrap",l.data=d,a.push(l),(l={}).name="Positive Enrolled",l.data=i,a.push(l);var u={series:a,chart:{type:"bar",height:600,stacked:!0},plotOptions:{bar:{horizontal:!0,dataLabels:{total:{enabled:!0,offsetX:0,style:{fontSize:"13px",fontWeight:900}}}}},colors:["#008ffb","#1fc747","#fdb300","#2b908f","#e90909","#9D00FF"],stroke:{width:1,colors:["#fff"]},title:{text:""},xaxis:{categories:o,labels:{formatter:function(e){return e+""}}},yaxis:{title:{text:void 0}},tooltip:{y:{formatter:function(e){return e+""}}},fill:{opacity:1},legend:{position:"top",horizontalAlign:"center",offsetX:40}},p=new ApexCharts(document.querySelector("#"+t),u);p.render(),p.update()}}function callDaywiseLead(e,t,a,o){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","daywise-lead"),data:JSON.stringify(getRequestForDayWiseLead(e,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else getDaywiseLeadsChart(e.leadDaywiseWise,t)},error:function(e){console.log(e)}})}function getRequestForDayWiseLead(e,t,a){var o={},l={};return l.schoolId=SCHOOL_ID,l.modeSearch=e,l.startDate=t,l.endDate=a,o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",l.authentication=o,l}function getDaywiseLeadsChart(e,t){var a=[],o=[],l=[];if(e.length>0){for(let t=0;t<e.length;t++){const n=e[t];a.push(n.dayName),o.push(n.dayLead),l.push(parseFloat(n.leadPercent))}var n={series:o,chart:{width:"85%",type:"pie"},labels:a,theme:{monochrome:{enabled:!0}},plotOptions:{pie:{dataLabels:{offset:-5}}},title:{text:""},dataLabels:{formatter:(e,t)=>[t.w.globals.labels[t.seriesIndex],e.toFixed(1)+"%"]},legend:{show:!1}},s=new ApexCharts(document.querySelector("#"+t),n);s.render(),s.update()}}function callCampainWise(e,t,a,o,l){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","campain-lead"),data:JSON.stringify(getRequestForCampainWise(e,t,o,l)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else if("campain"==t)getCampainWiseChart(e.leadDaywiseWise,a);else getLeadSourceWiseChart(e.leadDaywiseWise,a)},error:function(e){console.log(e)}})}function getRequestForCampainWise(e,t,a,o){var l={},n={};return n.schoolId=SCHOOL_ID,n.modeSearch=e,n.searchType=t,n.startDate=a,n.endDate=o,l.hash=getHash(),l.schoolId=SCHOOL_ID,l.schoolUUID=SCHOOL_UUID,l.userId=USER_ID,l.userType="COMMON",n.authentication=l,n}function getCampainWiseChart(e,t){var a=[],o=[],l=[],n={};if(e.length>0){o=[];var s=[],r=[],d=[],i=[],c=[];for(let t=0;t<e.length;t++){const o=e[t];a.push(o.dayName)}for(let t=0;t<e.length;t++){const a=e[t];o.push(a.totalLead),s.push(a.enrolledLead),r.push(a.demoLead),d.push(a.scrapLead),i.push(a.positiveLead),c.push(a.demoDone)}n.name="Total Leads",n.data=o,l.push(n),(n={}).name="Enrolled",n.data=s,l.push(n),(n={}).name="Demo",n.data=r,l.push(n),(n={}).name="Demo Done",n.data=c,l.push(n),(n={}).name="Scrap",n.data=d,l.push(n),(n={}).name="Positive Enrolled",n.data=i,l.push(n);var u={series:l,chart:{type:"bar",height:600,stacked:!0},plotOptions:{bar:{horizontal:!0,dataLabels:{total:{enabled:!0,offsetX:0,style:{fontSize:"13px",fontWeight:900}}}}},colors:["#008ffb","#1fc747","#fdb300","#2b908f","#e90909","#9D00FF"],stroke:{width:1,colors:["#fff"]},title:{text:""},xaxis:{categories:a,labels:{formatter:function(e){return e+""}}},yaxis:{title:{text:void 0}},tooltip:{y:{formatter:function(e){return e+""}}},fill:{opacity:1},legend:{position:"top",horizontalAlign:"center",offsetX:40}},p=new ApexCharts(document.querySelector("#"+t),u);p.render(),p.update()}}function getLeadSourceWiseChart(e,t){var a=[],o=[];if(e.length>0){for(let t=0;t<e.length;t++){const l=e[t];a.push(l.dayName),o.push(l.totalLead)}var l={series:[{name:"",data:o}],chart:{type:"bar",height:350},plotOptions:{bar:{borderRadius:0,horizontal:!0,distributed:!0,barHeight:"80%",isFunnel:!0}},dataLabels:{enabled:!0,formatter:function(e,t){return e},dropShadow:{enabled:!0}},title:{text:"Pyramid Chart",align:"middle"},xaxis:{categories:a},legend:{show:!1}},n=new ApexCharts(document.querySelector("#"+t),l);n.render(),n.update()}}function callLeadEnrolled(e,t,a,o){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","enrolled-lead-list"),data:JSON.stringify(getRequestForLeadEnrolled(e,t,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if($("#leadReportSearch").modal("hide"),"0"==e.status||"2"==e.status)showMessage(!0,e.message);else{$("#enrolled-student").dataTable().fnDestroy();var t=getLeadEnrolledHtml(e);$("#enrollLeads").html(t),$("#enrolled-student").dataTable()}},error:function(e){console.log(e)}})}function getRequestForLeadEnrolled(e,t,a,o){var l={},n={};return n.schoolId=SCHOOL_ID,n.modeSearch=t,n.startDate=a,n.endDate=o,""!=e&&(n.sessionYear=$("#"+e+" #acadmicYear").val(),null!=$("#"+e+" #assignToSearch").val()&&null!=$("#"+e+" #assignToSearch").val()&&(n.assignTo=$("#"+e+" #assignToSearch").val().toString()),n.gradeId=$("#"+e+" #gradeSearch").val(),n.countryId=$("#"+e+" #countryId").val(),n.utmCampaign=$("#"+e+" #searchCampaign").val(),n.enrollType=$("#"+e+" #enrollmentSearch").val()),l.hash=getHash(),l.schoolId=SCHOOL_ID,l.schoolUUID=SCHOOL_UUID,l.userId=USER_ID,l.userType="COMMON",n.authentication=l,n}function getLeadEnrolledHtml(e){var t=e.studentEnrolledList,a="",o=1;if(null!=t&&null!=t&&t.length>0)for(let e=0;e<t.length;e++){const s=t[e];var l="N/A";"ONE_TO_ONE"==s.registrationType?l="1:1":"BATCH"==s.registrationType?l="Group Learning":"ONE_TO_ONE_FLEX"==s.registrationType?l="1:1 Flex":"SCHOLARSHIP"==s.registrationType&&(l="Accelerated Learning");var n=s.enrollType;"REGISTRATION_FRESH"==s.enrollType||"REGISTRATION_FLEX_COURSE"==s.enrollType?n="Fresh":"REGISTRATION_NEXT_GRADE"!=s.enrollType&&"REGISTRATION_REPEAT_GRADE"!=s.enrollType||(n="Re-Enroll"),"LEAD_AND_DEMO"==USER_ROLE?"REGISTRATION_FRESH"==s.enrollType&&(a+="<tr>",a+="<td>"+o+++"</td>",a+="<td>"+s.name+"<br/>"+s.standardName+"<br/></td>",a+="<td>"+hideEmail(s.email)+"<br/>"+s.countryName+"</td>",a+="<td>"+s.parentName+"</td>",a+="<td>"+n+"<br/>"+l+"</td>",a+="<td>"+s.profileDate+"</td>",a+="<td>"+(""==s.assignName?"N/A":s.assignName)+"</td>",a+="<td>"+(""==s.orientDate?"N/A":s.orientDate)+"</td>",a+="<td>"+(""==s.orientStatus?"N/A":s.orientStatus)+"</td>",a+="</tr>"):(a+="<tr>",a+="<td>"+o+++"</td>",a+="<td>"+s.name+"<br/>"+s.standardName+"<br/></td>",a+="<td>"+hideEmail(s.email)+"<br/>"+s.countryName+"</td>",a+="<td>"+s.parentName+"</td>",a+="<td>"+n+"<br/>"+l+"</td>",a+="<td>"+s.profileDate+"</td>",a+="<td>"+(""==s.assignName?"N/A":s.assignName)+"</td>",a+="<td>"+(""==s.orientDate?"N/A":s.orientDate)+"</td>",a+="<td>"+(""==s.orientStatus?"N/A":s.orientStatus)+"</td>",a+="</tr>")}return a}function callCampainWiseExpenses(e,t,a,o){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("fb","insights"),data:JSON.stringify(getRequestForCampainWiseExpenses(e,t,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else if("campain"==t){var a=getLeadExpensesListHtml(e.leadExpensesList);$("#leadExpense").html(a),$("#campExpList").dataTable()}},error:function(e){console.log(e)}})}function getRequestForCampainWiseExpenses(e,t,a,o){var l={};return l.schoolId=SCHOOL_ID,l.daytype=e,l.accountId="act_2040679362947027",l.startDate=a,l.endDate=o,l}function getLeadExpensesListHtml(e){var t=e,a="";if(t.length>0)for(let e=0;e<t.length;e++){const o=t[e];a+="<tr><td>1</td>",a+="<td>"+o.campaignName+"</td>",a+="<td>"+o.impressions+" | "+o.reach+"</td>",a+="<td>"+o.totalFBLeads+" | "+o.totalSMSLeads+"</td>",a+="<td>"+o.totalSpend+" | "+o.leadPerCost+"</td>",a+="<td>"+o.convertLeads+"</td>",a+="<td>"+o.positiveLeads+"</td>",a+="<td>"+o.bookSeatLeads+"</td>",a+="</tr>"}return a}function callB2BDashboardLead(e,t){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","b2b-dashboard-lead"),data:JSON.stringify(getRequestForB2bDashboard(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else{var t=e.leadCountDetailDTO;""!=t.totalLeads&&$("#totalB2bLead").text(t.totalLeads),""!=t.totalConverted&&$("#convertB2bLead").text(t.totalConverted),""!=t.unattendedLead&&$("#unattendedB2bLead").text(t.unattendedLead),""!=t.followupLead1&&$("#positiveB2bLead").text(t.followupLead1)}},error:function(e){console.log(e)}})}function getRequestForB2bDashboard(e,t){var a={},o={},l={};return o.schoolId=SCHOOL_ID,o.userId=USER_ID,o.moduleId=e,o.leadFrom="LEAD",o.clickFrom="list",o.currentPage=0,o.leadType=t,l.country=0,a.leadModifyDTO=o,a.leadModifyDetailDTO={},a.leadStudentDetailDTO=l,a.leadDemoInfo={},a.leadCallFollowupDTO={},a.leadCountDetailDTO={},a}function showBasicDetailsMailWarning(e){$("#warningSendBadicDetailsModel").remove();var t='<div class="modal fade" id="warningSendBadicDetailsModel"><div class="modal-dialog modal-md modal-notify modal-danger" role="document" style="max-width:500px;"><div class="modal-content"><div class="modal-body text-center"><h5 class="modal-title py-4" id="exampleModalLabel">Are you sure you want to send basic details mail?</h5><div style="full text-center"><button type="button" class="btn btn-primary mr-2" id="discardSendBasicDetailsWarningYes" onclick="sendBasicDetailsMail('+e+');">Yes</button><button type="button" class="btn btn-danger waves-effect text-right" data-dismiss="modal">No</button></div></div></div></div></div>';$("body").append(t),$("#warningSendBadicDetailsModel").modal("show")}function sendBasicDetailsMail(e){var t={};t.b2bleadId=e,$.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/send-b2b-basic-details",data:JSON.stringify(t),dataType:"json",global:!1,success:function(e){$("#warningSendBadicDetailsModel").modal("hide"),"0"==e.status||"2"==e.status||"3"==e.status?"3"==e.status?redirectLoginPage():showMessageTheme2(0,e.message,"",!0):showMessageTheme2(1,e.message,"",!0)},error:function(e){checkonlineOfflineStatus()||console.log(e)}})}function showResendB2BWelcomeMailWarning(e){$("#warningResendWelcomeMailModel").remove();var t='<div class="modal fade" id="warningResendWelcomeMailModel"><div class="modal-dialog modal-md modal-notify modal-danger" role="document" style="max-width:500px"><div class="modal-content"><div class="modal-body text-center"><h5 class="modal-title py-4" id="exampleModalLabel">Are you sure you want to resend login details mail?</h5><div style="full text-center"><button type="button" class="btn btn-primary mr-2" id="discardSendBasicDetailsWarningYes" onclick="resendB2BWelcomeMail('+e+');">Yes</button><button type="button" class="btn btn-danger waves-effect text-right" data-dismiss="modal">No</button></div></div></div></div></div>';$("body").append(t),$("#warningResendWelcomeMailModel").modal("show")}function resendB2BWelcomeMail(e){var t={};t.b2bleadId=e,$.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/resend-b2b-welcome-mail",data:JSON.stringify(t),dataType:"json",global:!1,success:function(e){$("#warningResendWelcomeMailModel").modal("hide"),"0"==e.status||"2"==e.status||"3"==e.status?"3"==e.status?redirectLoginPage():showMessageTheme2(0,e.message,"",!0):showMessageTheme2(1,e.message,"",!0)},error:function(e){checkonlineOfflineStatus()||console.log(e)}})}function callLeadStatusList(e,t,a,o){hideMessageTheme2(""),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"LEAD-STATUS-LIST",t)),dataType:"json",cache:!1,timeout:6e5,success:function(t){"0"==t.status||"2"==t.status?showMessageTheme2(!0,t.message):(result=t.mastersData.data,dropdown=$("#"+e+" #"+a),dropdown.html(""),dropdown.append('<option value="0">Select Status</option>'),$.each(result,(function(e,t){o?dropdown.append('<option value="'+t.key+'">'+t.value+"</option>"):dropdown.append('<option value="'+t.value+'">'+t.value+"</option>")})))},error:function(e){console.log(e)}})}function saveCampaignLead(e,t,a){if(hideMessageTheme2(""),""==$("#"+t).val())return showMessageTheme2(0,"Please select campaign","",!0),!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-campainname-update"),data:JSON.stringify(getRequestForCampaignLead(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(o){return"0"==o.statusCode||"2"==o.statusCode?showMessageTheme2(0,o.message,"",!0):(showMessageTheme2(1,o.message,"",!1),"new-leadcampaign"==a?$(".utmCampaign-"+e).text($("#"+t+" option:selected").attr("data-campain")):window.location.reload()),!1},error:function(e){return!1}})}function getRequestForCampaignLead(e,t){var a={},o={},l={},n={},s={};return n.leadId=e,s.utmCampaign=$("#"+t).val(),s.utmlTemplate=$("#"+t).val(),l.leadModifyDTO=n,l.leadDemoInfo={},l.leadModifyDetailDTO=s,l.leadCallFollowupDTO={},l.leadStudentDetailDTO={},l.leadCountDetailDTO={},o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",a.authentication=o,a.leadCommonDTO=l,a}function callLeadMergeData(e,t,a,o,l,n,s){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("/api/v1/leads","get-lead-marge"),data:JSON.stringify(getRequestForMergeLeadIds(e,t,a,n)),dataType:"json",cache:!1,timeout:6e5,success:function(a){if("0"==a.status||"2"==a.status)showMessage(!0,a.message);else{var r=a.leadStatusResponse;if("0"==r.statusCode)showMessageTheme2(0,r.message,"",!0);else if(0==s&&$("#"+l).modal("show"),null!=a.leadDashboardCommon&&null!=a.leadDashboardCommon.leadCommonDTO){var d=a.leadDashboardCommon.leadCommonDTO[0];"addLeadClone"==o?($("#"+e+" #parentleadId").val(d.leadModifyDTO.leadId),$("#"+e+" #academicId").val(d.leadModifyDTO.academicId)):($("#"+e+" #leadId").val(d.leadModifyDTO.leadId),$("#"+e+" #academicId").val(d.leadModifyDTO.academicId),$("#"+e+" #leadNo").val(d.leadModifyDTO.leadNo),$("#"+e+" #leadNoText").html(d.leadModifyDTO.leadNo),$("#"+e+" #rawLeadId").val(d.leadDemoInfo.rawLeadId),$("#"+e+" #relationType").val(d.leadStudentDetailDTO.relationType)),$("#"+e+" #leadSource").val(d.leadModifyDTO.leadSource),$("#"+e+" #leadGrade").val(d.leadStudentDetailDTO.standard),$("#"+e+" #leadDOB").val(d.leadStudentDetailDTO.stdDob),$("#"+e+" #leadGender").val(d.leadStudentDetailDTO.gender),$("#"+e+" #leademailId").val(d.leadStudentDetailDTO.email),$("#"+e+" #phoneNo").val(d.leadStudentDetailDTO.phoneNo),$("#"+e+" #leademailAlternet").val(d.leadStudentDetailDTO.emailAlternet),null==d.leadStudentDetailDTO.isdCountryCode||""==d.leadStudentDetailDTO.isdCountryCode?($("#"+e+" #pCountryCode").val("us"),$("#"+e+" #isdCode").val("1")):($("#"+e+" #pCountryCode").val(d.leadStudentDetailDTO.isdCountryCode),$("#"+e+" #isdCode").val(d.leadStudentDetailDTO.isdCode)),null==d.leadStudentDetailDTO.isdCountryCodeAlter||""==d.leadStudentDetailDTO.isdCountryCodeAlter?($("#"+e+" #pCountryCodeAlter").val("us"),$("#"+e+" #isdCodeAlter").val("1")):($("#"+e+" #pCountryCodeAlter").val(d.leadStudentDetailDTO.isdCountryCodeAlter),$("#"+e+" #isdCodeAlter").val(d.leadStudentDetailDTO.isdCodeAlter)),itiPhoneNumber&&"function"==typeof itiPhoneNumber.destroy&&itiPhoneNumber.destroy();var i=document.querySelector("#"+e+" #phoneNo");(itiPhoneNumber=window.intlTelInput(i,{})).setCountry($("#"+e+" #pCountryCode").val()),i.addEventListener("countrychange",(function(t){$("#"+e+" #pCountryCode").val(itiPhoneNumber.getSelectedCountryData().iso2),$("#"+e+" #isdCode").val(itiPhoneNumber.getSelectedCountryData().dialCode)})),itiAltPhoneNumber&&"function"==typeof itiAltPhoneNumber.destroy&&itiAltPhoneNumber.destroy();var c=document.querySelector("#"+e+" #phoneNoAlter");itiAltPhoneNumber=window.intlTelInput(c,{}),c.addEventListener("countrychange",(function(t){$("#"+e+" #pCountryCodeAlter").val(itiAltPhoneNumber.getSelectedCountryData().iso2),$("#"+e+" #isdCodeAlter").val(itiAltPhoneNumber.getSelectedCountryData().dialCode)})),null==d.leadStudentDetailDTO.isdCountryCodeAlter&&""==d.leadStudentDetailDTO.isdCountryCodeAlter||itiAltPhoneNumber.setCountry($("#"+e+" #pCountryCodeAlter").val()),$("#"+e+" #phoneNoAlter").val(d.leadStudentDetailDTO.phoneNoAlter),$("#"+e+" #leadstdfname").val(d.leadStudentDetailDTO.stdFname),$("#"+e+" #leadstdmname").val(d.leadStudentDetailDTO.stdMname),$("#"+e+" #leadstdlname").val(d.leadStudentDetailDTO.stdLname),$("#"+e+" #leadGender").val(d.leadStudentDetailDTO.gender),$("#"+e+" #leadGuardfname").val(d.leadStudentDetailDTO.gurdianFname),$("#"+e+" #leadGuardmname").val(d.leadStudentDetailDTO.gurdianMname),$("#"+e+" #leadGuardlname").val(d.leadStudentDetailDTO.gurdianLname),$("#"+e+" #countryId").val(d.leadStudentDetailDTO.country).trigger("change"),setTimeout((function(){callStates(e,d.leadStudentDetailDTO.country,"countryId"),$("#"+e+" #stateId").val(d.leadStudentDetailDTO.state)}),1e3),setTimeout((function(){callCities(e,d.leadStudentDetailDTO.state,"stateId"),$("#"+e+" #cityId").val(d.leadStudentDetailDTO.city)}),1e3),$("#"+e+" #leadPin").val(d.leadStudentDetailDTO.pincode),$("#"+e+" #leadAdd").val(d.leadStudentDetailDTO.address),"B2B"==n?$("#"+e+" #leadAssignTo").val(d.leadModifyDTO.assignTo).trigger("change"):($("#"+e+" #leadAssignTo").val(d.leadModifyDTO.assignTo),$("#"+e+" #leadStatus").val(d.leadModifyDTO.leadStatus)),$("#"+e+" #leadSupportTo").val(d.leadStudentDetailDTO.relationType),$("#"+e+" #countrolType").val(o);var u=a.leadDashboardCommon.leadCommonDTO;if(u.length>0){$("#"+e+" #mergeLeads").val(t),$("#mergeleadlist").html("");var p=getLeadMergeDataHtml(u,d.leadModifyDTO.leadId);$("#mergeleadlist").html(p),clickRedioForMergeLead(e,l,n)}}}},error:function(e){console.log(e)}})}function getRequestForMergeLeadIds(e,t,a,o){var l={},n={},s={},r={isUserWise:!1,isLeadSearch:!0};return r.leadId=t,r.clickFrom="ByIdSearch",r.schoolId=SCHOOL_ID,r.leadType=o,r.leadFrom="MERGE",s.leadModifyDTO=r,n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userId=a,n.userType="COMMON",l.authentication=n,l.leadCommonDTO=s,l}function getLeadMergeDataHtml(e,t){var a="";if(a+='<table class="table table-bordered table-striped" style="font-size:11px;">',a+="<thead><tr><th>Sr. No.</th><th>Lead No<br/>Lead Source</th><th>Lead Status<br/>Lead Assign</th><th>Child Name<br/>Grade<br/>City | Country</th><th>Contact Info</th></tr></thead>",a+="<tbody>",null!=e&&e.length>0){var o=1;for(let l=0;l<e.length;l++){const n=e[l];a=(a=(a+="<tr>")+"<td>"+o)+'<input type="radio" class="checkMergerRadioLead" id="lead-'+n.leadModifyDTO.leadId+'" name="lead-merge-another" value="'+n.leadModifyDTO.leadId+'" '+(t==n.leadModifyDTO.leadId?"checked":"")+" /> ",a=(a=(a=(a=(a=(a+="</td>")+"<td>"+n.leadModifyDTO.leadNo+"<br/>"+n.leadModifyDTO.leadSourceName+"</td>")+"<td>"+n.leadModifyDTO.leadStatus+"<br/>"+n.leadModifyDTO.assignName+"</td>")+"<td>"+n.leadStudentDetailDTO.stdFname+" "+n.leadStudentDetailDTO.stdMname+" "+n.leadStudentDetailDTO.stdLname+"<br/>"+(""!=n.leadStudentDetailDTO.standardName?n.leadStudentDetailDTO.standardName:"N/A"))+"<br/>"+(""!=n.leadStudentDetailDTO.cityName?n.leadStudentDetailDTO.cityName:"N/A")+" | "+n.leadStudentDetailDTO.countryName+"</td>")+"<td>"+n.leadStudentDetailDTO.isdCode+" "+n.leadStudentDetailDTO.phoneNo,""!=n.leadStudentDetailDTO.phoneNoAlter&&(a=a+"<br/>"+n.leadStudentDetailDTO.isdCodeAlter+" "+n.leadStudentDetailDTO.phoneNoAlter),a=a+"<br/>"+n.leadStudentDetailDTO.email+"<br/>"+n.leadStudentDetailDTO.emailAlternet+"</td>",a+="</tr>",o+=1}}return a+="</tbody>",a+="</table>"}function clickRedioForMergeLead(e,t,a){$(".checkMergerRadioLead").on("change",(function(){var o="",l="";$.each($("input[name='lead-merge-another']"),(function(){$(this).is(":checked")?o=o+","+$(this).val():l=l+","+$(this).val()})),leadnew=o+l;var n=leadnew.substring(1,leadnew.lenght);callLeadMergeData(e,n,""+USER_ID,"edit",t,a,1)}))}function saveCampaignMaster(e,t,a){hideMessageTheme2(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","save-campaign-data"),data:JSON.stringify(getRequestForCampaignMaster(e,t,a)),dataType:"json",cache:!1,timeout:6e5,success:function(t){return"0"==t.statusCode||"2"==t.statusCode?showMessageTheme2(0,t.message,"",!0):(showMessageTheme2(1,t.message,"",!1),$("#"+e+" #leadCampaignName").val(""),$("#"+e+" #campaignStartDate").val(""),callCampainList(!1,""),callCampainList(!0,"selectcampain")),!1},error:function(e){return!1}})}function getRequestForCampaignMaster(e,t,a){var o={};return o.campainId=t,o.userId=USER_ID,o.schoolId=SCHOOL_ID,o.campainName=$("#"+e+" #leadCampaignName").val(),o.startDate=$("#"+e+" #campaignStartDate").val(),o.endDate="2999-12-31",o.activeInactive=a,o}function callCampainList(e,t){data={},data.schoolId=SCHOOL_ID,$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("/api/v1/leads","get-campaign-list"),data:JSON.stringify(data),dataType:"json",cache:!1,timeout:6e5,success:function(a){if("0"==a.status||"2"==a.status)showMessage(!0,a.message);else if(e){var o=a.campainNameList;if(o.length>0){$("."+t).html("");var l='<option value=""></option>';l="";for(let e=0;e<o.length;e++){const t=o[e];l=l+'<option value="'+t.campainName+'">'+t.campainName+"</option>"}$("."+t).html(l)}}else{var n=getLeadMergeDataPopup(a.campainNameList);$("#tblCampaignList").dataTable().fnDestroy(),$("#campaignlist").html(n),$("#tblCampaignList").dataTable()}},error:function(e){console.log(e)}})}function getLeadMergeDataPopup(e,t){var a="";if(null!=e&&e.length>0){var o=1;for(let t=0;t<e.length;t++){const n=e[t];a=(a=(a=(a=(a+="<tr>")+"<td>"+o+"</td>")+"<td>"+n.campainName+"</td>")+"<td>"+n.startDate+"</td>")+"<td>"+n.endDate+"</td>",a+="<td>",a+='<label class="switch" >';var l="inactiveCampaignMaster('"+n.campainId+"', '"+n.activeInactive+"')";a=(a=a+'<input class="switch-input assignActiveCouns"  type="checkbox" '+("Y"==n.activeInactive?"checked":"")+'  value="'+n.activeInactive+'" ')+'onclick="'+l+'"  data-size="mini"/>',a+='<span class="switch-label" data-on="Yes" data-off="No"></span> <span class="switch-handle"></span> ',a+="</label>",a+="</td>",a+="</tr>",o+=1}}return a}function inactiveCampaignMaster(e,t){hideMessageTheme2(""),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","inactive-campaign"),data:JSON.stringify(getRequestForInactiveCampaignMaster(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.statusCode||"2"==e.statusCode?showMessageTheme2(0,e.message,"",!0):(showMessageTheme2(1,e.message,"",!1),callCampainList(!1,"")),!1},error:function(e){return!1}})}function getRequestForInactiveCampaignMaster(e,t){var a={};return a.campainId=e,a.userId=USER_ID,a.schoolId=SCHOOL_ID,"Y"==t?t="N":"N"==t&&(t="Y"),a.activeInactive=t,a}function getPartnerLeadById(e,t,a){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("/api/v1/leads","get-lead-data-byid"),data:JSON.stringify(getRequestForPartnerByLeadId(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(t){if("0"==t.status||"2"==t.status)showMessage(!0,t.message);else if($("#"+a).modal("show"),null!=t.leadDashboardCommon&&null!=t.leadDashboardCommon.leadCommonDTO){var o=t.leadDashboardCommon.leadCommonDTO[0];$("#"+e+" #leadId").val(o.leadModifyDTO.leadId),$("#"+e+" #rawLeadId").val(o.leadDemoInfo.rawLeadId),$("#"+e+" #email").val(o.leadStudentDetailDTO.email),$("#"+e+" #fname").val(o.leadStudentDetailDTO.stdFname),$("#"+e+" #mname").val(o.leadStudentDetailDTO.stdMname),$("#"+e+" #lname").val(o.leadStudentDetailDTO.stdLname),$("#"+e+" #phoneNo").val(o.leadStudentDetailDTO.phoneNo),null==o.leadStudentDetailDTO.isdCountryCode||""==o.leadStudentDetailDTO.isdCountryCode?($("#"+e+" #pCountryCode").val("us"),$("#"+e+" #isdCode").val("1")):($("#"+e+" #pCountryCode").val(o.leadStudentDetailDTO.isdCountryCode),$("#"+e+" #isdCode").val(o.leadStudentDetailDTO.isdCode)),itiPhoneNumber&&"function"==typeof itiPhoneNumber.destroy&&itiPhoneNumber.destroy();var l=document.querySelector("#"+e+" #phoneNo");(itiPhoneNumber=window.intlTelInput(l,{})).setCountry($("#"+e+" #pCountryCode").val()),l.addEventListener("countrychange",(function(t){$("#"+e+" #pCountryCode").val(itiPhoneNumber.getSelectedCountryData().iso2),$("#"+e+" #isdCode").val(itiPhoneNumber.getSelectedCountryData().dialCode)})),$("#"+e+" #countryId").val(o.leadStudentDetailDTO.country),setTimeout((function(){callStates(e,o.leadStudentDetailDTO.country,"countryId"),$("#"+e+" #stateId").val(o.leadStudentDetailDTO.state),$("#"+e+" #stateId").attr("disabled","disabled")}),1e3),setTimeout((function(){callCities(e,o.leadStudentDetailDTO.state,"stateId"),$("#"+e+" #cityId").val(o.leadStudentDetailDTO.city),$("#"+e+" #cityId").attr("disabled","disabled"),$("#"+e+" #partnerType").val(o.leadModifyDTO.partnerTypeId),$("#"+e+" #originalTimezone").val(o.leadModifyDTO.originalPartnerTimzone).trigger("change")}),1e3),$("#"+e+" #originalPartnerType").val(o.leadStudentDetailDTO.originalPartnerType),"WLP"==o.leadStudentDetailDTO.originalPartnerType?($("#setDiscount, #setDiscountTab").attr("style",""),$("#setCommissionRate, #setCommissionRateTab").hide()):"GP"==o.leadStudentDetailDTO.originalPartnerType&&($("#setCommissionRate, #setCommissionRateTab").attr("style",""),$("#setDiscount, #setDiscountTab").hide()),$("#"+e+" #commissionPayout").val(o.leadModifyDTO.commissionPayout),$("#"+e+" #whiteLabel").val(o.leadModifyDTO.whiteLabel),$("#"+e+" #enrollingStudent").val(o.leadModifyDTO.enrollingStudent)}},error:function(e){console.log(e)}})}function getRequestForPartnerByLeadId(e,t){var a={},o={},l={},n={isUserWise:!1,isLeadSearch:!0};return n.leadId=t,n.clickFrom="ByIdSearch",n.schoolId=SCHOOL_ID,n.leadType="B2B",n.controlType="edit",n.leadFrom="list",l.leadModifyDTO=n,o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",a.authentication=o,a.leadCommonDTO=l,a}function createPartnerUser(e,t,a,o,l){"Y"!=l?showMessageTheme2(0,"Please update the Enrollment Partner Form before creating the partner dashboard.","",!0):(renderPartnerCotent(o),getPartnerLeadById(e,t,a))}function savePatnerWithReferralCode(e,t){return hideMessageTheme2(""),""==$("#"+e+" #partnerType").val()||null==$("#"+e+" #partnerType").val()?(showMessageTheme2(!1,"Please select Location Partner Type"),!1):""==$("#"+e+" #originalPartnerType").val()||null==$("#"+e+" #originalPartnerType").val()?(showMessageTheme2(!1,"Please select Partner Type"),!1):""==$("#"+e+" #originalTimezone").val()||null==$("#"+e+" #originalTimezone").val()?(showMessageTheme2(!1,"Please select Timezone"),!1):void $.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","save-referralcode-partner"),data:JSON.stringify(getRequestForPartnerWithReferral(e)),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessageTheme2(!1,e.message):("WLP"==$("#originalPartnerType").val()?($("#setCommissionRate, #setCommissionRateTab").hide(),$("#setDiscount, #setDiscountTab").attr("style","")):($("#setCommissionRate, #setCommissionRateTab").attr("style",""),$("#setDiscount, #setDiscountTab").hide()),showMessageTheme2(!0,e.message))},error:function(e){console.log(e)}})}function getRequestForPartnerWithReferral(e){var t={};return t.userId=USER_ID,t.schoolId=SCHOOL_ID,t.leadId=$("#"+e+" #leadId").val(),t.rawLeadId=$("#"+e+" #rawLeadId").val(),t.fname=$("#"+e+" #fname").val(),t.mname=$("#"+e+" #mname").val(),t.lname=$("#"+e+" #lname").val(),""!=$("#"+e+" #fname").val()&&""!=$("#"+e+" #mname").val()&&""!=$("#"+e+" #lname").val()?t.userFullName=$("#"+e+" #fname").val()+" "+$("#"+e+" #mname").val()+" "+$("#"+e+" #lname").val():""!=$("#"+e+" #fname").val()&&""!=$("#"+e+" #lname").val()?t.userFullName=$("#"+e+" #fname").val()+" "+$("#"+e+" #lname").val():t.userFullName=$("#"+e+" #fname").val(),t.email=$("#"+e+" #email").val(),t.partnerType=$("#"+e+" #partnerType").val(),t.countryId=$("#"+e+" #countryId").val(),t.stateId=$("#"+e+" #stateId").val(),t.cityId=$("#"+e+" #cityId").val(),t.originalPartnerType=$("#"+e+" #originalPartnerType").val(),t.originalTimezoneId=$("#"+e+" #originalTimezone option:selected").attr("custom_timezone_id"),t.originalTimezone=$("#"+e+" #originalTimezone").val(),t.commissionPayout=$("#"+e+" #commissionPayout").val(),t.whiteLabel=$("#"+e+" #whiteLabel").val(),t.enrollingStudent=$("#"+e+" #enrollingStudent").val(),t}function callPCountries(e,t,a,o){return $("#"+e+" #"+a).html('<option value="">Select country*</option>'),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"COUNTRIES-LIST",t)),dataType:"json",async:!1,success:function(t){if("0"==t.status||"2"==t.status)showMessage(1,t.message);else{var l=t.mastersData.countries;$.each(l,(function(t,l){$("#"+e+" #"+a).append('<option dailCode="'+l.extra1+'" dail-country-code="'+l.extra+'" value="'+l.key+'" '+(o==l.key?"selected":"")+">"+l.value+"</option>")}))}}}),!0}function getPartnerTypeList(e,t,a,o){$("#"+e+" #"+a).html('<option value="">Select Partner type*</option>'),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"PARTNER-TYPE-LIST",t)),dataType:"json",cache:!1,timeout:6e5,success:function(t){if("0"==t.status||"2"==t.status)showMessageTheme2(!0,t.message);else{var l=t.mastersData.data;$.each(l,(function(t,l){$("#"+e+" #"+a).append('<option dailCode="'+l.extra1+'" dail-country-code="'+l.extra+'" value="'+l.key+'" '+(o==l.key?"selected":"")+">"+l.value+"</option>")}))}},error:function(e){customLoader(!1),showMessageRequestDemoPage(!0,e.responseText,"serverError","")}})}function flushUploadedDocument(){uploadDocs=[]}function getUploadedDocuments(){for(var e=[],t=1;t<=5;t++)if($("#OD"+t+"div").length>0&&"N"!=$("#OD"+t+"div").attr("upload")){var a=new Object({uploaded:$("#OD"+t+"div").attr("uploaded"),filePath:$("#OD"+t+"div").attr("data-PDFURL"),fileName:$("#OD"+t+"div").attr("fileName"),docType:$("#OD"+t+"div").attr("docType"),imgID:"OD"+t+"Icon"});e.push(a)}return e}function disposeLeadupdateForm(){$("#supportHtmlFollowup").html(""),flushUploadedDocument(),$("#leadPopupForm").modal("hide")}function getRequestForLeadsDocuments(e,t,a){var o={};return o.userId=e,o.entityId=t,o.entityType="LEADS",o.documentsFor=a,o}function getLeadDocuments(e,t,a){var o={};return $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/api/v1/leads/lead-documents",data:JSON.stringify(getRequestForLeadsDocuments(e,t,a)),dataType:"json",async:!1,global:!1,success:function(e){o=e},error:function(e){checkonlineOfflineStatus()}}),o}function getRequestForSaveChatLog(e,t,a){var o={entityType:"LEADS"};return o.entityId=t,o.userId=e,o.chatFrom=$("#chatSupport").val(),o.chatDate=$("#chatDate").val(),o.uploadDocuments=getUploadedDocuments(),o}function saveChatLogs(e,t,a,o,l,n){return""==$("#"+l).val()?(showMessageTheme2(0,"Select chat date.","",!0),!1):"Y"!=$("#"+n).attr("uploaded")?(showMessageTheme2(0,"Please upload a document.","",!0),!1):void $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/api/v1/leads/save-chat-log",data:JSON.stringify(getRequestForSaveChatLog(t,a,o)),dataType:"json",async:!1,global:!1,success:function(o){"0"==o.status||"2"==o.status||"3"==o.status?"3"==o.status?redirectLoginPage():showMessageTheme2(0,o.message):($("#isuploaded").val("true"),uploadedChatLogs(e,t,a),resetChatSupportFormElement(),showMessageTheme2(1,o.message))},error:function(e){checkonlineOfflineStatus()}})}function getRequestForChatDetails(e,t,a){var o={};return o.userId=e,o.entityId=t,o.entityType="LEADS",o.documentsFor=a,o}function getLeadChatDetails(e,t,a){var o={};return $.ajax({type:"POST",contentType:"application/json",url:BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/api/v1/leads/lead-chat-details",data:JSON.stringify(getRequestForChatDetails(e,t,a)),dataType:"json",async:!1,global:!1,success:function(e){o=e},error:function(e){checkonlineOfflineStatus()}}),o}function resetLeadUpdate(){$("#leadPopupForm").modal("hide"),$("#supportHtmlFollowup").html(""),$("#documentDiv").html("")}function resetLeadChat(e){if($("#updateChatSupportDocs").modal("hide"),"true"==$("#isuploaded").val()){var t=$("#leadType").val();"new-leads"==e?getLeadDataList("advanceLeadNewSearchForm","advance-search","list","0","new",!0,"",OBJECT_RIGHTS,ROLE_MODULE):advanceLeadSearchStudent("advanceLeadNewSearchForm","","advance-search","","0","new",!0,"",""+t)}}function saveCategoryLead(e,t){if(hideMessageTheme2(""),""==$("#"+t).val())return showMessageTheme2(0,"Please select campaign","",!0),!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-category-update"),data:JSON.stringify(getRequestForLeadCategory(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.statusCode||"2"==e.statusCode?showMessageTheme2(0,e.message,"",!0):showMessageTheme2(1,e.message,"",!1),!1},error:function(e){return!1}})}function getRequestForLeadCategory(e,t){var a={},o={},l={},n={},s={};return n.leadId=e,$("#"+t).is(":checked")&&(s.leadCategory=$("#"+t).val()),l.leadModifyDTO=n,l.leadDemoInfo={},l.leadModifyDetailDTO=s,l.leadCallFollowupDTO={},l.leadStudentDetailDTO={},l.leadCountDetailDTO={},o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",a.authentication=o,a.leadCommonDTO=l,a}function submitFollowupSaveFromLeadList(e,t,a,o,l){if(hideMessageTheme2(""),null==$("#leadStatus-"+t).val()||""==$("#leadStatus-"+t).val())return showMessageTheme2(0,"Please select lead Status","",!0),!1;var n=$("#leadStatus-"+t).val(),s="";if(null==$("#followupRemarks-"+t).val()||""==$("#followupRemarks-"+t).val())return showMessageTheme2(0,"Please fill followup Remarks","",!0),!1;""!=$("#followupRemarks-"+t).val()&&(s=escapeCharacters($("#followupRemarks-"+t).val())),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","save-leads-followup"),data:JSON.stringify(getRequestForFollowupSaveFromLeadList(e,t,n,s,a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)return showMessageTheme2(0,e.message,"",!0),!1;showMessageTheme2(1,e.message,"",!1),$(".nextSchedule-"+t).html("<b>"+e.extra1+"</b>"),$(".nextFollow-"+t).html("<b>NO FOLLOWUP</b>"),$(".leadlist-status-"+t).html("<b>"+$("#leadStatus-"+t+" option:selected").text()+"</b>"),$(".leadlist-remark-"+t).html("<b>"+e.extra3+"</b>");var o=a.toString().toLowerCase();$(".nextSchedule-"+t).addClass(o+"-"+e.extra2+"-leadno-bg"),$(".nextFollow-"+t).addClass(o+"-"+e.extra2+"-leadno-bg"),$(".leadlist-remark-"+t).addClass(o+"-"+e.extra2+"-leadno-bg");var n=$(".lead-row-"+t).attr("class"),s=n.split(" "),r=s[s.length-1],d=n.replace(r,o+"-"+e.extra2+"-bg");$(".lead-row-"+t).attr("class",d);var i=$(".lead-row-td-"+t).attr("class"),c=i.split(" "),u=c[c.length-1],p=i.replace(u,o+"-"+e.extra2+"-leadno-bg");return $(".lead-row-td-"+t).attr("class",p),$("#leadStatus-"+t).val(0),$("#followupRemarks-"+t).val(""),discardPermission=$("#discardPermission").val(),getLeadStatusLog(e.leadno,l,discardPermission),!1},error:function(e){return!1}})}function getRequestForFollowupSaveFromLeadList(e,t,a,o,l){var n={},s={},r={},d={},i={},c={};return d.leadId=t,c.followupBy="Call",i.tentativeDate="",""!=o&&(c.followRemarks=o),c.followupRemarkBy=USER_ID,c.toCall="none",c.leadFollowStatus=a,d.leadStatus=a,c.customDate="NO FOLLOWUP","Call Completed"!=a&&"Not Answering | Not reachable | Switch off"!=a||(c.callBadge="followup1"),"Call Completed | Hot"!=a&&"Call Completed | Warm"!=a&&"Call Completed | Cold"!=a||(c.callBadge="calldoneb2b"),"Positive to enrollment"==a&&(c.callBadge="positive"),"Share details over WhatsApp | e-mail"!=a&&"Phone | WhatsApp Call"!=a&&"Reached out on WhatsApp"!=a&&"Reached out on Phone Call"!=a&&"Reached out on Email"!=a||(c.callBadge="followup2"),"Need time"!=a&&"Other"!=a&&"Class Demo Needed"!=a&&"Class Demo Completed"!=a||(c.callBadge="followup3"),"Duplicate lead"!=a&&"Invalid | Cold"!=a||(c.callBadge="red"),"Rejected | Cold"==a&&(c.callBadge="rejected"),"Demo Needed"!=a&&"Demo Completed"!=a&&"Demo Reschedule"!=a&&"Demo Booked"!=a||(c.callBadge="yellow"),"Connect to Impact Recommended"!=a&&"Connect to Impact Booked"!=a&&"Connect to Impact Completed"!=a||(c.callBadge="cti"),"Booked Seat"==a&&(c.callBadge="darkgreen"),"Neutral"==a&&(c.callBadge="neutral"),"Assigned Working"!=a&&"Basic Details not Filled | Cold"!=a||(c.callBadge="gray"),"Converted"!=a&&"Converted & On Boarding | Hot"!=a||(c.callBadge="green"),"Looking for next year"==a&&(c.callBadge="nextyear"),"Request Under Review | Warm"==a&&(c.callBadge="under-review"),"Interested to Interview | Warm"!=a&&"Interested to Interview | Cold"!=a&&"Interested to Interview | Hot"!=a||(c.callBadge="int-inerview"),"Moving for the Next meeting | Warm"!=a&&"Moving for the Next meeting | Cold"!=a&&"Moving for the Next meeting | Hot"!=a||(c.callBadge="move-inerview"),"Interview Booked | Cold"==a&&(c.callBadge="inter-booked"),"Invalid"==a&&(c.callBadge="red"),r.leadModifyDTO=d,r.leadModifyDetailDTO=i,r.leadCallFollowupDTO=c,r.leadDemoInfo={},s.hash=getHash(),s.schoolId=SCHOOL_ID,s.schoolUUID=SCHOOL_UUID,s.userId=USER_ID,s.userType="COMMON",n.currentPage=$("#"+e+" #currentPage").val(),n.authentication=s,n.leadCommonDTO=r,n}function uploadLeads(e){hideMessageTheme2("");var t=new FormData;if(null!=$("#"+e+" #userId").val()?t.append("userId",$("#"+e+" #userId").val()):t.append("userId",USER_ID),null==$("#"+e+" #fileupload1").get(0).files[0]||""==$("#"+e+" #fileupload1").get(0).files[0])return showMessageTheme2(0,"Please choose csv file","",!0),!1;t.append("uploadLeadCsv",$("#"+e+" #fileupload1").get(0).files[0]),$.ajax({type:"POST",url:getURLFor("leads","upload-leads-data"),data:t,dataType:"json",type:"POST",processData:!1,contentType:!1,enctype:"multipart/form-data",success:function(e){return"0"==e.statusCode||"2"==e.statusCode?showMessageTheme2(0,e.message,"",!1):showMessageTheme2(1,e.message,"",!1),!1},error:function(e){return!1}})}function callTemplateList(e,t,a){data={},data.schoolId=SCHOOL_ID;data.userId=a||USER_ID,$("#leadSearchDeliveredStatus").val("ALL").trigger("change"),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","get-template-list"),data:JSON.stringify(data),dataType:"json",cache:!1,timeout:6e5,success:function(a){if(templatesNameList=[],$.each(a.usersData,(function(e,t){templateData={},templatesNameDataList=[],$.each(t.messageTemplates,(function(e,t){templateNames={},templateNames.userTemplateName=t.elementName,templatesNameDataList.push(templateNames)})),templateData.ID=e,templateData.templateName=templatesNameDataList,templateData.counsellorName=t.userName,templatesNameList.push(templateData)})),$("."+t).html(""),templatesNameList.length>0?($("#leadSearchDeliveredStatus").removeAttr("disabled"),$("#leadSearchDeliveredStatus").prop("disabled",!1)):($("#leadSearchDeliveredStatus").attr("disabled","disabled"),$("#leadSearchDeliveredStatus").prop("disabled",!0)),"0"==a.status||"2"==a.status)showMessage(!0,a.message);else if(e&&templatesNameList.length>0){$("."+t).html("");var o="";for(let e=0;e<templatesNameList.length;e++){const t=templatesNameList[e];for(let e=0;e<t.templateName.length;e++)o=o+'<option value="'+t.templateName[e].userTemplateName+'">'+t.templateName[e].userTemplateName+"("+t.counsellorName+")</option>"}$("."+t).html(o)}},error:function(e){console.log(e)}})}function getWatiLogs(e){var t={},a="advanceLeadNewSearchForm",o=$("#"+a+" #leadSearchDeliveredStatus").val(),l=$("#"+a+" #leadSearchTemplate").val(),n=$("#"+a+" #leadAssignToSearch").val(),s=$("#"+a+" #leadStartDateSearch").val(),r=$("#"+a+" #leadEndDateSearch").val();t.leadID=e,t.leadSearchDeliveredStatus=o,t.leadSearchTemplate=l,t.leadAssignTo=n,t.leadStartDateSearch=s,t.leadEndDateSearch=r,$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","get-wati-log"),data:JSON.stringify(t),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.statusCode||"2"==e.statusCode)showMessageTheme2(0,e.message,"",!0);else{if("Data Not found"==e.message)return showMessageTheme2(0,"Wati Logs not available for this Lead","",!1),!1;var t=$("#logData");t.html(""),$(t).html(whatsappChatUI(e)),$("#watiLogsTableData").DataTable({theme:"bootstrap4"}),$("#watiLogsContent").modal("show")}return!1},error:function(e){return!1}})}function getWatiTemplates(){if($("#allWatiTemplatesList").html(""),$("#allWatiTemplatesList").html(""),$("#mcustomWatiTemplatesListClose").click((function(e){$("input#selectLeadAll").prop("checked",""),$('input[name="lead-move-another"]').prop("checked",""),$("#leadNoMove").val("")})),""==$("#leadNoMove").val())return showMessageTheme2(0,"Please check any one lead","",!1),!1;hideMessageTheme2("");var e=$("#leadNoMove").val(),t=new Array;$('input[name="lead-move-another"]').each((function(){t.push($(this).val())})),e=e.substring(1,e.lenght);var a={};a.userId=USER_ID,a.leads=e,$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","get-wati-templates"),data:JSON.stringify(a),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.statusCode||"2"==e.statusCode||"E001"==e.statusCode||"E002"==e.statusCode?showMessageTheme2(0,e.message,"",!1):(watiTemplateContent=e,$.each(watiTemplateContent.messageTemplates,(function(e,t){null!=t.customParams&&""!=t.customParams&&$.each(t.customParams,(function(e,a){var o="{{"+a.paramName+"}}",l=new RegExp("\\*{{"+a.paramName+"}}\\*","g");if(t.bodyOriginal.includes("*{{"+a.paramName+"}}*"))l=new RegExp("\\*{{"+a.paramName+"}}\\*","g");else l=o;t.body=t.body.replace(l,a.paramValue),t.bodyOriginal=t.bodyOriginal.replace(l,"<b>"+a.paramValue+"</b>")}))})),$("body").html(getWaringContent1()),$("#allWatiTemplatesList").html(""),$("#allWatiTemplatesList").html(customWatiTemplatesList(e)),$.fn.dataTable.isDataTable("#mwatiBroadcastTable")&&$("#mwatiBroadcastTable").dataTable().fnDestroy(),$("#mwatiBroadcastTable").DataTable({theme:"bootstrap4"}),$("#mcustomWatiTemplatesList").modal("show"),$("#usrPopData").html(swatiBroadcastSendMobileModal(e)),$("#mswatiBroadcastSendThroughMobile").modal("hide"));return!1},error:function(e){return!1}})}function sendWatiNotification(e,t){$("#table_row_"+e).addClass("selected_row").siblings().removeClass("selected_row"),$("#templateName").html("<b>"+e+"</b> "),boolval=!0,$("#viewMethodCalling").html('<a href="javascript:void(0)" class="btn btn-primary btn-sm rounded-circle" onclick="viewWatiTemplate('+boolval+","+t+", `"+e+'`);" > <i class="fa fa-eye text-white"></i> </a>'),$("#confirm_btn_data").html('<a id="confirm_btn" class="btn btn-primary mr-2" href="javascript:void(0);" >SEND</a>'),$("#selectionCount").html('<span>Selected- </span><span id="selectedCount">0</span> / <span id="totalCount">0</span>'),$("#mswatiBroadcastSendThroughMobile").modal("show"),$("#mcustomWatiTemplatesList").modal("hide");var a=$(".checkToSend").length;function o(){var e=$(".checkToSend:checked").length;$("#selectedCount").text(e)}$("#totalCount").text(a),$("#confirm_btn").click((function(){console.log("Confirm btn clicked::");var a="",o="";$.each($("input[name='chk-users-lead']:checked"),(function(){o=o+","+$(this).val()}));var l=(a+=o).substring(1,a.length);if(""==l)return $("#remarksresetDelete2").modal("hide"),showMessageTheme2(0,"Please check any one user to send message","",!1),!1;showWarningMessageShow("Are you sure you want to send this data?","sendWatiNotificationToUser( "+t+",'"+e+"','"+l+"','send')","info-modal-sm")})),$(".checkToSend").click((function(){o();$(".checkToSend:checked").length>0&&$(".checkToSend:checked").length==$(".checkToSend").length?$("#allchecked").prop("checked",!0):$("#allchecked").prop("checked",!1)})),$("#allchecked").click((function(){$(this).prop("checked")?$(".checkToSend").prop("checked",!0):$(".checkToSend").prop("checked",!1),o()}))}function sendWatiNotificationToUser(e,t,a,o){$("#successFailedWatiMessagesModal").modal("hide"),$("#resetDeleteErrorWarningNo1").click((function(){$("#remarksresetDelete2").hide()})),$("#resetDeleteErrorWarningYes1").click((function(){$("input#allchecked").prop("checked",!1),$("input#allcheckedFailed").prop("checked",!1),$("input#selectLeadAll").prop("checked",!1),$('input[name="chk-users-lead"]').prop("checked",!1),$('input[name="lead-move-another"]').prop("checked",!1)})),$("#resetDeleteErrorWarningYes2").click((function(){$("input#allchecked").prop("checked",!1),$("input#allcheckedFailed").prop("checked",!1),$("input#selectLeadAll").prop("checked",!1),$('input[name="chk-users-lead"]').prop("checked",!1),$('input[name="lead-move-another"]').prop("checked",!1)})),$("#mcustomWatiTemplatesList").click((function(){$("#selectLeadAll").prop("checked",!1)})),$("#templateName").html("<b>"+t+"</b> "),$("#resendWatiMessagesData").html('<a id="resend_btn" class="btn btn-primary px-3 py-2 mr-2 mt-3 float-right" href="javascript:void(0);">Resend</a>');var l={};l.userId=USER_ID,l.templateName=t,l.selectedLeads=a,$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","set-wati-message"),data:JSON.stringify(l),dataType:"json",cache:!1,timeout:6e5,success:function(a){return"EX01"==a.statusCode||"E004"==a.statusCode?(showMessageTheme2(0,a.message,"",!1),$("input#allchecked").prop("checked",!1),$('input[name="chk-users-lead"]').prop("checked",!1),!1):($("#mswatiBroadcastSendThroughMobile").modal("hide"),$("#mcustomWatiTemplatesList").modal("hide"),$("input#allcheckedFailed").prop("checked",!1),$("input#selectLeadAll").prop("checked",!1),$('input[name="chk-users-lead"]').prop("checked",!1),$('input[name="lead-move-another"]').prop("checked",!1),$("#allcheckedFailed").prop("checked",!1),$('input[name="chk-users-lead-resend"]').prop("checked",!1),null!=a.leadRes&&("send"!=o&&"resend"!=o||openSuccessFailedWatiMessages(a.leadRes,e,t)),$("#successFailedWatiMessagesModal").modal("show"),!1)},error:function(e){return!1}})}function viewWatiTemplate(e,t,a){e?($("#table_row_"+a).addClass("selected_row").siblings().removeClass("selected_row"),$(".wati-wrapper").addClass("active-wati-template"),$(".wati-template").removeClass("hide-wati-template"),$(".wati-template").addClass("show-wati-template"),$("#priviewTemplate").html(""),$("#priviewTemplateSecond").html(""),$("#priviewTemplateThird").html(""),setTimeout((function(){$("#priviewTemplate").html(getViewTemplate(watiTemplateContent.messageTemplates[t])),$("#priviewTemplateSecond").html(getViewTemplate(watiTemplateContent.messageTemplates[t])),$("#priviewTemplateThird").html(getViewTemplate(watiTemplateContent.messageTemplates[t]))}),200)):($(".wati-wrapper").removeClass("active-wati-template"),$(".wati-template").addClass("hide-wati-template"),$(".wati-template").removeClass("show-wati-template"))}function getViewTemplate(e){var t=[e],a="";return $.each(t,(function(e,t){a+='<div class="main-card card mx-auto mb-3" style="max-width:300px;"><div class="card-body p-2">',null!=t.header.mediaFromPC&&""!=t.header.mediaFromPC&&(a+='<img src="/'+t.header.mediaFromPC+'" class="w-100 mb-3" style="max-width:250px">'),a+='<ul class="p-0">';var o=t.bodyOriginal.split("\n");$.each(o,(function(e,t){a+='<li class="'+(e<5||15==e?"mb-3":"")+'">'+t+"</li>"})),a+='</ul><div class="mt-3">'+t.footer+'</div><hr class="mb-0"/><div class="full">',null!=t.buttons&&""!=t.buttons&&$.each(t.buttons,(function(e,t){a+='<div class="full font-weight-semi-bold text-primary text-center py-1">'+t.parameter.text+"</div>"})),a+="</div></div></div>"})),a}function gotoBackWatiModal(){$("#allchecked").prop("checked",!1),$('input[name="chk-users-lead"]').prop("checked",!1),$("#allcheckedFailed").prop("checked",!1),$('input[name="chk-users-lead-resend"]').prop("checked",!1),$("#mswatiBroadcastSendThroughMobile").modal("hide"),$("#successFailedWatiMessagesModal").modal("hide"),$("#mcustomWatiTemplatesList").modal("show"),viewWatiTemplate(!1)}function selfModalHide(e){$("#"+e).modal("hide"),viewWatiTemplate(!1)}function callLeadDemoList(e,t,a){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","school-demo-list"),data:JSON.stringify(getRequestForLeadDemo(e,t,a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else{var t=getLeadDemoHtml(e);$("#schoolDemoListTbody").html(t)}},error:function(e){console.log(e)}})}function getRequestForLeadDemo(e,t,a){var o={},l={};return l.schoolId=SCHOOL_ID,l.modeSearch=e,l.startDate=t,l.endDate=a,o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userId=USER_ID,o.userType="COMMON",l.authentication=o,l}function getLeadDemoHtml(e){var t=e.studentEnrolledList,a="",o=1;if(t.length>0)for(let e=0;e<t.length;e++){const n=t[e];var l=n.meetingJoinTimeList;if(a+="<tr>",a+="<td>"+o+++"</td>",a+='<td style="vertical-align: top !important;">'+n.demoDate+"<br/>"+n.demoStartTime+" - "+n.demoEndTime+"<br/>"+n.meetingFrom+"</td>",a+='<td style="vertical-align: top !important;">'+n.assignName+" | "+n.meetingPersoneName+"</td>",!n.searchUser){if(a+='<td style="vertical-align: top !important;">',l.length>0){a+='<table class="table table-bordered table-striped">',a+="<tr><th>Host</th><th>Attendee</th></tr>";for(let e=0;e<l.length;e++){const t=l[e];"host"==t.joinType?a+="<tr><td class=>"+t.clickTime+'<br/><span style="font-size:10px">'+t.city+" | "+t.country+" | "+t.timeZone.replace("/","-")+"</span></td><td> - </td></tr>":a+="<tr><td> - </td><td class=>"+t.clickTime+'<br/><span style="font-size:9px">'+t.city+" | "+t.country+" | "+t.timeZone.replace("/","-")+"</span></td></tr>"}a+="</table>"}a+="</td>"}a+='<td style="vertical-align: top !important;">'+n.meetingStatus+"</td>",a+='<td style="vertical-align: top !important;">'+n.meetingRemark+"</td>",a+="</tr>"}return a}function callEnrollmentListDaywise(e,t,a,o){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-enrolled-list-daywise"),data:JSON.stringify(getRequestForEnrollDaywise(e,t,a,o)),dataType:"json",cache:!1,timeout:6e5,async:!0,success:function(a){if("0"==a.status||"2"==a.status)showMessage(!0,a.message);else getEnrollDaywiseHtml(a,e,t)},error:function(e){console.log(e)}})}function getRequestForEnrollDaywise(e,t,a,o){var l={},n={};return n.schoolId=SCHOOL_ID,n.modeSearch=t,n.startDate=a,n.endDate=o,n.reportType=e,l.hash=getHash(),l.schoolId=SCHOOL_ID,l.schoolUUID=SCHOOL_UUID,l.userId=USER_ID,l.userType="COMMON",n.authentication=l,n}async function getEnrollDaywiseHtml(e,t,a){var o=e.enrollListMonth;const l=await getEnrollListTrWise(o,t,a);var n=l.series,s=l.attrMonth,r={series:n,chart:{height:350,type:"bar"},plotOptions:{bar:{borderRadius:10,dataLabels:{position:"top"}}},legend:{show:!0,formatter:customLegendFormatter},dataLabels:{enabled:!0,formatter:function(e){return e},offsetY:-30,style:{fontSize:"12px",colors:["#304758"]}},xaxis:{categories:s,position:"bottom",axisBorder:{show:!1},axisTicks:{show:!1},crosshairs:{fill:{type:"gradient",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}}}},yaxis:{axisBorder:{show:!1},axisTicks:{show:!1},labels:{show:!1,formatter:function(e){return e+""}}},tooltip:{y:{formatter:function(e){return t+" "+e}}}},d=new ApexCharts(document.querySelector("#chart-enroll-yearwise"),r);return d.render(),d.update(),""}$((function(){}));let customLegendFormatter=(e,t)=>{for(var a=t.w.globals.series[t.seriesIndex],o=0,l=0;l<a.length;l++)o+=a[l];var n='<div class="d-flex justify-content-center flex-wrap data-count-year">';return n+='<span class="d-inline-flex align-items-center mr-2">'+e+":</span>",n+='<span class="d-inline-flex align-items-center mr-2"><b>'+o+"</b></span>",n+="</div>"};async function getEnrollListTrWise(e,t,a){var o={},l=[],n=[];if(e.length>0){for(let o=0;o<e.length;o++){var s=e[o],r=s.academicYear,d=s.enrollListMonth,i={},c=[];if(d.length>0)for(let e=0;e<d.length;e++){var u=d[e],p=(u.enrollWeekwise,u.leadWeekwise,u.totalEnrollment),h=u.totalLead;if("MONTH"==a)"Enrollment"==t?c.push(p):"Leads"==t&&c.push(h),l.push(u.meetingDate);else{var m=u.enrollDayList;if(m.length>0)for(let e=0;e<m.length;e++){var g=m[e];if("Enrollment"==t){c.push(g.enrollDaywise);var v=g.meetingDate.replace(", "+r,"");l.push(v)}else if("Leads"==t){c.push(g.leadDaywise);v=g.meetingDate.replace(", "+r,"");l.push(v)}}}}i.name=r,i.data=c,n.push(i)}o.attrMonth=l,o.series=n}return o}function callLeadCampaignList(e,t,a,o,l){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-lead-list-campaign"),data:JSON.stringify(getRequestForLeadCampaign(e,t,a,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status)showMessage(!0,e.message);else if(e.leadListCampaign.length>0){if(""!=o){$(".campaign-tr-"+l).removeClass("d-none");var t=getLeadListCampaignWiseHtml(e);$(".campaign-td-"+l).html(t)}else{$(".campaign-tr-"+l).addClass("d-none");t=getLeadCampaignWiseHtml(e);$("#leadCampaignListTbody").html(t);var a=getCampaignFooterTotal(e);$("#listCampaignTfoot").html(a)}$(".child_name").each((function(){var e=$(this).text();""!=e&&(e=e.trim());var t=e.split(" ");if(t.length>1){var a="";for(let e=0;e<t.length;e++){a+=t[e].replace(new RegExp(".{1,25}","g"),"$& ")}$(this).text(a)}else{let t=e.replace(new RegExp(".{1,25}","g"),"$& ");$(this).text(t)}})),$(".child_email").each((function(){var e=$(this).text();if(""!=e&&(e=e.trim()),e.split(" ").length>1);else{let t=e.replace(new RegExp(".{1,50}","g"),"$& ");$(this).text(t)}}))}else{t=getLeadCampaignWiseHtml(e);$("#leadCampaignListTbody").html(t)}},error:function(e){console.log(e)}})}function getRequestForLeadCampaign(e,t,a,o){var l={},n={};if(n.schoolId=SCHOOL_ID,n.modeSearch=e,n.startDate=t,n.endDate=a,null!=o&&""!=o){n.reportType="LEAD-LIST";var s=[o];n.utmCampaign=s}else{s=[];""!=$("#searchCampaignType").val()&&null!=$("#searchCampaignType").val()&&(s=$("#searchCampaignType").val()),n.utmCampaign=s,n.reportType="CAMPAIGN-LIST"}return l.hash=getHash(),l.schoolId=SCHOOL_ID,l.schoolUUID=SCHOOL_UUID,l.userId=USER_ID,l.userType="COMMON",n.authentication=l,n}function getLeadCampaignWiseHtml(e){var t=e.leadListCampaign,a="",o=1;if(t.length>0)for(let e=0;e<t.length;e++){const d=t[e];var l=parseFloat(d.totalSpend),n=l/parseInt(d.totalLead),s=0;""!=d.totalFbLead&&(s=l/parseInt(d.totalFbLead)),a+="<tr class="+("N"==d.activeStatus?"bg-warning":"")+">",a+='<td class="text-center" style="max-width:70px !important;min-width:70px">'+o+"</td>",a+='<td style="vertical-align: top !important;min-width:250px" ><a href="javascript:void(0)" data-target="#collapseOne'+o+'" data-toggle="collapse" aria-expanded="false" aria-controls="collapse'+o+'" class="collapsed"  onclick="getListLeadCampaign(\''+d.campaignName+"','"+o+"');\">"+d.campaignName+"</a></td>",a+='<td style="vertical-align: top !important;min-width:250px" class="text-center"><span class="bg-success text-white text-center  badge font-12">'+d.totalActiveLead+'</span> + <span class="bg-warning text-white text-center badge font-12">'+d.totalInactiveLead+'</span> = <span class="badge badge-primary font-12">'+d.totalLead+'</span> | <span class="badge badge-info  text-center font-12">'+d.totalFbLead+"</span></td>",a+='<td style="vertical-align: top !important;min-width:180px" class="text-center"><span class="badge badge-pill badge-dark font-10">$'+d.totalSpend+'</span><br/><span class="badge badge-pill badge-primary font-10">$'+n.toFixed(2)+'</span> | <span class="badge badge-pill badge-info font-10">$'+s.toFixed(2)+"</span> </td>",a+='<td class="rounded-bottom-right-10">';var r=d.assignNames.length;if(a+="<span>"+(r="<b>"+r+"</b> "+(d.assignNames.length>1?" Counselors":"Counselor")+" with <b>$"+(n*parseInt(d.totalLead)).toFixed(2)+"</b>")+"</span>",a+='<div class="d-flex overflow-x-auto" style="max-width:550px;">',d.assignNames.length>0)for(let e=0;e<d.assignNames.length;e++){const t=d.assignNames[e];a+='<div class="border bg-white rounded-5 w-100 mr-2 recommended-teacher-thumb" style="max-width:230px;min-width:230px;" id="clone" data-order="3">',a+='<div class="card-body d-flex px-2 pt-2 align-items-center pb-0">',a+='<span><img width="42" class="avatar-icon" src="'+t.profilePic+'" alt="" /></span>',a+='<div class="pl-1"><div class="teacher-name font-weight-semi-bold font-size-md">'+t.assignName+"</div>",a+='<div class="teacher-availability">',a+='<span class="total-hour text-primary">'+t.assignLead+' | </span><span class="total-hour text-success">'+t.assignActiveLead+' | </span><span class="total-hour text-danger">'+t.assignInactiveLead+"</span>",a+="</div>",a+="</div>",a+='<div class="pl-1 ml-auto bold"><div class="teacher-name font-weight-semi-bold font-size-md">$'+(n*parseInt(t.assignLead)).toFixed(2)+"</div>",a+="</div>",a+="</div>",a+="</div>"}a+="</div>",a+="</td>",a+="</tr>",a+='<tr data-parent="#accordion" id="collapseOne'+o+'" class="collapse campaign-tr-'+o+'"><td colspan="9" >',a+='<table class="table" id="leadListByCamp'+o+'" style="font-size:11px;min-width:450px">',a+="<thead>",a+="<tr>",a+='<th style="5% !important" class="text-center bg-primary text-white">Sr no.</th>',a+='<th class="text-center bg-primary text-white">Student Name<br/>Grade</th>',a+='<th class="text-center bg-primary text-white">Email<br/>Country<br/>Create Date Time</th>',a+='<th class="text-center bg-primary text-white">Ad_set<br/>Ad_Name</th>',a+='<th class="text-center bg-primary text-white">Counselor Name<br/>Lead Status</th>',a+='<th class="text-center bg-primary text-white">Remarks</th>',a+="</tr>",a+="</thead>",a+='<tbody class="campaign-td-'+o+'"></tbody>',a+="</table>",a+="</td></tr>",o+=1}else a+="<tr>",a+='<td colspan="9" class="text-center">No Record</td>',a+="</tr>";return a}function getCampaignFooterTotal(e){var t=e.leadListCampaign,a="",o=0,l=0,n=0,s=0,r=0;if(t.length>0){for(let e=0;e<t.length;e++){const a=t[e];o+=parseInt(a.totalLead),l+=parseInt(a.totalActiveLead),n+=parseInt(a.totalInactiveLead),s+=parseInt(a.totalFbLead),r+=parseFloat(a.totalSpend)}r.toFixed(2);a+='<tr style="font-size:14px;background-color: #c9def3 !important;">',a+='<th class="text-center"></th>',a+='<th style="vertical-align: top !important;" class="text-center">Total</th>',a+='<th style="vertical-align: top !important;" class="text-center">'+l+" + "+n+" = "+o+" | "+s+"</th>",a+='<th style="vertical-align: top !important;" class="text-center">$'+r.toFixed(2)+"</td>",a+='<th style="vertical-align: top !important;" class="text-center"></td>',a+="</tr>"}return a}function getListLeadCampaign(e,t){var a=$("#dataLeadCampaignStartDate").val(),o=$("#dataLeadCampaignEndDate").val();$("#searchLeadCampaignType").val();return""==$("#dataLeadCampaignStartDate").val()&&null==$("#dataLeadCampaignStartDate").val()?(showMessageTheme2(1,"Please choose start date","",!0),!1):""==$("#dataLeadCampaignEndDate").val()&&null==$("#dataLeadCampaignEndDate").val()?(showMessageTheme2(1,"Please choose end date","",!0),!1):void callLeadCampaignList($("#searchLeadCampaignType").val(),a,o,e,t)}function getLeadListCampaignWiseHtml(e){var t=e.leadListCampaign,a="",o=1;if(t.length>0)for(let e=0;e<t.length;e++){const l=t[e];a+="<tr class="+("N"==l.activeStatus?"bg-warning":"")+">",a+='<td class="text-center">'+o+++"</td>",a+='<td style="vertical-align: top !important;"><span class="child_name">'+l.childName+"</span><br/>"+l.grade+"</td>",a+='<td style="vertical-align: top !important;"><span class="child_email">'+l.email+"</span><br/>"+l.country+"<br/>"+l.assignDate+"</td>",a+='<td style="vertical-align: top !important;">'+l.fbAddSet+"<br/>"+l.fbAdd+"</td>",a+='<td style="vertical-align: top !important;">'+l.assignName+"<br/>"+l.leadStatus+"</td>",a+='<td style="vertical-align: top !important;">'+l.followupRemark+"</td>",a+="</tr>"}else a+="<tr>",a+='<td colspan="9" class="text-center">No Record</td>',a+="</tr>";return a}function callTotalCountLeads(e,t,a,o,l,n,s,r,d,i,c,u){""==t&&(t=$("#"+e+" #leadFromSearchModuleId").val()),""==o&&(o=$("#"+e+" #clickFromSearch").val()),""==l&&(l=$("#"+e+" #currentPageSearch").val()),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-total-lead"),data:JSON.stringify(getCallRequestForAdvanceLeadSearchStudent(e,t,a,o,l,n,s,r,d,i)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if(console.log(e),customLoader(!1),"0"==e.status||"2"==e.status)showMessage(!0,e.message);else if("B2B"==d)if("new-lead"==u)getTotalB2BLeads(e);else{var a=getB2BLeadTotalCount(e,t);$("#b2b-total-head").html(a),$("#b2bLeadCount").html(a)}else if("B2C"==d)if("new-lead"==u)getTotalB2CLeads(e);else{a=getLeadTotalCountList(e,t,c,u);var o=getLeadTotalHotCountList(e,t,u);"Y"==i?($("#total-lead-active-tr").html(a),$("#total-active-hotlead").html(o)):($("#total-lead-inactive-tr").html(a),$("#total-inactive-hotlead").html(o))}else{a=getB2BLeadTotalCount(e,t);$("#b2bLeadCount").html(a)}},error:function(e){console.log(e),customLoader(!1)}})}function getLeadTotalCountList(e,t,a,o){var l=e.leadTotalData,n="";return n+='<td data-label="Total" class="text-center"  style="background-color:#3f6ad8 !important;color:#fff">',l.totalLeads>0?n=n+'<a href="javascript:void(0);" style="color:#fff !important" onclick="getTotalLead(\'B2C\')">'+l.totalLeads+"</a>":n+="-",n+="</td>",n+='<td data-label="Total FB Lead"  class="text-center" text-color="#fff" style="background-color:#6c757d !important;color:#fff">',l.totalFbLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'facebooklead','B2C');\">")+l.totalFbLead+"</a>":n+="-",n+=" | ",l.todayFbLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'fbtdlead','B2C');\">")+l.todayFbLead+"</a>":n+="-",n+="</td>",n+='<td data-label="Today\'s Fresh Lead" class="text-center"  style="background-color:#6c757d !important;color:#fff">',l.freshLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'freshLead','B2C');\">")+l.freshLead+"</a>":n+="-",n+="</td>",n+='<td data-label="Today\'s Follow-ups" class="text-center" style="background-color:#efd597 !important;color:#343a40">',l.todayScheduleCall>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'todayScheduleCall','B2C');\">")+l.todayScheduleCall+"</a>":n+="-",n+="</td>",n+='<td data-label="Today\'s School Demo" class="text-center" style="background-color:#f3f39e !important;color:#343a40">',l.todayDemo>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'tdyDemo','B2C');\">")+l.todayDemo+"</a>":n+="-",n+="</td>",l.discardPermission&&(n+='<td data-label="Unassigned Lead" class="text-center"  style="background-color:#6c757d !important;color:#fff">',l.followupLead2>0?n=(n=n+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'leadnotassign','B2C');\">")+l.followupLead2+"</a>":n+="-",n+="</td>"),n=(n=(n=(n=(n=(n=(n=(n=(n+='<td data-label="Followup Lead" class="text-center" >')+'<select name="leadsFollowCount" id="leadsFollowCount"  onchange="advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true,'folwcount','B2C');\">")+'<option value="0" '+(0==a?"selected":"")+">0</option>")+'<option value="1" '+(1==a?"selected":"")+">1</option>")+'<option value="2" '+(2==a?"selected":"")+">2</option>")+'<option value="3" '+(3==a?"selected":"")+">3</option>")+'<option value="4" '+(4==a?"selected":"")+">4</option>")+'<option value="5" '+(5==a?"selected":"")+">5</option>")+'<option value=">5" '+(">5"==a?"selected":"")+">>5</option>",n+="</select>",n+="</td>",n+='<td data-label="Unattended Lead" class="text-center" >',l.unattendedLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'unattendedLead','B2C');\">")+l.unattendedLead+"</a>":n+="-",n+="</td>",n+='<td data-label="Total Demo" class="text-center" style="background-color:#f3f39e !important;color:#343a40">',l.demoLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'demoLead','B2C');\">")+l.demoLead+"</a>":n+="-",n+=" | ",l.followupLead3>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'demodone','B2C');\">")+l.followupLead3+"</a>":n+="-",n+="</td>",n+='<td data-label="Positive to enrollment" class="text-center" style="background-color:#efd597 !important;color:#343a40">',l.followupLead1>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'followupLead1','B2C');\">")+l.followupLead1+"</a>":n+="-",n+="</td>",n+='<td data-label="Move lead" class="text-center" style="background-color:#f3d1e7 !important;color:#343a40">',l.movedLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'movedLead','B2C');\">")+l.movedLead+"</a>":n+="-",n+="</td>",n+='<td data-label="Scrape" class="text-center" style="background-color:#efb3aa !important;color:#343a40">',l.scrapeLead>0?n=(n=n+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+l.leadFrom+"','"+l.clickFrom+"-"+l.clickUserid+"', '0', 'new', true, 'scrapeLead','B2C');\">")+l.scrapeLead+"</a>":n+="-",n+="</td>"}function getLeadTotalHotCountList(e,t){var a=e.leadTotalData,o="";return o+='<td data-label="Hot" class="text-center bg-success text-white">',a.totalHot>0?o=(o=o+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'hottotal','B2C');\">")+a.totalHot+"</a>":o+="-",o+="</td>",o+='<td data-label="Warm" class="text-center bg-warning" >',a.totalWarm>0?o=(o=o+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'warmtotal','B2C');\">")+a.totalWarm+"</a>":o+="-",o+="</td>",o+='<td data-label="Cold" class="text-center bg-primary text-white" >',a.totalCold>0?o=(o=o+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'coldtotal','B2C');\">")+a.totalCold+"</a>":o+="-",o+="</td>",o+='<td data-label="Website" class="text-center"  style="background-color:#7000FF;">',a.totalWebsiteDemo>0?o=(o=o+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'totalWebsiteDemo','B2C');\">")+a.totalWebsiteDemo+"</a>":o+="-",o+="</td>",o+='<td data-label="Copyurl" class="text-center"  style="background-color:#2200FF;">',a.totalCopyUrlDemo>0?o=(o=o+'<a href="javascript:void(0);" style="color:#fff !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'totalCopyUrlDemo','B2C');\">")+a.totalCopyUrlDemo+"</a>":o+="-",o+="</td>",o+='<td data-label="support" class="text-center" >',a.totalDemoSupport>0?o=(o=o+'<a href="javascript:void(0);" style="color:#343a40 !important" onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'totalDemoSupport','B2C');\">")+a.totalDemoSupport+"</a>":o+="-",o+="</td>"}function getB2BLeadTotalCount(e,t){var a=e.leadTotalData,o="";return o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-light-primary border border-primary rounded-10 position-relative mr-0 mr-sm-2 mb-2 shadow-sm">',o+='<span class="line-left bg-primary d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Total</b></p>',o+='<p class="m-0">',a.totalLeads>0?o+='<a href="javascript:void(0);" class="text-dark" onclick="getTotalLead(\'B2B\')">'+a.totalLeads+"</a>":o+="-",o+="</p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-white border border-secondary rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm ">',o+='<span class="line-left bg-secondary d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Today\'s Fresh Requests</b></p>',o+='<p class="m-0"><b>',a.freshLead>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'freshLead','B2B');\">"+a.freshLead+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1 ">',o+='<div class="full p-2 bg-light border border-secondary rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm ">',o+='<span class="line-left bg-secondary d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Basic Details not Filled</b></p>',o+='<p class="m-0"><b>',a.followupLead1>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'leadbasicdetail','B2B');\">"+a.followupLead1+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-review-white border border-review-dark rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm">',o+='<span class="line-left bg-review-dark d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Request Under Review</b></p>',o+='<p class="m-0"><b>',a.followupLead2>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'leadrequestreview','B2B');\">"+a.followupLead2+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-callCompleted-white border border-callCompleted-dark rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm">',o+='<span class="line-left bg-callCompleted-dark d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Call Completed</b></p>',o+='<p class="m-0"><b>',a.totalCallComplete>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'callb2bcomplete','B2B');\">"+a.totalCallComplete+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-interview-white border border-interview-dark rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm ">',o+='<span class="line-left bg-interview-dark d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Interested to Interview</b></p>',o+='<p class="m-0"><b>',a.meetingResult>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'leadInterestedInterview','B2B');\">"+a.meetingResult+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-totinterview-white border border-totinterview-dark rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm ">',o+='<span class="line-left bg-totinterview-dark d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Total Interview</b></p>',o+='<p class="m-0"><b>',a.demoLead>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'leadInterviewBooked','B2B');\">"+a.demoLead+"</a>":o+="-",o+="</b> | <b>",a.followupLead3>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'btwinterviewdone','B2B');\">"+a.followupLead3+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-moveinterview-white border border-moveinterview-dark rounded-10 position-relative mr-0 mr-sm-2 mb-2  shadow-sm ">',o+='<span class="line-left bg-moveinterview-dark d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Moving for the Next meeting</b></p>',o+='<p class="m-0"><b>',a.totalReserved>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'movingtonextinterview','B2B');\">"+a.totalReserved+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full  p-2 bg-light-success border border-success rounded-10 position-relative mr-0 mr-sm-2 mb-2 shadow-sm">',o+='<span class="line-left bg-success d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Converted | Partner </b></p>',o+='<p class="m-0"><b>',a.totalConverted>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'totalonboarding','B2B');\">"+a.totalConverted+"</a>":o+="-",o+="</b> | <b>",a.totalPartner>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'totalonpartner','B2B');\">"+a.totalPartner+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-light-alternate border border-alternate rounded-10 position-relative mr-0 mr-sm-2 mb-2 shadow-sm ">',o+='<span class="line-left bg-alternate d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Move Lead</b></p>',o+='<p class="m-0"><b>',a.movedLead>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'btmovdLead','B2B');\">"+a.movedLead+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-light-danger border border-danger rounded-10 position-relative mb-2 shadow-sm">',o+='<span class="line-left bg-danger d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Scrape</b></p>',o+='<p class="m-0"><b>',a.scrapeLead>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'scrapeLead','B2B');\">"+a.scrapeLead+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>",o+='<div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-12 px-1">',o+='<div class="full p-2 bg-rejected-white border border-rejected-dark rounded-10 position-relative mb-2 shadow-sm">',o+='<span class="line-left bg-rejected-dark d-inline-block position-absolute rounded-10"></span>',o+='<p class="m-0 font-12"><b>Rejected</b></p>',o+='<p class="m-0"><b>',a.totalArchive>0?o+='<a href="javascript:void(0);" class="text-dark"  onclick="return advanceLeadSearchStudent(\'advanceLeadNewSearchForm\',\''+t+"', '"+a.leadFrom+"','"+a.clickFrom+"-"+a.clickUserid+"', '0', 'new', true, 'totalArchive','B2B');\">"+a.totalArchive+"</a>":o+="-",o+="</b></p>",o+="</div>",o+="</div>"}function openSuccessFailedWatiMessages(e,t,a){$("#usrPopDataOnResend").html(successFailedWatiMessagesModal(e)),$("#failedWatiTableDiv").slideDown(),$("#successWatiTableDiv").slideUp(),$("#successWatiTable").dataTable();var o=$("#failedWatiTable").DataTable();o&&o.destroy();var l=o.rows().count();$("#failedWatiTable").dataTable({lengthMenu:[[l],[l]],lengthChange:!1,paging:!1,info:!1}),$("#successWatiDiv").css("cursor","pointer"),$("#failedWatiDiv").css("cursor","default"),$("#chevron_failed").removeClass("fa-chevron-up").addClass("fa-chevron-down"),$("#chevron_success").removeClass("fa-chevron-down").addClass("fa-chevron-up"),$("#successWatiDiv").click((function(){$("#successWatiTableDiv").slideDown(500),$("#failedWatiTableDiv").slideUp(500),$("#failedWatiDiv").css("cursor","pointer"),$("#successWatiDiv").css("cursor","default"),$("#chevron_success").removeClass("fa-chevron-down").addClass("fa-chevron-up"),$("#chevron_failed").removeClass("fa-chevron-up").addClass("fa-chevron-down")})),$("#failedWatiDiv").click((function(){$("#failedWatiTableDiv").slideDown(500),$("#successWatiTableDiv").slideUp(500),$("#successWatiDiv").css("cursor","pointer"),$("#failedWatiDiv").css("cursor","default"),$("#chevron_failed").removeClass("fa-chevron-down").addClass("fa-chevron-up"),$("#chevron_success").removeClass("fa-chevron-up").addClass("fa-chevron-down")})),$("#resendWatiMessagesData").html('<a id="resend_btn" class="btn btn-primary px-3 py-2 mr-2 mt-3 float-right" href="javascript:void(0);">Resend</a>'),$("#selectionCountOnFailed").html('<span>Selected- </span><span id="selectedCountFailed">0</span> / <span id="totalCountFailed">0</span>'),$("#templateNameSF").html(),$("#templateNameSF").html("<b>"+a+"</b> "),boolvalSF=!0,$("#viewMethodCallingSF").html(),$("#viewMethodCallingSF").html('<a href="javascript:void(0)" class="btn btn-primary btn-sm rounded-circle" onclick="viewWatiTemplate('+boolvalSF+","+t+", `"+a+'`);" > <i class="fa fa-eye text-white"></i> </a>'),$("#resend_btn").click((function(){var e="",o="";$.each($("input[name='chk-users-lead-resend']:checked"),(function(){o=o+","+$(this).val()}));var l=(e+=o).substring(1,e.length);if(""==l)return $("#remarksresetDelete2").modal("hide"),showMessageTheme2(0,"Please check any one user to send message","",!1),!1;showWarningMessageShow("Are you sure you want to resend the message?","sendWatiNotificationToUser( "+t+",'"+a+"','"+l+"','resend')","info-modal-sm")}));var n=$(".checkToSendFailed").length;function s(){var e=$(".checkToSendFailed:checked").length;$("#selectedCountFailed").text(e)}$("#totalCountFailed").text(n),$(".checkToSendFailed").click((function(){s();$(".checkToSendFailed:checked").length>0&&$(".checkToSendFailed:checked").length==$(".checkToSendFailed").length?$("#allcheckedFailed").prop("checked",!0):$("#allcheckedFailed").prop("checked",!1)})),$("#allcheckedFailed").click((function(){$(this).prop("checked")?$(".checkToSendFailed").prop("checked",!0):$(".checkToSendFailed").prop("checked",!1),s()}))}function updateWatiLogsLink(e){$("#wati_logs_link_"+e).show()}function closeModalAndFlushData(){$("input#allchecked").prop("checked",!1),$('input[name="chk-users-lead"]').prop("checked",!1),$(".stmsg").html(""),$("#successFailedWatiMessagesModalClose").modal("hide"),$("#allchecked").prop("checked",!1),$("input#selectLeadAll").prop("checked",!1),$('input[name="lead-move-another"]').prop("checked",!1),$("#leadNoMove").val(""),$("#remarksresetDelete1").remove(),$(".modal-backdrop").remove()}function getLeadStatusLog(e,t,a){var o={};o.leadno=e,o.adminStatus=a,o.leadsFollowCount=$("#leadsFollowCount").val(),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","lead-status-log"),data:JSON.stringify(o),dataType:"json",cache:!1,timeout:6e5,success:function(a){var o="<b>"+a.leadTagging+"</b>";if($(".leadtagstatus_"+e).html(o),"0"==a.status||"2"==a.status);else{var l="";if("new-lead"==t){for(var n=1,s=0;s<a.data.length;s++){var r=a.data[s];l+='<li class=" '+(0==s?"follow-up-accordian-active":"")+'"><span class="cursor follow-up-no text-primary p-2 text-center border-primary full bold"><label class="float-left">'+n+++"</label> "+r.leadStatus+'<br/><span style="font-size:10px">'+r.statusDate+'</span> <i class="fa '+(0==s?"fa-angle-up":"fa-angle-down")+' float-right" style="line-height: 20px;"></i></span><div class="follow-up-content text-center" style="'+(0==s?"display: block":"")+'"><div class="dropdown d-inline-block text-center my-2" style="position: inherit;"><button type="button" aria-haspopup="true" aria-expanded="false" data-toggle="dropdown" class="dropdown-toggle btn btn-sm btn-primary">View Follow Up</button><div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu-md dropdown-menu p-2" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 32px, 0px);font-size:11px;"><table class="w-100"><tr><th class="p-1 border-0">Last Followup Date:</th><td class="p-1 border-0" id="connectedTh">'+r.statusDate+'</td></tr><tr><th class="p-1 border-0">Connected Through:</th><td class="p-1 border-0" id="connectedTh">'+r.leadFollowup+'</td></tr><tr><th class="p-1 border-0">Connected With:</th><td class="p-1 border-0" id="connectWith">'+r.tocall+'</td></tr><tr><th class="p-1 border-0">Next Follow-up:</th><td class="p-1 border-0" id="nextFollowStatus">'+(""!=r.callStatus?r.callStatus:"")+(""!=r.nextCallDate?r.nextCallDate:"")+'</td></tr><tr><th class="p-1 border-0">Remarks:</th><td class="p-1 border-0 text-justify" id="callRemark" style="max-width: 250px;">'+(""!=r.remarks?r.remarks:"N/A")+"</td></tr></table></div></div></div></li>"}$(".followup-remark-"+e).html(l),$(".follow-up-no").click((function(){$(this).find(".fa-angle-down").toggleClass("fa-angle-down fa-angle-up"),$(this).parent().siblings().find(".fa-angle-up").toggleClass("fa-angle-up fa-angle-down"),$(this).parent().find(".follow-up-content").slideDown(),$(this).parent().siblings().find(".follow-up-content").slideUp(),$(this).parent().addClass("follow-up-accordian-active"),$(this).parent().siblings().removeClass("follow-up-accordian-active")}))}else{var d=1;l+='<div style="height:100px;overflow-y:auto">';for(var i=0;i<a.data.length;i++)d>3&&(l+="<br/>",d=1),l+='<span style="font-size:12px; " data-toggle="tooltip" data-placement="top"><div class="d-inline-block"><p class="m-0 text-dark"><i class="fa fa-check-circle" style="color:green;"></i><b>'+a.data[i].leadStatus+'</b></p><p class="m-0 text-dark" style="padding-left:12px">'+a.data[i].statusDate+"</p></div></span>&nbsp;&nbsp;",d+=1;l+="</div>",$(".leadstatus_"+e).html(l)}}return!1},error:function(e){return!1}})}function callB2CDashboardLead(e,t){$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","b2c-dashboard-lead"),data:JSON.stringify(getRequestForB2cDashboard(e,t)),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessage(!0,e.message):(""!=e.totalLeads&&$("#totalLead").text(e.totalLeads),""!=e.totalConverted&&$("#convertLead").text(e.totalConverted),""!=e.followupLead1&&$("#positiveLead").text(e.followupLead1),""!=e.demoLead&&$("#totalDemoLead").text(e.demoLead))},error:function(e){console.log(e)}})}function getRequestForB2cDashboard(e,t){var a={},o={};return o.schoolId=SCHOOL_ID,o.userId=USER_ID,o.moduleId=e,o.leadFrom="LEAD",o.clickFrom="list",o.currentPage=0,o.leadType=t,a.leadModifyDTO=o,a.leadModifyDetailDTO={},a.leadStudentDetailDTO={},a.leadDemoInfo={},a.leadCallFollowupDTO={},a.leadCountDetailDTO={},a}function callLeadSourceList(e,t,a,o){hideMessageTheme2(""),customLoader(!1),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"LEAD-SOURCE-LIST",t)),dataType:"json",cache:!1,timeout:6e5,success:function(t){"0"==t.status||"2"==t.status?showMessageTheme2(!0,t.message):(result=t.mastersData.data,dropdown=$("#"+e+" #"+a),dropdown.html(""),dropdown.append('<option value="0">Select Source</option>'),$.each(result,(function(e,t){o?dropdown.append('<option value="'+t.key+'">'+t.value+"</option>"):dropdown.append('<option value="'+t.value+'">'+t.value+"</option>")})))},error:function(e){console.log(e)}})}function callUTMSourceList(e,t,a,o){hideMessageTheme2(""),customLoader(!1),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"UTM-SOURCE-LIST",t)),dataType:"json",cache:!1,timeout:6e5,success:function(t){"0"==t.status||"2"==t.status?showMessageTheme2(!0,t.message):(result=t.mastersData.data,dropdown=$("#"+e+" #"+a),dropdown.html(""),dropdown.append('<option value="0">Select Source</option>'),$.each(result,(function(e,t){o?dropdown.append('<option value="'+t.key+'">'+t.value+"</option>"):dropdown.append('<option value="'+t.value+'">'+t.value+"</option>")})))},error:function(e){console.log(e)}})}function getRequestForLeadAssign(e,t,a,o,l){var n={},s={},r={};return r.requestKey=t,r.requestValue=a,null!=l&&(r.requestExtra=l),null!=o&&(r.permissionStatus=o),s.hash=getHash(),s.schoolId=SCHOOL_ID,s.schoolUUID=SCHOOL_UUID,s.userType="COMMON",n.authentication=s,n.requestData=r,n}function callLeadAssignUserList(e,t,a,o,l,n){hideMessageTheme2(""),customLoader(!1),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForLeadAssign(e,"LEAD-ASSIGN-USER-LIST",t,l,n)),dataType:"json",cache:!1,timeout:6e5,success:function(t){"0"==t.status||"2"==t.status?showMessageTheme2(!0,t.message):(result=t.mastersData.data,dropdown=$("#"+e+" #"+a),dropdown.html(""),dropdown.append('<option value="0">Select Assign</option>'),$.each(result,(function(e,t){o?dropdown.append('<option value="'+t.key+'" >'+t.value+" - ("+t.extra+")</option>"):dropdown.append('<option value="'+t.value+'">'+t.value+"</option>")})))},error:function(e){console.log(e)}})}function callLeadCounselorsList(e,t,a,o,l,n,s,r){n&&customLoader(!1),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","get-lead-list-counselor"),data:JSON.stringify(getRequestForCounselorLead(e,t,a,o,n,s,r)),dataType:"json",cache:!1,timeout:6e5,success:function(e){if($("#leadReportSearch").modal("hide"),"0"==e.status||"2"==e.status)showMessage(!0,e.message);else{var d=$("#searchLeadCounselorReportType").val();if(e.leadListCounselor.length>0){var i=getLeadCounselorHtml(e,a,o,d,n,s,r);if($("#"+l).html(i),n){var c=l.split("-")[1];u="";"LOGS"==d?($("#advanceSearchAndExport12").addClass("hidden"),$("#listCounselorTheader_log").removeClass("hidden"),$("#listCounselorTheader").addClass("hidden"),u+=getLogsFootHtml(e,!1)):($("#advanceSearchAndExport12").removeClass("hidden"),$("#listCounselorTheader_log").addClass("hidden"),$("#listCounselorTheader").removeClass("hidden"),u+=getLeadCounselorFootHtml(e,!1)),-1==r||-1==s?$("#sublistCounselorTfoot--1").html(u):$("#sublistCounselorTfoot-"+c).html(u)}else{$("#counselor-list-footer").removeClass("d-none");var u="";"LOGS"==d?($("#advanceSearchAndExport12").addClass("hidden"),$("#listCounselorTheader_log").removeClass("hidden"),$("#listCounselorTheader").addClass("hidden"),"DAY"==t?$("#zadarmaCallSync").removeClass("hidden"):$("#zadarmaCallSync").addClass("hidden"),u+=getLogsFootHtml(e,!1)):($("#advanceSearchAndExport12").removeClass("hidden"),$("#listCounselorTheader_log").addClass("hidden"),$("#listCounselorTheader").removeClass("hidden"),$("#zadarmaCallSync").addClass("hidden"),u+=getLeadCounselorFootHtml(e,!1)),getLeadCounselorFootHtml(e,!0),$("#listCounselorTfoot").html(u)}}else{i=getLeadCounselorHtml(e,a,o,d,n,s,r);$("#"+l).html(i)}}},error:function(e){console.log(e)}})}function getRequestForCounselorLead(e,t,a,o,l,n,s){var r={},d={},i={},c={},u={};return d.schoolId=SCHOOL_ID,d.userId=USER_ID,d.searchDateType=t,d.assignTos=$("#"+e+" #assignToSearch").val(),d.leadStartDate=a,d.leadEndDate=o,d.leadSources=$("#"+e+" #sourceSearch").val(),d.leadStatuses=$("#"+e+" #statusSearch").val(),i.standard=$("#"+e+" #gradeSearch").val(),u.demoAssignTo=$("#"+e+" #leadDemoAssign").val(),c.acadmicYear=$("#"+e+" #acadmicYear").val(),l?(i.country=n,c.utmCampaigns=-1==s?["-1"]:s>0?[s]:[]):(i.country=$("#"+e+" #countryId").val(),c.utmCampaigns=$("#"+e+" #searchCampaign").val()),r.leadModifyDTO=d,r.leadModifyDetailDTO=c,r.leadStudentDetailDTO=i,r.leadDemoInfo=u,r.leadCallFollowupDTO={},r.reportType=l?"":$("#searchLeadCounselorReportType").val(),r}function callLeadUrl(e){var t="/dashboard/lead-data-list?moduleId="+moduleId+"&leadFrom=LEAD&clickFrom="+e+"&startDate=&endDate=&country=0&campaign=&currentPage=0&euid="+ENCRYPTED_USER_ID;getAsPost(t),customLoader(!1)}function getLeadCounselorHtml(e,t,a,o,l,n,s){var r=e.leadListCounselor,d="",i=1;if(""==t&&""==a)if("DAY"==$("#searchLeadCounselorType").val()){let e=(new Date).toISOString().split("T")[0];a=t=e.split("-")[2]+"-"+e.split("-")[1]+"-"+e.split("-")[0]}else if("WEEK"==$("#searchLeadCounselorType").val()){let e=new Date,o=new Date(e.setDate(e.getDate()-e.getDay())),l=new Date(e.setDate(e.getDate()+6)),n=o.toISOString().split("T")[0],s=l.toISOString().split("T")[0];t=n.split("-")[2]+"-"+n.split("-")[1]+"-"+n.split("-")[0],a=s.split("-")[2]+"-"+s.split("-")[1]+"-"+s.split("-")[0]}else if("MONTH"==$("#searchLeadCounselorType").val()){let e=new Date,o=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e.getFullYear(),e.getMonth()+1,0),n=o.toLocaleDateString("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit"}),s=l.toLocaleDateString("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit"});t=n.split("-")[2]+"-"+n.split("-")[1]+"-"+n.split("-")[0],a=s.split("-")[2]+"-"+s.split("-")[1]+"-"+s.split("-")[0]}if(r.length>0)for(let e=0;e<r.length;e++){const M=r[e];var c=0==M.assignTo?"N":M.assignTo;"Country"!=o&&"Campaign"!=o||(0==n&&0==s&&(c=0),s<0&&(c="00",s="00"),n<0&&(c="00",n="00")),"Partial entry (Unassigned)"==M.assignName&&(c="00");var u="/dashboard/lead-data-list?moduleId="+moduleId+"&leadFrom=LEAD&currentPage=0&euid="+ENCRYPTED_USER_ID+"&leadType=B2C",p="clickLeadsLink('"+u+"','"+t+"', '"+a+"','list-"+c+"','"+n+"', '"+s+"')",h="clickLeadsLink('"+u+"','"+t+"', '"+a+"','unique-"+c+"','"+n+"', '"+s+"')",m="clickLeadsLink('"+u+"','"+t+"', '"+a+"','duplicate-"+c+"','"+n+"', '"+s+"')",g="clickLeadsLink('"+u+"','"+t+"', '"+a+"','facebooklead-"+c+"','"+n+"', '"+s+"')",v="clickLeadsLink('"+u+"','"+t+"', '"+a+"','fblead-"+c+"','"+n+"', '"+s+"')",f="clickLeadsLink('"+u+"','"+t+"', '"+a+"','iglead-"+c+"','"+n+"', '"+s+"')",b="clickLeadsLink('"+u+"','"+t+"', '"+a+"','unattendedLead-"+c+"','"+n+"', '"+s+"')",y="clickLeadsLink('"+u+"','"+t+"', '"+a+"','demoLead-"+c+"','"+n+"', '"+s+"')",T="clickLeadsLink('"+u+"','"+t+"', '"+a+"','demodone-"+c+"','"+n+"', '"+s+"')",w="clickLeadsLink('"+u+"','"+t+"', '"+a+"','positiveLead-"+c+"','"+n+"', '"+s+"')",S="clickLeadsLink('"+u+"','"+t+"', '"+a+"','hottotal-"+c+"','"+n+"', '"+s+"')",L="clickLeadsLink('"+u+"','"+t+"', '"+a+"','warmtotal-"+c+"','"+n+"', '"+s+"')",D="clickLeadsLink('"+u+"','"+t+"', '"+a+"','coldtotal-"+c+"','"+n+"', '"+s+"')",C="clickLeadsLink('"+u+"','"+t+"', '"+a+"','reserved-"+c+"','"+n+"', '"+s+"')",x="clickLeadsLink('"+u+"','"+t+"', '"+a+"','enrolled-"+c+"','"+n+"', '"+s+"')";if("Country"!=o&&"Campaign"!=o||(l||(c=0,"Country"==o&&(n=M.assignTo),"Campaign"==o&&(s=M.assignTo)),p="clickLeadsLink('"+u+"','"+t+"', '"+a+"','list-"+c+"','"+n+"', '"+s+"')",h="clickLeadsLink('"+u+"','"+t+"', '"+a+"','unique-"+c+"','"+n+"', '"+s+"')",m="clickLeadsLink('"+u+"','"+t+"', '"+a+"','duplicate-"+c+"','"+n+"', '"+s+"')",g="clickLeadsLink('"+u+"','"+t+"', '"+a+"','facebooklead-"+c+"','"+n+"', '"+s+"')",v="clickLeadsLink('"+u+"','"+t+"', '"+a+"','fblead-"+c+"','"+n+"', '"+s+"')",f="clickLeadsLink('"+u+"','"+t+"', '"+a+"','iglead-"+c+"','"+n+"', '"+s+"')",b="clickLeadsLink('"+u+"','"+t+"', '"+a+"','unattendedLead-"+c+"','"+n+"', '"+s+"')",y="clickLeadsLink('"+u+"','"+t+"', '"+a+"','demoLead-"+c+"','"+n+"', '"+s+"')",T="clickLeadsLink('"+u+"','"+t+"', '"+a+"','demodone-"+c+"','"+n+"', '"+s+"')",w="clickLeadsLink('"+u+"','"+t+"', '"+a+"','positiveLead-"+c+"','"+n+"', '"+s+"')",S="clickLeadsLink('"+u+"','"+t+"', '"+a+"','hottotal-"+c+"','"+n+"', '"+s+"')",L="clickLeadsLink('"+u+"','"+t+"', '"+a+"','warmtotal-"+c+"','"+n+"', '"+s+"')",D="clickLeadsLink('"+u+"','"+t+"', '"+a+"','coldtotal-"+c+"','"+n+"', '"+s+"')",C="clickLeadsLink('"+u+"','"+t+"', '"+a+"','reserved-"+c+"','"+n+"', '"+s+"')",x="clickLeadsLink('"+u+"','"+t+"', '"+a+"','enrolled-"+c+"','"+n+"', '"+s+"')"),d+="<tr>",d+='<td class="text-center">'+i+++"</td>",d+='<td style="vertical-align: top !important;" class="text-left">'+M.assignName+"</td>",l){var O=M.totalLead-M.duplicateLeadCount;d+='<td style="vertical-align: top !important;background-color:#3f6ad8 !important;color:#fff;" class=""><span class="text-left"><a href="javascript:void(0);" class="text-white" onclick="'+p+'">'+M.totalLead+'</a></span>  <span class="float-right"><a href="javascript:void(0);" class="text-white" onclick="'+h+'">'+(O>0?O:0)+'</a>  |  <a href="javascript:void(0);" class="text-white" onclick="'+m+'">'+M.duplicateLeadCount+"</a></span></td>"}else{if("Country"==o||"Campaign"==o)d+='<td style="vertical-align: top !important;background-color:#3f6ad8 !important;color:#fff;" class="">'+getDropdownTable(M.assignTo,M.totalLead,M.duplicateLeadCount,p,h,m)+"</td>";else if("LOGS"!=o){O=M.totalLead-M.duplicateLeadCount;d+='<td style="vertical-align: top !important;background-color:#3f6ad8 !important;color:#fff;" class=""> ',d+="<div class='d-flex align-items-center'>",d+='<span class=\'d-flex\'><a href="javascript:void(0);" class="text-white" onclick="'+p+'">'+M.totalLead+"</a></span>",d+='<span class=\'d-inline-flex ml-auto\'><a href="javascript:void(0);" class="text-white" onclick="'+h+'">'+(O>0?O:0)+'</a> | <a href="javascript:void(0);" class="text-white" onclick="'+m+'">'+M.duplicateLeadCount+"</a></span></div></td>"}}if("LOGS"==o)d+=`<td style="vertical-align: top !important;" class="text-center"><button onClick="showZadarmaDetails('${M.zadarma}')" style="border: none; outline: none; cursor: pointer;" class="bg-success text-white text-center  badge font-12">${M.zadarmaCount}</button></td>`,d+=`<td style="vertical-align: top !important;" class="text-center"><button onClick="showWatiDetails('${M.wati}')" style="border: none; outline: none; cursor: pointer;" class="bg-warning text-white text-center badge font-12">${M.watiCount}</button></td>`,d+=`<td style="vertical-align: top !important;" class="text-center"><button onClick="showWhatsappDetails('${M.whatsappIds}')" style="border: none; outline: none; cursor: pointer;" class="bg-primary text-white text-center badge font-12">${M.whatsappCount}</button></td>`;else{d+='<td style="vertical-align: top !important;" class="text-center">',d+="<div class='d-flex align-items-center'>",d+='<span class=\'d-flex\'><a href="javascript:void(0);"  onclick="'+g+'">'+M.totalFbLead+"</a></span>",d+='<span class=\'d-inline-flex ml-auto\'><a href="javascript:void(0);"  onclick="'+v+'">'+M.fb_total+'</a> | <a href="javascript:void(0);"  onclick="'+f+'">'+M.ig_total+"</a></span>",d+="</div></td>",d+='<td style="vertical-align: top !important;" class="text-center"><a href="javascript:void(0);" onclick="'+b+'">'+M.unattended+"</a></td>",d+='<td style="vertical-align: top !important;background-color:#f3f39e !important;color:#343a40;" class="text-center"><span class="badge font-12"><a href="javascript:void(0);" onclick="'+y+'">'+M.totalDemo+'</a></span> | <span class="badge font-12"><a href="javascript:void(0);" onclick="'+T+'">'+M.totalDemoDone+"</a></span></td>",d+='<td style="vertical-align: top !important;" class="text-center"><span class="bg-success text-white text-center  badge font-12"><a href="javascript:void(0);" class="text-white" onclick="'+S+'">'+M.totalHot+'</a></span> | <span class="bg-warning text-white text-center badge font-12"><a href="javascript:void(0);" class="text-white" onclick="'+L+'">'+M.totalWarm+'</a></span> | <span class="bg-primary text-white text-center badge font-12"><a href="javascript:void(0);" class="text-white" onclick="'+D+'">'+M.totalCold+"</a></span></td>",d+='<td style="vertical-align: top !important;background-color:#efd597;" class="text-center"><a href="javascript:void(0);" onclick="'+w+'">'+M.positiveEnroll+"</a></td>",d+='<td style="vertical-align: top !important;" class="text-center"><a href="javascript:void(0);" onclick="'+C+'">'+M.reserved+"</a></td>",d+='<td style="vertical-align: top !important;background-color:#c4d38a;" class="text-center"><a href="javascript:void(0);" onclick="'+x+'">'+M.enrollment+"</a></td>",d+="</tr>";var k=0,I=0;"Country"!=o&&"Campaign"!=o||(k="Country"==o?M.assignTo:0,I="Campaign"==o?M.assignTo:0,l||callLeadCounselorsList("leadReportSearch",$("#searchLeadCounselorType").val(),t,a,"sublistCounselorTbody-"+M.assignTo,!0,k,I))}}else d+="<tr>",d+='<td colspan="12" class="text-center">No Record</td>',d+="</tr>";return d}function getLeadCounselorFootHtml(e,t){var a=e.leadListCounselor,o="",l=0,n=0,s=0,r=0,d=0,i=0,c=0,u=0,p=0,h=0,m=0,g=0,v=0,f=0;if(a.length>0)for(let e=0;e<a.length;e++){const t=a[e];l+=t.totalLead,m+=t.duplicateLeadCount,n+=t.totalFbLead,s+=t.totalDemo,r+=t.totalDemoDone,d+=t.totalHot,i+=t.totalCold,c+=t.totalWarm,u+=t.positiveEnroll,p+=t.reserved,h+=t.enrollment,g+=t.unattended,v+=t.fb_total,f+=t.ig_total}o+=t?'<tr style="font-size:14px;background-color: #c9def3 !important;">':'<tr style="font-size:11px;background-color: #c9def3 !important;">';var b=l-m;return o+='<th class="text-center"></th>',o+='<th style="vertical-align: top !important;" class="text-center">Total</th>',o+='<th style="vertical-align: top !important;" class=""><span class="text-left">'+l+'</span>  <span class="float-right">'+(b>0?b:0)+"  |  "+m+"</span></th>",o+='<th style="vertical-align: top !important;" class="text-center"><span class="text-left">'+n+'</span>  <span class="float-right">'+v+"  |  "+f+"</span></td>",o+='<th style="vertical-align: top !important;" class="text-center">'+g+"</td>",o+='<th style="vertical-align: top !important;" class="text-center">'+s+" | "+r+"</th>",o+='<th style="vertical-align: top !important;" class="text-center">'+d+" | "+c+" | "+i+"</th>",o+='<th style="vertical-align: top !important;" class="text-center">'+u+"</th>",o+='<th style="vertical-align: top !important;" class="text-center">'+p+"</th>",o+='<th style="vertical-align: top !important;" class="text-center">'+h+"</th>",o+="</tr>"}function getLogsFootHtml(e,t){var a=e.leadListCounselor,o="",l=0,n=0,s=0;if(a.length>0)for(let e=0;e<a.length;e++){const t=a[e];l+=t.zadarmaCount,n+=t.watiCount,s+=t.whatsappCount}return o+=t?'<tr style="font-size:14px;background-color: #c9def3 !important;">':'<tr style="font-size:11px;background-color: #c9def3 !important;">',o+='<th class="text-center"></th>',o+='<th style="vertical-align: top !important;" class="text-center">Total</th>',o+='<th style="vertical-align: top !important;" class="text-center">'+l+"</th>",o+='<th style="vertical-align: top !important;" class="text-center">'+n+"</th>",o+='<th style="vertical-align: top !important;" class="text-center">'+s+"</th>",o+="</tr>"}function getDropdownTable(e,t,a,o,l,n){var s="";return s+='<div class="dropdown full">',s+='<button type="button"  aria-haspopup="true" aria-expanded="false" data-toggle="dropdown" class="dropdown-toggle btn btn-sm full" style="width:100px;background-color:#3f6ad8 !important;color:#fff; padding:0px"><span class="float-left"><a href="javascript:void(0)" style="color:#fff !important" class="not-underline" onclick="'+o+'">'+t+'</a></span> <span class="float-right"><a href="javascript:void(0)" style="color:#fff !important" class="not-underline" onclick="'+l+'">'+(t-a)+'</a>  |  <a href="javascript:void(0)" style="color:#fff !important" class="not-underline" onclick="'+n+'">'+a+'</a><i class="fa fa-caret-down" ></i></span></button>',s+='<div tabindex="-1" role="menu" aria-hidden="true" class="dropdown-menu-lg dropdown-menu" x-placement="bottom-start" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 33px, 0px);">',s+='<table class="table table-bordered table-striped" id="sub-counselor-list-'+e+'" style="font-size:11px !important; width:1050px;" >',s+="<thead>",s+="<tr>",s+='<th style="5% !important" class="text-center bg-primary text-white">Sr no.</th>',s+='<th class="text-center bg-primary text-white">Academic Counselor</th>',s+='<th class="bg-primary text-white">Total Leads    U | D </th>',s+='<th class="bg-primary text-white">Total    FB | IG </th>',s+='<th class="text-center bg-primary text-white">Unattended</th>',s+='<th class="text-center bg-primary text-white">Demo Booked | Demo Done</th>',s+='<th class="text-center bg-primary text-white">Hot | Warm | Cold</th>',s+='<th class="text-center bg-primary text-white">Positive Enrollment</th>',s+='<th class="text-center bg-primary text-white">Reserved</th>',s+='<th class="text-center bg-primary text-white">Converted</th>',s+="</tr>",s+="</thead>",s+='<tbody id="sublistCounselorTbody-'+e+'"></tbody>',s+='<tfoot id="sublistCounselorTfoot-'+e+'"></tfoot></tbody>',s+="</table>",s+="</div>",s+="</div>"}function clickLeadsLink(e,t,a,o,l,n){getAsPost(e+"&startDate="+t+"&endDate="+a+"&country="+l+"&campaign="+n+"&clickFrom="+o)}function reportLeadSearchReset(e){$("#"+e+" #sourceSearch").val("").trigger("change"),$("#"+e+" #statusSearch").val("").trigger("change"),$("#"+e+" #gradeSearch").val("0").trigger("change"),$("#"+e+" #assignToSearch").val("").trigger("change"),$("#"+e+" #countryId").val("0").trigger("change"),$("#"+e+" #leadDemoAssign").val("").trigger("change"),$("#"+e+" #searchCampaign").val("").trigger("change")}function callOpenWatsAppMessage(e,t){$("#"+e).modal("show"),getLeadWatsAppchat(t)}function getLeadWatsAppchat(e){var t={};t.leadId=e,$.ajax({type:"POST",contentType:"application/json",url:getURLFor("leads","get-watsApp-chat"),data:JSON.stringify(t),dataType:"json",cache:!1,timeout:6e5,success:function(e){if("0"==e.status||"2"==e.status);else{var t=watsAppchatBoxHtml(e);$(".chatmessage").html(t)}return!1},error:function(e){return!1}})}function watsAppchatBoxHtml(e){var t=e.chatMobileList,a=e.chatPersonList,o="";if(o+='<div class="row">',o+='\t<div class="col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12 mb-2 mb-md-0 text-center text-md-left">',o+='\t\t<div class="app-inner-layout chat-layout card">',o+='\t\t<div class="app-inner-layout__wrapper">',o+='\t\t<div class="app-inner-layout__sidebar card">',o+='\t\t\t<div class="app-inner-layout__sidebar-header">',o+='\t\t\t\t<ul class="nav flex-column">',o+='\t\t\t\t\t<li class="nav-item-header nav-item">Chat With</li>',o+="\t\t\t\t</ul>",o+="\t\t\t</div>",o+='\t\t\t<ul class="nav flex-column">',a.length>0)for(var l=0;l<a.length;l++){var n=a[l];o+='\t\t\t\t<li class="nav-item">',o+=0==l?'\t\t\t\t\t<button type="button" tabindex="0" class="dropdown-item active">':'\t\t\t\t\t<button type="button" tabindex="0" class="dropdown-item">',o+='\t\t\t\t\t\t<div class="widget-content p-0">',o+='\t\t\t\t\t\t\t<div class="widget-content-wrapper">',o+='\t\t\t\t\t\t\t\t<div class="widget-content-left mr-3">',o+='\t\t\t\t\t\t\t\t\t<div class="avatar-icon-wrapper">',o+='\t\t\t\t\t\t\t\t\t\t<div class="badge badge-bottom badge-success badge-dot badge-dot-lg"></div>',o+='\t\t\t\t\t\t\t\t\t\t<div class="avatar-icon"><img src="'+n.profilePic+'" alt="" /></div>',o+="\t\t\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t\t\t</div>",o+='\t\t\t\t\t\t\t\t<div class="widget-content-left">',o+='\t\t\t\t\t\t\t\t\t<div class="widget-heading">'+n.chatPerson+"</div>",o+="\t\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t</div>",o+="\t\t\t\t\t</button>",o+="\t\t\t\t</li>"}else o+='\t\t\t\t<li class="nav-item">',o+='\t\t\t\t\t<button type="button" tabindex="0" class="dropdown-item">',o+='\t\t\t\t\t\t<div class="widget-content p-0">',o+='\t\t\t\t\t\t\t<div class="widget-content-wrapper">',o+='\t\t\t\t\t\t\t\t<div class="widget-content-left mr-3">',o+='\t\t\t\t\t\t\t\t\t<div class="avatar-icon-wrapper">',o+='\t\t\t\t\t\t\t\t\t\t<div class="badge badge-bottom badge-success badge-dot badge-dot-lg"></div>',o+='\t\t\t\t\t\t\t\t\t\t<div class="avatar-icon"><img src="'+e.profilePic+'" alt="" /></div>',o+="\t\t\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t\t\t</div>",o+='\t\t\t\t\t\t\t\t<div class="widget-content-left">',o+='\t\t\t\t\t\t\t\t\t<div class="widget-heading">No Chat person</div>',o+="\t\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t</div>",o+="\t\t\t\t\t</button>",o+="\t\t\t\t</li>";if(o+="\t\t\t</ul>",o+="\t\t</div>",o+="\t</div>",o+="\t</div>",o+="\t</div>",o+='\t<div class="col-xl-9 col-lg-9 col-md-6 col-sm-12 col-12 mb-2 mb-md-0">',o+='\t\t<div class="app-inner-layout chat-layout card">',o+='\t\t<div class="app-inner-layout__wrapper">',o+='\t\t<div class="app-inner-layout__content ">',o+='\t\t\t<div class="table-responsive">',o+='\t\t\t\t<div class="app-inner-layout__top-pane">',o+='\t\t\t\t\t<div class="pane-left">',o+='\t\t\t\t\t\t<div class="mobile-app-menu-btn">',o+='\t\t\t\t\t\t\t<button type="button" class="hamburger hamburger--elastic">',o+='\t\t\t\t\t\t<span class="hamburger-box">',o+='\t\t\t\t\t\t\t<span class="hamburger-inner"></span>',o+="\t\t\t\t\t\t</span>",o+="\t\t\t\t\t\t\t</button>",o+="\t\t\t\t\t\t</div>",o+='\t\t\t\t\t\t<div class="avatar-icon-wrapper mr-2">',o+='\t\t\t\t\t\t\t<div class="badge badge-bottom btn-shine badge-success badge-dot badge-dot-lg"></div>',o+='\t\t\t\t\t\t\t<div class="avatar-icon avatar-icon-xl rounded"><img width="82" src="'+e.profilePic+'" alt=""></div>',o+="\t\t\t\t\t\t</div>",o+='\t\t\t\t\t\t<h4 class="mb-0 text-nowrap">'+e.leadPersonName+' <div class="opacity-7">Last Chat time: <span class="opacity-8">'+(""!=e.lastChatTime?e.lastChatTime:"N/A")+"</span></div></h4>",o+="\t\t\t\t\t</div>",o+="\t\t\t\t</div>",o+='\t\t\t\t<div class="chat-wrapper">',""!=t&&t.length>0)for(var s=0;s<t.length;s++){var r=t[s];""!=r.message&&("OUTGOING"==r.direction?(o+='\t\t\t\t\t<div class="chat-box-wrapper py-1">',o+="\t\t\t\t\t\t<div>",o+='\t\t\t\t\t\t\t<div class="avatar-icon-wrapper mr-1">',o+='\t\t\t\t\t\t\t\t<div class="badge badge-bottom btn-shine badge-success badge-dot badge-dot-lg"></div>',o+='\t\t\t\t\t\t\t\t<div class="avatar-icon avatar-icon-lg rounded"><img src="'+r.profilePic+'" alt="" /></div>',o+="\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t<div>",o+='\t\t\t\t\t\t\t<div class="chat-box">'+r.message+"</div>",o+='\t\t\t\t\t\t\t<small class="opacity-6"><i class="fa fa-calendar-alt mr-1"></i>'+r.displayDate+" | "+r.chatPerson+" | "+r.c_phone_no+"</small>",o+="\t\t\t\t\t\t</div>",o+="\t\t\t\t\t</div>"):(o+='\t\t\t\t\t<div class="float-right w-100">',o+='\t\t\t\t\t\t<div class="chat-box-wrapper py-1 chat-box-wrapper-right justify-content-end">',o+="\t\t\t\t\t\t\t<div>",o+='\t\t\t\t\t\t\t\t<div class="chat-box">'+r.message+"</div>",o+='\t\t\t\t\t\t\t\t<small class="opacity-6"><i class="fa fa-calendar-alt mr-1"></i> '+r.displayDate+" | "+e.leadPersonName+" | "+r.mobileno+"</small>",o+="\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t\t<div>",o+='\t\t\t\t\t\t\t\t<div class="avatar-icon-wrapper ml-1">',o+='\t\t\t\t\t\t\t\t\t<div class="badge badge-bottom btn-shine badge-success badge-dot badge-dot-lg"></div>',o+='\t\t\t\t\t\t\t\t\t<div class="avatar-icon avatar-icon-lg rounded"><img src="'+r.profilePic+'" alt="" /></div>',o+="\t\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t\t</div>",o+="\t\t\t\t\t\t</div>",o+="\t\t\t\t\t</div>"))}else o+='\t\t\t\t\t<div class="chat-box-wrapper">',o+='<div class="chat-box">No Message</div>',o+="\t\t\t\t</div>";return o+="\t\t\t\t</div>",o+="\t\t\t</div>",o+="\t\t</div>",o+="\t\t</div>",o+="\t\t</div>",o+="\t</div>",o+="</div>"}function hideEmail(e){let[t,a]=e.split("@");return t.slice(0,2)+"*".repeat(t.length-2)+t.slice(t.length-2,t.length)+"@"+a}function getZadarmaLogs(e){$.ajax({type:"GET",url:BASE_URL+CONTEXT_PATH+`zadarma/v1/get-logs?number=${e}`,dataType:"json",success:function(e){if("success"==e.status){let t=zadarmaLogsDataModal(e.logs);$("#zadarmaLogsContent").length>0&&$("#zadarmaLogsContent").remove(),$("body").append(t),$("#zadarmaLogsContent").modal("show")}else showMessageTheme2(0,e.message)},error:function(e,t,a){console.error("Error fetching logs:",a)}})}function removeRecordingModel(e){$(".modal-backdrop").remove(),$("#"+e).remove()}function viewCallRecording(e){let t="callRecordingModal";$("#"+t).remove();let a=`\n        <div id="${t}" class="modal fade bd-example-modal-lg fade-scale" tabindex="-1" role="dialog" aria-labelledby="callRecordingLabel" aria-hidden="true">\n            <div class="modal-dialog modal-lg">\n                <div class="modal-content border-0">\n                    <div class="modal-header bg-primary text-white">\n                        <h5 class="modal-title font-weight-bold">Call Recording</h5>\n                        <button type="button" onClick="removeRecordingModel('${t}')" class="close text-white" data-dismiss="modal">\n                            <span aria-hidden="true">&times;</span>\n                        </button>\n                    </div>\n                    <div class="modal-body text-center">\n                        <p>Click play to listen to the recording.</p>\n                        <audio controls class="w-100">\n                            <source src="${e}" type="audio/mpeg">\n                            Your browser does not support the audio element.\n                        </audio>\n                    </div>\n                </div>\n            </div>\n        </div>`;$("body").append(a),$("#"+t).modal("show")}function getNum(e,t,a){var o=$(e).val();t="P"==$("#"+a).val()?100:1e3,(isNaN(o)||o>t)&&showMessageTheme2(0,"Invalid Amount")}var ZadarmaOrWati=null,currentPageZadarma=1,currentZadarmaIds=null;function showZadarmaDetails(e){var t={ids:e,pageNo:currentPageZadarma,pageCount:10};$.ajax({url:BASE_URL+CONTEXT_PATH+"zadarma/v1/get-logs-by-ids",type:"POST",data:JSON.stringify(t),contentType:"application/json",success:function(t){try{0===t.statusCode?(ZadarmaOrWati="zadarma",currentZadarmaIds!=e?(zadarmaData=[...t.logs,...t.unMatchLogs],populateZadarmaRecords(t.logs,t.unMatchLogs,"Zadarma Logs",t.totalPages,e.split(",").length)):(zadarmaData=[...t.logs,...t.unMatchLogs],renderZadarmaTable(t.logs,t.totalPages,e.split(",").length,[...new Set(t.logs.map(((e,t)=>e.callId))),...new Set(t.unMatchLogs.map(((e,t)=>e.callId)))].length),renderUnMatchZadarmaTable(t.unMatchLogs)),currentZadarmaIds=e):"3"===t.status?redirectLoginPage():showMessageTheme2(0,t.message)}catch(e){console.log("Error Fetching Data:",e)}}})}var currentPageWati=1,currentWatiIds=null;function showWatiDetails(e){var t={ids:e,pageNo:currentPageWati,pageCount:10};$.ajax({url:BASE_URL+CONTEXT_PATH+"wati/api/get-wati-Log",type:"POST",data:JSON.stringify(t),contentType:"application/json",success:function(t){try{0===t.statusCode?(ZadarmaOrWati="wati",currentWatiIds!=e?(watiData=t.data,populateWatiRecords(t.data,t.unMatchData,"Wati Logs",t.totalPages,e.split(",").length)):(watiData=t.data,renderWatiTable(t.data,t.totalPages,e.split(",").length,t.data.map(((e,t)=>e.leadNo)).length)),currentWatiIds=e):showMessageTheme2(0,t.message)}catch(e){console.log("Error Fetching Data:",e)}}})}var currentPageWhatsapp=1,currentWhatsappIds=null;function showWhatsappDetails(e){var t=$("#counselorStartDate").val(),a=$("#counselorEndDate").val();""==$("#counselorStartDate").val()&&null==$("#counselorStartDate").val()&&(t=""),""==$("#counselorEndDate").val()&&null==$("#counselorEndDate").val()&&(a="");var o={ids:e,pageNo:currentPageWhatsapp,pageCount:10,searchDateType:$("#searchLeadCounselorType").val(),startDate:t,endDate:a};$.ajax({url:BASE_URL+CONTEXT_PATH+"/international-schooling/api/v1/leads/get-watsApp-chat-by-lead-ids",type:"POST",data:JSON.stringify(o),contentType:"application/json",success:function(t){try{0===t.statusCode?(ZadarmaOrWati="whatsapp",currentWhatsappIds!=e?(whatsappData=t.data,populateWhatsappRecords(t.data,t.unMatchData,"Whatsapp Messages",t.totalPages,e.split(",").length)):(whatsappData=t.data,renderWhatsappTable(t.data,t.totalPages,e.split(",").length)),currentWhatsappIds=e):showMessageTheme2(0,t.message)}catch(e){console.log("Error Fetching Data:",e)}}})}function getFilterLeadNo(e){e=e.trim().toLowerCase(),$("#zadarmaLogModalTableBody tr").each((function(){var t=$(this).find("td:nth-child(2)").text().trim().toLowerCase();""===e||t.includes(e)?$(this).show():$(this).hide()}))}let zadarmaData=[];function getFilterZadarmaLeadNo(e,t){e=e.trim().toLowerCase();renderZadarmaTable(zadarmaData.filter((t=>t.leadNo.toLowerCase().includes(e))),t,currentZadarmaIds.split(",").length,[...new Set(zadarmaData.map(((e,t)=>e.callId)))].length),""!=e?$(".pagination").hide():$(".pagination").show()}function populateZadarmaRecords(e,t,a,o,l){$("<style>").prop("type","text/css").html("\n\t\t.recurring-modal-backdrop {\n\t\t  position: fixed;\n\t\t  top: 0;\n\t\t  left: 0;\n\t\t  width: 100%;\n\t\t  height: 100%;\n\t\t  background: rgba(0, 0, 0, 0.5);\n\t\t  display: none;\n\t\t  z-index: 999;\n\t\t}\n  \n\t\t.recurring-modal {\n\t\t  position: fixed;\n\t\t  top: 0;\n\t\t  right: -90%;\n\t\t  width: 90%;\n\t\t  height: 100vh;\n\t\t  background: white;\n\t\t  box-shadow: -2px 0px 10px rgba(0, 0, 0, 0.2);\n\t\t  transition: right 0.3s ease-in-out;\n\t\t  z-index: 1000;\n\t\t}\n  \n\t\t.recurring-modal.open {\n\t\t  right: 0;\n\t\t}\n  \n\t\t.modal-header {\n\t\t  display: flex;\n\t\t  justify-content: space-between;\n\t\t  align-items: center;\n\t\t  padding: 15px;\n\t\t  background: #007bff;\n\t\t  color: white;\n\t\t}\n  \n\t\t.modal-body {\n\t\t  padding: 20px;\n\t\t}\n  \n\t\t.session-block {\n\t\t  margin-bottom: 15px;\n\t\t  border-bottom: 1px solid #ddd;\n\t\t  padding-bottom: 10px;\n\t\t}\n  \n\t\t.close-btn {\n\t\t  background: transparent;\n\t\t  border: none;\n\t\t  font-size: 24px;\n\t\t  color: white;\n\t\t  cursor: pointer;\n\t\t}\n  \n\t\t.play-btn {\n\t\t  background: #007bff;\n\t\t  color: white;\n\t\t  border: none;\n\t\t  padding: 5px 10px;\n\t\t  cursor: pointer;\n\t\t  border-radius: 5px;\n\t\t}\n  \n\t\t.play-btn:hover {\n\t\t  background: #0056b3;\n\t\t}\n  \n\t\t.accordion-btn {\n\t\t  background: #D7EBFF;\n\t\t  padding: 5px 10px;\n\t\t  width: 100%;\n\t\t  text-align: left;\n\t\t  cursor: pointer;\n\t\t  font-weight: bold;\n\t\t  border-radius: 5px;\n\t\t  \n\t\t}\n  \n\t\t.accordion-btn:focus {\n\t\t  outline: 0px !important;\n\t\t}\n  \n\t\t.recording-list {\n\t\t  padding: 10px;\n\t\t  background: #fff;\n\t\t  border-radius: 5px;\n\t\t}\n\t  ").appendTo("head");var n=`\n\t  <div id="zadarmaLogBackdrop" class="recurring-modal-backdrop" onclick="closeZadarmaModal();"></div>\n\t  <div id="zadarmaLogModal" class="recurring-modal">\n\t\t<div class="p-3" style="background-color:#027FFF;">\n\t\t  <h5 class="mb-0" style="color: white;font-size:18px;font-weight: 700;">${a}</h5>\n\t\t   <button onclick="closeZadarmaModal();" type="button" class="p-2 cursor" data-dismiss="modal" aria-label="Close" style="position: absolute;left:-30px;top:35px;background-color: white !important;border-radius: 5px 0px 0px 5px;font-size: 35px;border:0px;color:#000;">\n\t\t\t<span aria-hidden="true">&times;</span>\n\t\t  </button>\n\t\t</div>\n\t\t<div class="p-3" style="width:300px; margin-left:auto;">\n\t\t\t<input placeholder="Search" type="text" onchange="getFilterZadarmaLeadNo(this.value, ${o})" class="form-control">\n\t\t</div>\n\t\t<div style="background-color: #fff; height: 100vh;">\n\t\t  <div class="px-5" style="height: 80vh;overflow-y:auto;">\n\t\t\t<table id="recurring-recordings-table" class="w-100 table table-bordered border-radius-table">\n\t\t\t  <thead style="position: sticky;top: 0;z-index: 1;">\n\t\t\t\t<tr style="font-size: 14px;">\n\t\t\t\t\t<th class="p-2 rounded-top-left-10 border-right-0 border-primary" style="background-color:rgb(200, 224, 247); font-weight: normal; color:rgb(38, 146, 253)">Lead No</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Caller</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Dailed No</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Type</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Call Start</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Duration (in sec)</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Status</th>\n\t\t\t\t  <th class="p-2 rounded-top-right-10 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Action</th>\n\t\t\t\t</tr>\n\t\t\t  </thead>\n\t\t\t  <tbody id="zadarmaLogModalTableBody"></tbody>\n\t\t\t</table>\n\t\t\t<div id="unMatchZadarmaTable"></div>\n\t\t\t<div id="zadarmaPagination"></div>\n\t\t  </div>\n\t\t</div>\n\t  </div>\n\t`;$("body").append(n),$("#zadarmaPagination").html(renderPagination(currentPageZadarma,o,l,[...new Set(e.map(((e,t)=>e.callId))),...new Set(t.map(((e,t)=>e.callId)))].length)),renderZadarmaTable(e,o,l,[...new Set(e.map(((e,t)=>e.callId))),...new Set(t.map(((e,t)=>e.callId)))].length),renderUnMatchZadarmaTable(t),setTimeout((()=>{$("#zadarmaLogBackdrop").fadeIn(200),$("#zadarmaLogModal").addClass("open"),$("body").css("overflow","hidden")}),50)}function renderZadarmaTable(e,t,a,o){$("#zadarmaPagination").html(renderPagination(currentPageZadarma,t,a,o));const l=e.reduce(((e,t)=>{const a=t.leadNo;return e[a]=e[a]||[],e[a].push(t),e}),{});let n="";$.each(Object.entries(l),(function(e,t){let a=10*(currentPageZadarma-1)+e+1;1===t[1].length?n+=`<tr id="row_id_${a}">\n\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].leadNo}</td>\n\t\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].caller}</td>\n\t\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].dialledNumber}</td>\n\t\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${"O"===t[1][0].type?"Outgoing":"Incoming"}</td>\n\t\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${changeDateFormat(new Date(t[1][0].callStart.slice(0,19)),"mm-dd-yyyy")} | ${t[1][0].callStart.slice(10,16)}</td>\n\t\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].seconds}</td>\n\t\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].status}</td>\n\t\t\t\t<td class="py-2 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">\n\t\t\t\t\t${""===t[1][0].recordings?"N/A":`<button onClick="viewCallRecording('${t[1][0].recordings}')" class="bg-primary text-white text-center" style="cursor:pointer; border:none; border-radius:4px">Play Recording</button>`}\n\t\t\t\t</td>\n\t\t\t</tr>`:(n+=`<tr id="row_id_${a}" style="border-top-left-radius: 10px; border-bottom-left-radius: 10px; border-bottom: 0; border-color: blue">\n\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[0]}</td>\n\t\t\t\t<td colspan="7" class="py-2 pl-0 pr-2 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">\n\t\t\t\t<table class="w-100 table mb-0 border">\n\t\t\t\t\t<thead style="background-color:#f2f2f2;">\n\t\t\t\t\t\t<tr style="font-size:12px">\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Caller</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Dailed No.</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Type</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Call Start</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Duration (in sec)</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Status</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0 cursor" onclick="toggleSelfTable('row_id_${a}')">\n\t\t\t\t\t\t\t\tRecordiing List \n\t\t\t\t\t\t\t\t<span class="d-inline-block float-right " >\n\t\t\t\t\t\t\t\t\t<i id="row_id_${a}_icon" class="fa fa-angle-up"></i>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody id="row_id_${a}_body">`,$.each(t[1],(function(e,t){n+=`<tr>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${t.caller}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${t.dialledNumber}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${"O"===t.type?"Outgoing":"Incoming"}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${changeDateFormat(new Date(t.callStart.slice(0,19)),"mm-dd-yyyy")} | ${t.callStart.slice(10,16)}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${t.seconds}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${t.status}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">\n\t\t\t\t\t\t\t\t\t${""===t.recordings?"N/A":`<button onClick="viewCallRecording('${t.recordings}')" class="bg-primary text-white text-center" style="cursor:pointer; border:none; border-radius:4px">Play Recording</button>`}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>`})),n+="</tbody>\n\t\t\t\t</table>\n\t\t\t</tr>")})),$("#zadarmaLogModalTableBody").html(n),e&&0!==e.length||$("#zadarmaLogModalTableBody").html('<tr><td colspan="9" class="text-center py-5" style="font-size: 16px;font-weight: 700;">No recordings found</td></tr>')}function renderUnMatchZadarmaTable(e){let t="";e.length>0&&(t+='<h1 style="color:#f79797; font-size:14px">No lead number found for these calls.</h1>',t+='<table class="w-100 table mb-0 border border-color-#ff1414 mb-4">\n\t\t\t\t\t<thead style="background-color:#f79797;">\n\t\t\t\t\t\t<tr style="font-size:12px">\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Caller</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Dailed No.</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Type</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Call Start</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Duration (in sec)</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Status</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0" >\n\t\t\t\t\t\t\t\tRecording \n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody >',$.each(e,(function(e,a){t+=`<tr>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${a.caller}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${a.dialledNumber}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${"O"===a.type?"Outgoing":"Incoming"}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${changeDateFormat(new Date(a.callStart.slice(0,19)),"mm-dd-yyyy")} | ${a.callStart.slice(10,16)}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${a.seconds}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${a.status}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">\n\t\t\t\t\t\t\t\t\t${""===a.recordings?"N/A":`<button onClick="viewCallRecording('${a.recordings}')" class="bg-primary text-white text-center" style="cursor:pointer; border:none; border-radius:4px">Play Recording</button>`}\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>`})),t+="</tbody>\n\t\t\t\t</table>"),$("#unMatchZadarmaTable").html(t)}function closeZadarmaModal(){$("#zadarmaLogModal").removeClass("open"),$("#zadarmaLogBackdrop").fadeOut(200),setTimeout((()=>{$("#zadarmaLogModal").remove(),$("#zadarmaLogBackdrop").remove(),$("body").css("overflow","auto")}),300),currentPageZadarma=1,currentZadarmaIds=""}let watiData=[];function getFilterWatiLeadNo(e,t){e=e.trim().toLowerCase();renderWatiTable(watiData.filter((t=>t.leadNo.toLowerCase().includes(e))),t,currentWatiIds.split(",").length,watiData.map(((e,t)=>e.leadNo)).length),""!=e?$(".pagination").hide():$(".pagination").show()}function populateWatiRecords(e,t,a,o,l){$("<style>").prop("type","text/css").html("\n\t\t.recurring-modal-backdrop {\n\t\t  position: fixed;\n\t\t  top: 0;\n\t\t  left: 0;\n\t\t  width: 100%;\n\t\t  height: 100%;\n\t\t  background: rgba(0, 0, 0, 0.5);\n\t\t  display: none;\n\t\t  z-index: 999;\n\t\t}\n  \n\t\t.recurring-modal {\n\t\t  position: fixed;\n\t\t  top: 0;\n\t\t  right: -90%;\n\t\t  width: 90%;\n\t\t  height: 100vh;\n\t\t  background: white;\n\t\t  box-shadow: -2px 0px 10px rgba(0, 0, 0, 0.2);\n\t\t  transition: right 0.3s ease-in-out;\n\t\t  z-index: 1000;\n\t\t}\n  \n\t\t.recurring-modal.open {\n\t\t  right: 0;\n\t\t}\n  \n\t\t.modal-header {\n\t\t  display: flex;\n\t\t  justify-content: space-between;\n\t\t  align-items: center;\n\t\t  padding: 15px;\n\t\t  background: #007bff;\n\t\t  color: white;\n\t\t}\n  \n\t\t.modal-body {\n\t\t  padding: 20px;\n\t\t}\n  \n\t\t.session-block {\n\t\t  margin-bottom: 15px;\n\t\t  border-bottom: 1px solid #ddd;\n\t\t  padding-bottom: 10px;\n\t\t}\n  \n\t\t.close-btn {\n\t\t  background: transparent;\n\t\t  border: none;\n\t\t  font-size: 24px;\n\t\t  color: white;\n\t\t  cursor: pointer;\n\t\t}\n  \n\t\t.play-btn {\n\t\t  background: #007bff;\n\t\t  color: white;\n\t\t  border: none;\n\t\t  padding: 5px 10px;\n\t\t  cursor: pointer;\n\t\t  border-radius: 5px;\n\t\t}\n  \n\t\t.play-btn:hover {\n\t\t  background: #0056b3;\n\t\t}\n  \n\t\t.accordion-btn {\n\t\t  background: #D7EBFF;\n\t\t  padding: 5px 10px;\n\t\t  width: 100%;\n\t\t  text-align: left;\n\t\t  cursor: pointer;\n\t\t  font-weight: bold;\n\t\t  border-radius: 5px;\n\t\t  \n\t\t}\n  \n\t\t.accordion-btn:focus {\n\t\t  outline: 0px !important;\n\t\t}\n  \n\t\t.recording-list {\n\t\t  padding: 10px;\n\t\t  background: #fff;\n\t\t  border-radius: 5px;\n\t\t}\n\t  ").appendTo("head");var n=`\n\t  <div id="watiLogBackdrop" class="recurring-modal-backdrop" onclick="closeWatiModal();"></div>\n\t  <div id="watiLogModal" class="recurring-modal">\n\t\t<div class="p-3" style="background-color:#027FFF;">\n\t\t  <h5 class="mb-0" style="color: white;font-size:18px;font-weight: 700;">${a}</h5>\n\t\t   <button onclick="closeWatiModal();" type="button" class="p-2 cursor" data-dismiss="modal" aria-label="Close" style="position: absolute;left:-30px;top:35px;background-color: white !important;border-radius: 5px 0px 0px 5px;font-size: 35px;border:0px;color:#000;">\n\t\t\t<span aria-hidden="true">&times;</span>\n\t\t  </button>\n\t\t</div>\n\t\t<div class="p-3" style="width:300px; margin-left:auto;">\n\t\t\t<input placeholder="Search" type="text" onchange="getFilterWatiLeadNo(this.value, ${o});" class="form-control">\n\t\t</div>\n\t\t<div style="background-color: #fff; height: 100vh;">\n\t\t  <div class="px-5" style="height: 80vh;overflow-y:auto;">\n\t\t\t<table id="recurring-recordings-table"  class="w-100 table border-radius-table>\n\t\t\t  <thead style="position: sticky;top: 0;z-index: 1;">\n\t\t\t\t<tr style="font-size: 14px;">\n\t\t\t\t  <th class="p-2 rounded-top-left-10 border-right-0 border-left-0 border-top-0 border-primary" style="background-color:rgb(200, 224, 247); font-weight: normal; color:rgb(38, 146, 253)">Lead No</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-top-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253); width:300px; max-width:300px;" >Name</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-top-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253); width:200px; max-width:200px;">Delivered Date Time</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-top-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253); width:125px; max-width:125px;">Direction</th>\n\t\t\t\t  <th class="p-2 border-right-0 border-top-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253); width:200px; max-width:200px;">Wati Contact No</th>\n\t\t\t\t  <th class="p-2 rounded-top-right-10 border-left-0 border-right-0 border-top-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253);  width:80px; max-width:80px;">Action</th>\n\t\t\t\t</tr>\n\t\t\t  </thead>\n\t\t\t  <tbody id="watiLogModalTableBody"></tbody>\n\t\t\t</table>\n\t\t\t<div id="unMatchWatiTable"></div>\n\t\t\t<div id="watiLogsPagination"></div>\n\t\t  </div>\n\t\t</div>\n\t  </div>`;($("#watiLogBackdrop").length>0||$("#watiLogModal").length>0)&&($("#watiLogBackdrop").remove(),$("#watiLogModal").remove()),$("body").append(n),e&&0!==e.length||$("#watiLogModalTableBody").html('<tr><td colspan="3" class="text-center py-5" style="font-size: 16px;font-weight: 700;">No recordings found</td></tr>'),$("#watiLogsPagination").html(renderPagination(currentPageWati,o,l,e.map(((e,t)=>e.leadNo)).length)),renderWatiTable(e,o,l,e.map(((e,t)=>e.leadNo)).length),setTimeout((()=>{$("#watiLogBackdrop").fadeIn(200),$("#watiLogModal").addClass("open"),$("body").css("overflow","hidden")}),50)}function renderWatiTable(e,t,a,o){$("#watiLogsPagination").html(renderPagination(currentPageWati,t,a,o));const l=e.reduce(((e,t)=>{const a=t.leadNo;return e[a]=e[a]||[],e[a].push(t),e}),{});let n="";$.each(Object.entries(l),(function(e,t){let a=10*(currentPageWati-1)+e+1;1===t[1].length?n+=`\n\t\t\t<tr id="row_id_wati_${a}" style="border-top-left-radius: 10px;border-bottom-left-radius: 10px; border-bottom: 0; border-color:blue">\n\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].leadNo}</td>\n\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${""==t[1][0].operaterName?"User":t[1][0].operaterName}</td>\n\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${changeDateFormat(convertTZ(new Date(t[1][0].created),USER_TIMEZONE),"mm-dd-yyyy")} | ${changeDateFormat(convertTZ(new Date(t[1][0].created),USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss").slice(10,16)}</td>\n\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${"true"===t[1][0].owner?"Outgoing":"Incoming"}</td>\n\t\t\t<td class="py-2 border-right-0 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].watiNumber}</td>\n\t\t\t<td class="py-2 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">\n\t\t\t\t<button onClick="showWatiMessages(${JSON.stringify(t[1][0]).replace(/"/g,"&quot;")});" class="bg-primary text-white text-center " style="border:none;border-radius:4px;cursor:pointer;">View</button>\n\t\t\t</td>\n\t\t\t</tr>`:(n+=`<tr id="row_id_${a}" style="border-top-left-radius: 10px; border-bottom-left-radius: 10px; border-bottom: 0; border-color: blue">\n\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[0]}</td>\n\t\t\t\t<td colspan="5" class="py-2 px-2 border-left-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">\n\t\t\t\t<table class="w-100 table mb-0 border">\n\t\t\t\t\t<thead style="background-color:#f2f2f2;">\n\t\t\t\t\t\t<tr style="font-size:12px">\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Name</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Delivered Date Time</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Direction</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Wati Contact No</th>\n\t\t\t\t\t\t\t<th class="py-1 px-2 font-weight-bold text-dark border-0">Action</th>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</thead>\n\t\t\t\t\t<tbody id="row_id_wati_${a}_body">`,$.each(t[1].sort(((e,t)=>parseFloat(new Date(e.created).getTime())-parseFloat(new Date(t.created).getTime()))),(function(e,t){n+=`<tr style="border-top-left-radius: 10px;border-bottom-left-radius: 10px; border-bottom: 0; border-color:blue">\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${""==t.operaterName?"User":t.operaterName}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${changeDateFormat(convertTZ(new Date(t.created),USER_TIMEZONE),"mm-dd-yyyy")} | ${changeDateFormat(convertTZ(new Date(t.created),USER_TIMEZONE),"yyyy-mm-dd hh:mm:ss").slice(10,16)}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${"true"===t.owner?"Outgoing":"Incoming"}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">${t.watiNumber}</td>\n\t\t\t\t\t\t\t\t<td class="py-1 px-2 font-weight-light" style="font-size:13px;background-color:#fff; border-right: 0; border-left: 0px;">\n\t\t\t\t\t\t\t\t\t<button onClick="showWatiMessages(${JSON.stringify(t).replace(/"/g,"&quot;")});" class="bg-primary text-white text-center " style="border:none;border-radius:4px;cursor:pointer;">View</button>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>`})),n+="</tbody>\n\t\t\t\t</table>\n\t\t\t</tr>")})),$("#watiLogModalTableBody").html(n),e&&0!==e.length||$("#watiLogModalTableBody").html('<tr><td colspan="7" class="text-center py-5" style="font-size: 16px;font-weight: 700;">No recordings found</td></tr>')}function closeWatiModal(){setTimeout((()=>{$("#watiLogModal").remove(),$("#watiLogBackdrop").remove(),$("body").css("overflow","auto")}),300),currentPageWati=1,currentWatiIds=""}function showWatiMessages(e){$("#watiLogsContent").length>0&&$("#watiLogsContent").remove(),$("body").append(whatsappChatUI(e)),$("#watiLogsTableData").DataTable({theme:"bootstrap4"}),$("#watiLogsContent").modal("show")}function whatsappChatUI(e){const t=[JSON.parse(JSON.stringify(e))].filter((e=>"message"===e.eventType||"broadcastMessage"===e.eventType)).sort(((e,t)=>parseFloat(convertTZ(new Date(e.created),USER_TIMEZONE).getTime())-parseFloat(convertTZ(new Date(e.created),USER_TIMEZONE).getTime())));let a='\n        <style>\n            .whatsapp-container {\n                max-width: 800px;\n                margin: 20px auto;\n                background: #e5ddd5;\n                border-radius: 15px;\n                box-shadow: 0 0 20px rgba(0,0,0,0.1);\n                font-family: \'Segoe UI\', sans-serif;\n                overflow: hidden;\n                position: relative;\n            }\n\n            .chat-header {\n                background: linear-gradient(45deg, #075e54, #128c7e);\n                color: white;\n                padding: 15px 20px;\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                border-bottom: 1px solid rgba(255,255,255,0.1);\n            }\n\n\t\t\t.hide {\n\t\t\t\tdisplay: none\n\t\t\t}\n\n            .chat-header h3 {\n                margin: 0;\n                font-size: 1.2em;\n            }\n\n            .chat-header small {\n                opacity: 0.8;\n                font-size: 0.9em;\n            }\n\n            .chat-body {\n                padding: 20px;\n                height: 500px;\n                overflow-y: auto;\n                background: url(\'https://i.pinimg.com/736x/8c/98/99/8c98994518b575bfd8c949e91d20548b.jpg\');\n                background-size: contain;\n            }\n\n            .message {\n                max-width: 100%;\n                margin-bottom: 15px;\n                display: flex;\n                animation: slideIn 0.3s ease;\n            }\n\n            .message.sent {\n                justify-content: flex-end;\n            }\n\n            .message.received {\n                justify-content: flex-start;\n            }\n\n            .message-bubble {\n\t\t\t\tmax-width: 70%;\n                padding: 12px 18px;\n                border-radius: 10px;\n                position: relative;\n                box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n                word-wrap: break-word;\n            }\n\n            .sent .message-bubble {\n                background: #dcf8c6;\n                border-bottom-right-radius: 2px;\n            }\n\n            .received .message-bubble {\n                background: white;\n                border-bottom-left-radius: 2px;\n            }\n\n            .message-time {\n                font-size: 0.7em;\n                color: #666;\n                margin-top: 5px;\n                text-align: right;\n            }\n            .message-name {\n                font-size: 0.7em;\n                color: #666;\n                margin-top: 2px;\n                text-align: right;\n            }\n\n            .message-bubble::after {\n                content: \'\';\n                position: absolute;\n                width: 10px;\n                height: 10px;\n                bottom: 0;\n            }\n\n            .sent .message-bubble::after {\n                right: -10px;\n                background: #dcf8c6;\n                clip-path: polygon(0 100%, 100% 0, 100% 100%);\n            }\n\n            .received .message-bubble::after {\n                left: -10px;\n                background: white;\n                clip-path: polygon(0 0, 100% 100%, 0 100%);\n            }\n\n            .status-indicator {\n                font-size: 0.8em;\n                color: #666;\n                margin-left: 5px;\n            }\n\n            .status-indicator.read {\n                color: #34b7f1;\n            }\n\n            .close-btn {\n                background: none;\n                border: none;\n                color: white;\n                font-size: 1.5em;\n                cursor: pointer;\n                opacity: 0.8;\n            }\n\n            .close-btn:hover {\n                opacity: 1;\n            }\n\n            @keyframes slideIn {\n                from {\n                    opacity: 0;\n                    transform: translateY(20px);\n                }\n                to {\n                    opacity: 1;\n                    transform: translateY(0);\n                }\n            }\n\n            .status-bar {\n                background: #f8f9fa;\n                padding: 5px 20px;\n                font-size: 0.8em;\n                color: #666;\n                border-bottom: 1px solid #dee2e6;\n            }\n\n            .date-separator {\n                text-align: center;\n                margin: 20px 0;\n                position: relative;\n            }\n\n            .date-separator span {\n                background: #e5ddd5;\n                padding: 5px 15px;\n                border-radius: 15px;\n                font-size: 0.8em;\n                color: #666;\n                box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n            }\n        </style>\n\n        <div id="watiLogsContent" class="modal fade bd-example-modal-lg fade-scale" tabindex="" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">\n            <div class="modal-dialog modal-xl" style=\'width: 80% !important;\'>\n                <div class="d-flex flex-wrap wati-wrapper">\n                    <div class="modal-content border-0 watiLogsTableDiv">\n                        <div class="modal-header py-1 bg-primary text-white">\n                            <h5 class="modal-title font-weight-bold">Wati Logs</h5>\n                            <button type="button" class="close text-white" onclick="selfModalHide(\'watiLogsContent\')">\n                                <span aria-hidden="true">×</span>\n                            </button>\n                        </div>\n                        <div class="modal-body pt-1">\n                            <div class="flex-grow-1">\n                                <div class="chat-body">\n    ',o=null;return 0==t.length||t.forEach((e=>{const t="true"===e.owner||"broadcastMessage"===e.eventType,l=convertTZ(new Date(e.created),USER_TIMEZONE),n=l.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});o!==n&&(a+=`\n                <div class="date-separator">\n                    <span>${n}</span>\n                </div>\n            `,o=n);const s=l.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),r=(e.finalText||e.text||"").replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<strong>$1</strong>").replace(/😊/g,"<span>😊</span>").replace(/😇/g,"<span>😇</span>").replace(/🤔/g,"<span>🤔</span>").replace(/🗓️/g,"<span>🗓️</span>").replace(/💙/g,"<span>💙</span>").replace(/🙂/g,"<span>🙂</span>");a+=`\n            <div class="message ${t?"sent":"received"}">\n                <div class="message-bubble">\n\t\t\t\t<div class="message-name ${t?"":"hide"}">\n\t\t\t\t\t${void 0===e.operaterName?"Bot":e.operaterName+"("+e.watiNumber+")"}\n\t\t\t\t</div>\n                    ${r}\n                    <div class="message-time">\n                        ${s}\n                    </div>\n                </div>\n            </div>\n        `})),a+="\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ",a}function showWhatsappMessages(e){$("#watiLogsContent").length>0&&$("#watiLogsContent").remove(),$("body").append(whatsAppChat(e)),$("#watiLogsTableData").DataTable({theme:"bootstrap4"}),$("#watiLogsContent").modal("show")}function whatsAppChat(e){const t=JSON.parse(JSON.stringify(e)).sort(((e,t)=>parseFloat(new Date(e.dateTime).getTime())-parseFloat(new Date(t.dateTime).getTime())));let a='\n        <style>\n            .whatsapp-container {\n                max-width: 800px;\n                margin: 20px auto;\n                background: #e5ddd5;\n                border-radius: 15px;\n                box-shadow: 0 0 20px rgba(0,0,0,0.1);\n                font-family: \'Segoe UI\', sans-serif;\n                overflow: hidden;\n                position: relative;\n            }\n\n            .chat-header {\n                background: linear-gradient(45deg, #075e54, #128c7e);\n                color: white;\n                padding: 15px 20px;\n                display: flex;\n                justify-content: space-between;\n                align-items: center;\n                border-bottom: 1px solid rgba(255,255,255,0.1);\n            }\n\n\t\t\t.hide {\n\t\t\t\tdisplay: none\n\t\t\t}\n\n            .chat-header h3 {\n                margin: 0;\n                font-size: 1.2em;\n            }\n\n            .chat-header small {\n                opacity: 0.8;\n                font-size: 0.9em;\n            }\n\n            .chat-body {\n                padding: 20px;\n                height: 500px;\n                overflow-y: auto;\n                background: url(\'https://i.pinimg.com/736x/8c/98/99/8c98994518b575bfd8c949e91d20548b.jpg\');\n                background-size: contain;\n            }\n\n            .message {\n                max-width: 100%;\n                margin-bottom: 15px;\n                display: flex;\n                animation: slideIn 0.3s ease;\n            }\n\n            .message.sent {\n                justify-content: flex-end;\n            }\n\n            .message.received {\n                justify-content: flex-start;\n            }\n\n            .message-bubble {\n\t\t\t\tmax-width: 70%;\n                padding: 12px 18px;\n                border-radius: 10px;\n                position: relative;\n                box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n                word-wrap: break-word;\n            }\n\n            .sent .message-bubble {\n                background: #dcf8c6;\n                border-bottom-right-radius: 2px;\n            }\n\n            .received .message-bubble {\n                background: white;\n                border-bottom-left-radius: 2px;\n            }\n\n            .message-time {\n                font-size: 0.7em;\n                color: #666;\n                margin-top: 5px;\n                text-align: right;\n            }\n            .message-name {\n                font-size: 0.7em;\n                color: #666;\n                margin-top: 2px;\n                text-align: right;\n            }\n\n            .message-bubble::after {\n                content: \'\';\n                position: absolute;\n                width: 10px;\n                height: 10px;\n                bottom: 0;\n            }\n\n            .sent .message-bubble::after {\n                right: -10px;\n                background: #dcf8c6;\n                clip-path: polygon(0 100%, 100% 0, 100% 100%);\n            }\n\n            .received .message-bubble::after {\n                left: -10px;\n                background: white;\n                clip-path: polygon(0 0, 100% 100%, 0 100%);\n            }\n\n            .status-indicator {\n                font-size: 0.8em;\n                color: #666;\n                margin-left: 5px;\n            }\n\n            .status-indicator.read {\n                color: #34b7f1;\n            }\n\n            .close-btn {\n                background: none;\n                border: none;\n                color: white;\n                font-size: 1.5em;\n                cursor: pointer;\n                opacity: 0.8;\n            }\n\n            .close-btn:hover {\n                opacity: 1;\n            }\n\n            @keyframes slideIn {\n                from {\n                    opacity: 0;\n                    transform: translateY(20px);\n                }\n                to {\n                    opacity: 1;\n                    transform: translateY(0);\n                }\n            }\n\n            .status-bar {\n                background: #f8f9fa;\n                padding: 5px 20px;\n                font-size: 0.8em;\n                color: #666;\n                border-bottom: 1px solid #dee2e6;\n            }\n\n            .date-separator {\n                text-align: center;\n                margin: 20px 0;\n                position: relative;\n            }\n\n            .date-separator span {\n                background: #e5ddd5;\n                padding: 5px 15px;\n                border-radius: 15px;\n                font-size: 0.8em;\n                color: #666;\n                box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n            }\n        </style>\n\n        <div id="watiLogsContent" class="modal fade bd-example-modal-lg fade-scale" tabindex="" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">\n            <div class="modal-dialog modal-xl" style=\'width: 80% !important;\'>\n                <div class="d-flex flex-wrap wati-wrapper">\n                    <div class="modal-content border-0 watiLogsTableDiv">\n                        <div class="modal-header py-1 bg-primary text-white">\n                            <h5 class="modal-title font-weight-bold">Whatsapp Messages</h5>\n                            <button type="button" class="close text-white" onclick="selfModalHide(\'watiLogsContent\')">\n                                <span aria-hidden="true">×</span>\n                            </button>\n                        </div>\n                        <div class="modal-body pt-1">\n                            <div class="flex-grow-1">\n                                <div class="chat-body">\n    ',o=null;return 0==t.length||t.forEach((e=>{const t="OUTGOING"===e.direction,l=convertTZ(new Date(e.dateTime),USER_TIMEZONE),n=l.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});o!==n&&(a+=`\n                <div class="date-separator">\n                    <span>${n}</span>\n                </div>\n            `,o=n);const s=l.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),r=e.message.replace(/\n/g,"<br>").replace(/\*(.*?)\*/g,"<strong>$1</strong>").replace(/😊/g,"<span>😊</span>").replace(/😇/g,"<span>😇</span>").replace(/🤔/g,"<span>🤔</span>").replace(/🗓️/g,"<span>🗓️</span>").replace(/💙/g,"<span>💙</span>").replace(/🙂/g,"<span>🙂</span>");a+=`\n            <div class="message ${t?"sent":"received"}">\n                <div class="message-bubble">\n\t\t\t\t<div class="message-name ${t?"":"hide"}">\n\t\t\t\t${"OUTGOING"===e.direction?e.createdByUser:e.sentByNumber}\n\t\t\t\t</div>\n                    ${r}\n                    <div class="message-time">\n                        ${s}\n                    </div>\n                </div>\n            </div>\n        `})),a+="\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ",a}function toggleSelfTable(e){$("#"+e+"_body").slideToggle(),$("#"+e+"_icon").toggleClass("fa-angle-down fa-angle-up")}function populateWhatsappRecords(e,t,a,o,l){$("<style>").prop("type","text/css").html("\n\t\t.recurring-modal-backdrop {\n\t\t  position: fixed;\n\t\t  top: 0;\n\t\t  left: 0;\n\t\t  width: 100%;\n\t\t  height: 100%;\n\t\t  background: rgba(0, 0, 0, 0.5);\n\t\t  display: none;\n\t\t  z-index: 999;\n\t\t}\n  \n\t\t.recurring-modal {\n\t\t  position: fixed;\n\t\t  top: 0;\n\t\t  right: -90%;\n\t\t  width: 90%;\n\t\t  height: 100vh;\n\t\t  background: white;\n\t\t  box-shadow: -2px 0px 10px rgba(0, 0, 0, 0.2);\n\t\t  transition: right 0.3s ease-in-out;\n\t\t  z-index: 1000;\n\t\t}\n  \n\t\t.recurring-modal.open {\n\t\t  right: 0;\n\t\t}\n  \n\t\t.modal-header {\n\t\t  display: flex;\n\t\t  justify-content: space-between;\n\t\t  align-items: center;\n\t\t  padding: 15px;\n\t\t  background: #007bff;\n\t\t  color: white;\n\t\t}\n  \n\t\t.modal-body {\n\t\t  padding: 20px;\n\t\t}\n  \n\t\t.session-block {\n\t\t  margin-bottom: 15px;\n\t\t  border-bottom: 1px solid #ddd;\n\t\t  padding-bottom: 10px;\n\t\t}\n  \n\t\t.close-btn {\n\t\t  background: transparent;\n\t\t  border: none;\n\t\t  font-size: 24px;\n\t\t  color: white;\n\t\t  cursor: pointer;\n\t\t}\n  \n\t\t.play-btn {\n\t\t  background: #007bff;\n\t\t  color: white;\n\t\t  border: none;\n\t\t  padding: 5px 10px;\n\t\t  cursor: pointer;\n\t\t  border-radius: 5px;\n\t\t}\n  \n\t\t.play-btn:hover {\n\t\t  background: #0056b3;\n\t\t}\n  \n\t\t.accordion-btn {\n\t\t  background: #D7EBFF;\n\t\t  padding: 5px 10px;\n\t\t  width: 100%;\n\t\t  text-align: left;\n\t\t  cursor: pointer;\n\t\t  font-weight: bold;\n\t\t  border-radius: 5px;\n\t\t  \n\t\t}\n  \n\t\t.accordion-btn:focus {\n\t\t  outline: 0px !important;\n\t\t}\n  \n\t\t.recording-list {\n\t\t  padding: 10px;\n\t\t  background: #fff;\n\t\t  border-radius: 5px;\n\t\t}\n\t  ").appendTo("head"),($("#whatsappLogBackdrop").length>0||$("#whatsappLogBackdrop").length>0)&&($("#whatsappLogModal").remove(),$("#whatsappLogBackdrop").remove());var n=`\n\t  <div id="whatsappLogBackdrop" class="recurring-modal-backdrop" onclick="closeWhatsappModal();"></div>\n\t  <div id="whatsappLogModal" class="recurring-modal">\n\t\t<div class="p-3" style="background-color:#027FFF;">\n\t\t  <h5 class="mb-0" style="color: white;font-size:18px;font-weight: 700;">${a}</h5>\n\t\t   <button onclick="closeWhatsappModal();" type="button" class="p-2 cursor" data-dismiss="modal" aria-label="Close" style="position: absolute;left:-30px;top:35px;background-color: white !important;border-radius: 5px 0px 0px 5px;font-size: 35px;border:0px;color:#000;">\n\t\t\t<span aria-hidden="true">&times;</span>\n\t\t  </button>\n\t\t</div>\n\n\t\t<div class="p-3" style="width:300px; margin-left:auto;">\n\t\t\t<input placeholder="Search" type="text" onchange="getFilterWhatsappLeadNo(this.value, ${o})" class="form-control">\n\t\t</div>\n  \n\t\t<div style="background-color: #fff; height: 100vh;">\n\t\t  <div class="px-5" style="height: 80vh;overflow-y:auto;">\n\t\t\t<table id="recurring-recordings-table"  class="w-100 table border-radius-table>\n\t\t\t  <thead style="background-color:rgb(193, 220, 248);position: sticky;top: 0;z-index: 1;">\n\t\t\t\t<tr style="font-size: 14px;">\n\t\t\t\t\t<th class="p-2 rounded-top-left-10 border-right-0 border-left-0 border-top-0 border-primary" style="background-color:rgb(200, 224, 247); font-weight: normal; color:rgb(38, 146, 253)">Lead No</th>\n\t\t\t\t\t<th class="p-2 border-right-0 border-top-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Message from</th>\n\t\t\t\t\t<th class="p-2 border-right-0 border-top-0 border-left-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Message to</th>\n\t\t\t\t\t<th class="p-2 rounded-top-right-10 border-left-0 border-right-0 border-top-0 border-primary" style="background-color:rgb(200, 224, 247);font-weight: normal; color:rgb(38, 146, 253)">Action</th>\n\t\t\t\t</tr>\n\t\t\t  </thead>\n\t\t\t  <tbody id="whatsappLogModalTableBody"></tbody>\n\t\t\t</table>\n\t\t\t<div id="whatsappPagination"></div>\n\t\t  </div>\n\t\t</div>\n\t  </div>`;$("body").append(n),$("#whatsappPagination").html(renderPagination(currentPageWhatsapp,o,l,[...new Set(e.map(((e,t)=>e.leadNo)))].length)),renderWhatsappTable(e,o,l),setTimeout((()=>{$("#whatsappLogBackdrop").fadeIn(200),$("#whatsappLogModal").addClass("open"),$("body").css("overflow","hidden")}),50)}function renderWhatsappTable(e,t,a){$("#whatsappPagination").html(renderPagination(currentPageWhatsapp,t,a,[...new Set(e.map(((e,t)=>e.leadNo)))].length));const o=e.reduce(((e,t)=>{const a=t.leadNo;return e[a]=e[a]||[],e[a].push(t),e}),{});let l="";$.each(Object.entries(o),(function(e,t){let a=10*(currentPageWhatsapp-1)+e+1;1===t[1].length?l+=`\n\t\t\t\t<tr style="border-top-left-radius: 10px;border-bottom-left-radius: 10px; border-bottom: 0; border-color:blue">\n\t\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].leadNo}</td>\n\t\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].createdByUser}</td>\n\t\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].channelName}</td>\n\n\t\t\t\t\t<td class="py-2 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">\n\t\t\t\t\t<button onClick="showWhatsappMessages(${JSON.stringify(t[1]).replace(/"/g,"&quot;")})" class="bg-primary text-white text-center " style="border:none;border-radius:4px;cursor:pointer;">View</button>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>`:l+=`<tr id="row_id_${a}" style="border-top-left-radius: 10px; border-bottom-left-radius: 10px; border-bottom: 0; border-color: blue">\n\t\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[0]}</td>\n\n\t\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].createdByUser}</td>\n\t\t\t\t\t<td class="py-2 border-right-0 border-primary border-top-0" style="font-weight: 500;background-color:#fff;">${t[1][0].channelName}</td>\n\t\t\t\t\t<td class="py-2  border-primary border-top-0" style="font-weight: 500;background-color:#fff;">\n\t\t\t\t\t<button onClick="showWhatsappMessages(${JSON.stringify(t[1]).replace(/"/g,"&quot;")})" class="bg-primary text-white text-center " style="border:none;border-radius:4px;cursor:pointer;">View</button>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>`})),$("#whatsappLogModalTableBody").html(l),e&&0!==e.length||$("#whatsappLogModalTableBody").html('<tr><td colspan="9" class="text-center py-5" style="font-size: 16px;font-weight: 700;">No recordings found</td></tr>')}function closeWhatsappModal(){setTimeout((()=>{$("#whatsappLogModal").remove(),$("#whatsappLogBackdrop").remove(),$("body").css("overflow","auto")}),300),currentPageWhatsapp=1,currentWhatsappIds=""}let whatsappData=[];function getFilterWhatsappLeadNo(e,t){e=e.trim().toLowerCase();renderWhatsappTable(whatsappData.filter((t=>t.leadNo.toLowerCase().includes(e))),t,currentWhatsappIds.split(",").length,whatsappData.map(((e,t)=>e.leadNo)).length),""!=e?$(".pagination").hide():$(".pagination").show()}function serverMessageContent(){return'<div class="server-message"><span class="msg" id="msgTheme2"></span></div>'}function renderPagination(e,t,a,o){let l=`\n\t\t<nav aria-label="Page navigation">\n\t\t<ul class="pagination justify-content-center align-items-center">\n\t\t\t<li class="page-item ${1==e?"disabled":""}">\n\t\t\t<button class="page-link" onclick="goToPage(${e-1})"><i class="fa fa-chevron-left mr-2" style="font-size: 10px;"></i>Previous</button>\n\t\t\t</li>`,n=Math.max(1,e-1),s=Math.min(t,e+1);n>1&&(l+='\n\t\t<li class="page-item">\n\t\t\t<button class="page-link" onclick="goToPage(1)">1</button>\n\t\t</li>',n>2&&(l+='\n\t\t\t<li class="page-item">\n\t\t\t<span class="page-link" style="background: transparent; border: 0px; padding: 6px 0px;">...</span>\n\t\t\t</li>'));for(let t=n;t<=s;t++)l+=`\n\t\t<li class="page-item ${t==e?"active":""}">\n\t\t\t<button class="page-link" onclick="goToPage(${t})">${t}</button>\n\t\t</li>`;return s<t&&(s<t-1&&(l+='\n\t\t\t<li class="page-item">\n\t\t\t<span style="background: transparent; border: 0px; padding: 6px 0px;">...</span>\n\t\t\t</li>'),l+=`\n\t\t<li class="page-item">\n\t\t\t<button class="page-link" onclick="goToPage(${t})">${t}</button>\n\t\t</li>`),l+=`\n\t\t\t<li class="page-item ${e==t?"disabled":""}">\n\t\t\t<button class="page-link" onclick="goToPage(${e+1})">Next<i class="fa fa-chevron-right ml-2" style="font-size: 10px;"></i></button>\n\t\t\t</li>\n\t\t\t<div> &nbsp;&nbsp;&nbsp; ${o} out of ${a} records</div>\n\t\t</ul>\n\t\t\n\t\t</nav> `,l}function goToPage(e){"zadarma"==ZadarmaOrWati?(currentPageZadarma=e,showZadarmaDetails(currentZadarmaIds)):"wati"==ZadarmaOrWati?(currentPageWati=e,showWatiDetails(currentWatiIds)):(currentPageWhatsapp=e,showWhatsappDetails(currentWhatsappIds))}function syncZadarmaCall(){showMessageTheme2(1,"Call synchronization process started."),$("#callSyncRotate").addClass("rotate");var e=$("#syncZadarmaDate").val();$.ajax({url:BASE_URL+CONTEXT_PATH+"zadarma/v1/sync?syncDate="+e,type:"GET",contentType:"application/json",dataType:"json",async:!0,global:!1,success:function(e){"success"==e.status?($("#callSyncRotate").removeClass("rotate"),callLeadCounselorsList("leadReportSearch",$("#searchLeadCounselorType").val(),"","","listCounselorTbody",!1,0,0)):($("#callSyncRotate").removeClass("rotate"),showMessageTheme2(0,e.message))},error:function(e,t,a){console.error("Error fetching logs:",a),$("#callSyncRotate").removeClass("rotate")}})}function curentTimeStamp(e){var t=new Date,a=t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")+" "+String(t.getHours()).padStart(2,"0")+":"+String(t.getMinutes()).padStart(2,"0")+":"+String(t.getSeconds()).padStart(2,"0"),o="UTC "+moment.tz(a,"YYYY-MM-DD hh:mm:ss",""+e).format("Z");$(".leadInfoTime").text(o),$(".leadDemoTime").text(o),$(".b2bleadInfoTime").text(o)}function getLeadDataList(e,t,a,o,l,n,s,r,d){if(customLoader(!0),checkTextBox(e),""!=$("#"+e+" #leadStartDateSearch").val()&&""!=$("#"+e+" #leadEndDateSearch").val()&&""==$("#"+e+" #searchDateType option:selected").val())return showMessageTheme2(0,"Please select type for date"),!1;""==moduleId&&(moduleId=$("#"+e+" #leadFromSearchModuleId").val()),""==a&&(a=$("#"+e+" #clickFromSearch").val()),""==o&&(o=$("#"+e+" #currentPageSearch").val()),$("#leadAdvanceSearch").modal("hide"),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("/api/v1/leads","get-lead-data"),data:JSON.stringify(getCallRequestForAdvanceLeadSearchStudent(e,r.moduleId,t,a,o,l,n,s,r.leadType,"Y")),dataType:"json",global:!1,success:function(e){if(customLoader(!1),"0"==e.status||"2"==e.status)if(showMessageTheme2(0,e.message,"",!0),"B2B"==r.leadType)$("#b2b-lead-list").html("");else{var t=getB2cLeadHeaderList(e,r,d);$("#b2c-lead-list").html(t)}else{if("B2B"==r.leadType){t=getB2bLeadList(e,r,d);$("#b2b-lead-list").html(t)}else{t=getB2cLeadList(e,r,d);$("#b2c-lead-list").html(t),$('[data-toggle="tooltip"]').tooltip();for(var a=e.data,o=0;o<a.length;o++){getLeadStatusLog(a[o].leadNo,"new-lead",r.adminStatus)}curentTimeStamp(r.timeZoneOffset),$(".selectcampain").select2({theme:"bootstrap4",dropdownParent:"#b2c-lead-list"}),$(".leadSearchCampaign").select2({theme:"bootstrap4",dropdownParent:"#advanceLeadNewSearchForm"}),$(".leadSearchTemplate").select2({theme:"bootstrap4",dropdownParent:"#advanceLeadNewSearchForm"}),$(".leadSearchDeliveredStatus").select2({theme:"bootstrap4",dropdownParent:"#advanceLeadNewSearchForm"})}$(".follow-up-no").click((function(){$(this).find(".fa-angle-down").toggleClass("fa-angle-down fa-angle-up"),$(this).parent().siblings().find(".fa-angle-up").toggleClass("fa-angle-up fa-angle-down"),$(this).parent().find(".follow-up-content").slideDown(),$(this).parent().siblings().find(".follow-up-content").slideUp(),$(this).parent().addClass("follow-up-accordian-active"),$(this).parent().siblings().removeClass("follow-up-accordian-active")}));var l,n;l=$("#leadNoMove").val(),n=String(l).split(",");for(let e=0;e<n.length;e++)$("#lead-"+n[e]).prop("checked",!0);var s="",i="";$("#selectLeadAll").click((function(){var e=$("#leadNoMove").val(),t=this;$(".leadDataList").find(".checkLead").each((function(){$(this)[0].checked=t.checked}));var a="";$.each($("input[name='lead-move-another']:checked"),(function(){if(-1!=e.indexOf($(this).val()));else{a=a+","+$(this).val();var t=$("#checkDemoMoved-"+$(this).val()).val(),o=t.split("-")[0],l=t.split("-")[1];0!=l&&o!=l?s+="moved":0==l&&(i+="blank")}})),e+=a,$("#leadNoMove").val(e),$("#selectLeadAll").is(":checked")||(s="",i="",$("#leadNoMove").val("")),$("#demoMovedTrue").val(s),$("#blankDemo").val(i)})),$(".checkLead").click((function(){var e=$("#leadNoMove").val(),t=$("#selectLeadAll");t.attr("checked","checked");$("#leadDataList").find(".checkLead");$("#leadDataList .checkLead").each((function(){if($(this).is(":checked"));else if(t.prop("checked",!1),t.removeAttr("checked","checked"),-1!=e.indexOf($(this).val())){e=e.replace(","+$(this).val(),"");var a=$("#checkDemoMoved-"+$(this).val()).val(),o=a.split("-")[0],l=a.split("-")[1];0!=l&&o!=l?s=s.replace("moved",""):0==l&&(i=i.replace("blank",""))}}));var a="";$.each($("input[name='lead-move-another']:checked"),(function(){if(-1!=e.indexOf($(this).val()));else{var t=$("#checkDemoMoved-"+$(this).val()).val(),o=t.split("-")[0],l=t.split("-")[1];0!=l&&o!=l&&USER_ID!=o?s+="moved":0==l&&(i+="blank"),a=a+","+$(this).val()}})),e+=a,$("#leadNoMove").val(e),$("#demoMovedTrue").val(s),$("#blankDemo").val(i)})),$("#leadsPagging").on("change",(function(){getLeadDataList("advanceLeadNewSearchForm","advance-search","list","0","new",!0,"",r,d)}))}return!1},error:function(e){checkonlineOfflineStatus()||customLoader(!1)}})}