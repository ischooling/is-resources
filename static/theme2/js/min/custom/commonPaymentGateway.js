function callCommonInitPayment(e,a,t){hideMessage(""),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("common","payment-initiated"),data:JSON.stringify(getRequestForInitPayment(e,a,t)),dataType:"json",cache:!1,async:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?showMessage(1,e.message):(showMessage(1,e.message),callCommonPaymentGateway("","common","",t)),!1}})}function getRequestForInitPayment(e,a,t){var o={},n={},r={};return $("#location").length>0?r.location=$("#location").val():r.location="",r.eligiblePaymentGateway=t,r.userType=a,"STUDENT"==a?(r.studentId=$("#studentId").val().trim(),r.moduleName=$("#moduleName").val().trim(),r.paymentTitle=$("#paymentType").val().trim(),r.paymentType=$("#paymentType").val().trim(),r.paymentAmount=$("#totalPaymentAmount").attr("data-payAmount")):"SCHOOL"==a&&(r.moduleName=$("#moduleName").val().trim(),r.paymentTitle=$("#paymentType").val().trim(),r.paymentType=$("#paymentType").val().trim(),"SCHOOL-STUDENT-FEE"==$("#paymentType").val()&&(r.schoolId=$("#schoolId").val().trim(),r.studentId=$("#totalStudentIds").val().trim(),r.totalCount=$("#totalCount").val().trim(),r.gradeId=$("#currentGradeId").val().trim())),r.teacherRequestSubjectIds=$("#totalSubjectIds").attr("data-subjectids"),n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userType=a,n.userId=$("#userId").val().trim(),o.authentication=n,o.commonPaymentInfo=r,o}function callCommonPaymentGateway(e,a,t,o){if(hideModalMessage(""),$("#cardHolderNameError").hide(),$("#cardNumberError").hide(),$("#cardExpiryMonthError").hide(),$("#cardExpiryMonthError").hide(),$("#cardCodeError").hide(),"WELLSFARGO"==o){if(""==$("#cardHolderName").val()||null==$("#cardHolderName").val())return $("#cardHolderNameError").show(),!1;if(""==$("#cardNumber").val()||null==$("#cardNumber").val())return $("#cardNumberError").show(),!1;if(""==$("#cardExpiryYear").val()||null==$("#cardExpiryYear").val())return $("#cardExpiryMonthError").show(),!1;if(""==$("#cardExpiryMonth").val()||null==$("#cardExpiryMonth").val())return $("#cardExpiryMonthError").show(),!1;if(""==$("#cardCode").val()||null==$("#cardCode").val())return $("#cardCodeError").show(),!1}customLoader(!0),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("common","call-payment-gateway"),data:JSON.stringify(getRequestForCommonPayment(e,a,t,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?(showModalMessage(0,e.message),"ELIGIBLE_CUSTOME_PLAN"!=e.statusCode&&"REDIRECT_TO_DASHBOOARD"!=e.statusCode||window.location.reload()):(showModalMessage(1,e.message),"Smoovpay"==e.paymentGateway?prepareSmoovPayDataAndPost(e.smoovPayData):window.location.replace(e.extra)),customLoader(!1),!1}})}function getRequestForCommonPayment(e,a,t,o){var n={},r={};if("common"==a){r.userType=a,r.userId=$("#userId").val().trim();var l={};if($("#location").length>0?l.location=$("#location").val():l.location="",l.themeType="theme2",l.paymentOptionName="Online",l.eligiblePaymentGateway=o,l.userType=a,$("#moduleName").length>0&&(l.moduleName=$("#moduleName").val().trim()),$("#paymentType").length>0&&(l.paymentTitle=$("#paymentType").val().trim()),$("#paymentType").length>0&&(l.paymentType=$("#paymentType").val().trim()),"WELLSFARGO"==o)(c={}).cardHolderName=$("#cardHolderName").val().trim(),c.cardNumber=$("#cardNumber").val().trim(),c.expirationDate=$("#cardExpiryYear").val().trim()+"-"+$("#cardExpiryMonth").val().trim(),c.cardCode=$("#cardCode").val().trim(),l.creditCard=c;if(null!=t&&""!=t){var m=(v=t.split("&"))[0].split("="),i=v[1].split("="),s=v[2].split("="),d=v[3].split("="),p=v[4].split("="),y=v[5].split("="),u=v[6].split("=");l.entityType=y[1],l.entityId=u[1],l.paymentByUserId=p[1],r.userId=i[1],l.userPaymentId=s[1],"SUBJECT_FEE"==m[1]?l.paymentType=m[1]:l.paymentType=d[1],l.paymentTitle=m[1]}}else if("student"==a){r.userType="STUDENT";l={};if($("#location").length>0?l.location=$("#location").val():l.location="",l.themeType="theme2",l.paymentOptionName="Online",l.eligiblePaymentGateway=o,l.userType=moduleId,"WELLSFARGO"==o)(c={}).cardHolderName=$("#cardHolderName").val().trim(),c.cardNumber=$("#cardNumber").val().trim(),c.expirationDate=$("#cardExpiryYear").val().trim()+"-"+$("#cardExpiryMonth").val().trim(),c.cardCode=$("#cardCode").val().trim(),l.creditCard=c;if(null!=t&&""!=t){m=(v=t.split("&"))[0].split("="),i=v[1].split("="),s=v[2].split("="),d=v[3].split("="),p=v[4].split("="),y=v[5].split("="),u=v[6].split("=");l.entityType=y[1],l.entityId=u[1],l.paymentByUserId=p[1],r.userId=i[1],l.userPaymentId=s[1],"SUBJECT_FEE"==m[1]?l.paymentType=m[1]:l.paymentType=d[1],l.paymentTitle=m[1]}else r.userId=$("#"+e+" #userId").val().trim(),l.paymentTitle=$("#paymentType").val().trim(),l.paymentType=$("#paymentType").val().trim()}else if("school"==a){r.userType="SCHOOL",r.userId=$("#userId").val().trim();l={};if($("#location").length>0?l.location=$("#location").val():l.location="",l.themeType="theme2",l.paymentOptionName="Online",l.eligiblePaymentGateway=o,l.userType=a,l.moduleName="SCHOOL_B2B","WELLSFARGO"==o)(c={}).cardHolderName=$("#cardHolderName").val().trim(),c.cardNumber=$("#cardNumber").val().trim(),c.expirationDate=$("#cardExpiryYear").val().trim()+"-"+$("#cardExpiryMonth").val().trim(),c.cardCode=$("#cardCode").val().trim(),l.creditCard=c;if(null!=t&&""!=t){m=(v=t.split("&"))[0].split("="),i=v[1].split("="),s=v[2].split("="),d=v[3].split("="),y=v[4].split("="),u=v[5].split("=");l.entityType=y[1],l.entityId=u[1],l.paymentType=m[1],l.paymentTitle=m[1]}else null==$("#paymentType").val().trim()?(l.paymentTitle="APPLICATION-FEE",l.paymentType="APPLICATION-FEE"):(l.paymentTitle=$("#paymentType").val().trim(),l.paymentType=$("#paymentType").val().trim())}else if("student"==a){r.userType="STUDENT";var c;l={};if($("#location").length>0?l.location=$("#location").val():l.location="",l.themeType="theme2",l.paymentOptionName="Online",l.eligiblePaymentGateway=o,l.userType=moduleId,"WELLSFARGO"==o)(c={}).cardHolderName=$("#cardHolderName").val().trim(),c.cardNumber=$("#cardNumber").val().trim(),c.expirationDate=$("#cardExpiryYear").val().trim()+"-"+$("#cardExpiryMonth").val().trim(),c.cardCode=$("#cardCode").val().trim(),l.creditCard=c;if(null!=t&&""!=t){m=(v=t.split("&"))[0].split("="),i=v[1].split("="),s=v[2].split("="),d=v[3].split("="),y=v[4].split("="),u=v[5].split("=");l.entityType=y[1],l.entityId=u[1],r.userId=i[1],l.userPaymentId=s[1],l.paymentType=m[1],l.paymentTitle=m[1]}else r.userId=$("#"+e+" #userId").val().trim(),l.paymentTitle=$("#paymentType").val().trim(),l.paymentType=$("#paymentType").val().trim()}else if("school"==a){r.userType="SCHOOL",r.userId=$("#userId").val().trim();l={};if($("#location").length>0?l.location=$("#location").val():l.location="",l.themeType="theme2",l.paymentOptionName="Online",l.eligiblePaymentGateway=o,l.userType=a,l.moduleName="SCHOOL_B2B","WELLSFARGO"==o){var T={};T.cardHolderName=$("#cardHolderName").val().trim(),T.cardNumber=$("#cardNumber").val().trim(),T.expirationDate=$("#cardExpiryYear").val().trim()+"-"+$("#cardExpiryMonth").val().trim(),T.cardCode=$("#cardCode").val().trim(),l.creditCard=T}if(null!=t&&""!=t){var v;m=(v=t.split("&"))[0].split("="),i=v[1].split("="),s=v[2].split("="),d=v[3].split("="),y=v[4].split("="),u=v[5].split("=");l.entityType=y[1],l.entityId=u[1],l.paymentType=m[1],l.paymentTitle=m[1]}else l.paymentTitle="APPLICATION-FEE",l.paymentType="APPLICATION-FEE"}return r.hash=getHash(),r.schoolId=SCHOOL_ID,r.schoolUUID=SCHOOL_UUID,n.authentication=r,n.commonPaymentInfo=l,n}function prepareSmoovPayDataAndPost(e){$("#smoovpayForm").attr("action",e.endPoint),$("#smoovpayForm input[name*='action']").val(e.action),$("#smoovpayForm input[name*='currency']").val(e.currency),$("#smoovpayForm input[name*='version']").val(e.version),$("#smoovpayForm input[name*='item_name_1']").val(e.itemName1),$("#smoovpayForm input[name*='item_description_1']").val(e.itemDescription1),$("#smoovpayForm input[name*='item_quantity_1']").val(e.itemQuantity1),$("#smoovpayForm input[name*='item_amount_1']").val(e.itemAmount1),$("#smoovpayForm input[name*='merchant']").val(e.merchant),$("#smoovpayForm input[name*='ref_id']").val(e.refId),$("#smoovpayForm input[name*='delivery_charge']").val(e.deliveryCharge),$("#smoovpayForm input[name*='tax_amount']").val(e.taxAmount),$("#smoovpayForm input[name*='tax_percentage']").val(e.taxPercentage),$("#smoovpayForm input[name*='total_amount']").val(e.totalAmount),$("#smoovpayForm input[name*='str_url']").val(e.strUrl),$("#smoovpayForm input[name*='success_url']").val(e.successUrl),$("#smoovpayForm input[name*='cancel_url']").val(e.cancelUrl),$("#smoovpayForm input[name*='signature']").val(e.signature),$("#smoovpayForm input[name*='signature_algorithm']").val(e.signatureAlgorithm),$("#smoovpayForm").submit()}function callStudentWireTransferPayment(e,a,t,o,n,r,l){$.ajax({type:"POST",url:getURLForHTML("common","call-for-wire-transfer-payment"),contentType:"application/json",data:JSON.stringify(getRequestForStudentWireTransferPayment(e,a,t,o,n,r,l)),dataType:"html",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessage(1,e.message):($("#callPaymentStudentModal").modal("hide"),"migration"==n||"signup"==n?($("#logout_modal_logout").modal("hide"),setTimeout((function(){$("#logout_modal_logout").modal("show")}),1e3)):"EVALUATION_TEST"==n?$("#logout_modal_evluation").modal("show"):$("#logout_modal_continue").modal("show"))}})}function getRequestForStudentWireTransferPayment(e,a,t,o,n,r,l){var m={};return m.userId=t,m.paymentByUserId=r,m.moduleId=o,m.callingFrom=n,m.paymentMode=$("#editStage5PaymentMethod").text(),1==a?(m.paymentOptionName=l,m.referenceNumber=$("#"+e+" #wireTransferNumberPaypal").val().trim(),m.uplaodedFileName=$("#"+e+" #fileName8").html(),m.amountPaid=$("#"+e+" #paypalAmount").val().trim(),m.userPaymentDetailsId=$("#"+e+" #userPaymentDetailsId").val().trim(),m.paymentTitle=$("#"+e+" #paymentTitle").val().trim()):(m.paymentOptionName=l,m.referenceNumber=$("#"+e+" #referenceNumber").val(),m.uplaodedFileName="CASH"==l?$("#"+e+" #fileName8").html():$("#"+e+" #fileName9").html(),m.amountPaid=$("#"+e+" #wireTransferAmount").val(),m.userPaymentDetailsId=$("#"+e+" #userPaymentDetailsId").val(),m.paymentTitle=$("#"+e+" #paymentTitle").val()),console.log("Payment data is : "+JSON.stringify(m)),m}function callClientCommonPaymentGatewayOffline(e,a,t,o,n,r){customLoader(!0),$.ajax({type:"POST",url:getURLForHTML("common","call-for-client-common-payment-method-offline"),contentType:"application/json",data:JSON.stringify(getRequestForClientPayment(e,a,t,o,n,r)),dataType:"html",cache:!1,timeout:6e5,success:function(e){var a;"FAILED"==(a=e.split("|"))[0]||"EXCEPTION"==a[0]||"SESSIONOUT"==a[0]?"SESSIONOUT"==a[0]?redirectLoginPage():showMessageTheme2(0,a[1],"",!0):"NOPAYMENTGATEWAYENABLED"==a[0]?showMessageTheme2(0,a[1],"",!0):"INVALIDPAYMENT"==a[0]?window.location.reload():("booksession"==n||"extension"==n?($("#payTabBookingSessionModal").modal("hide"),$("#paymentBookSessionModel").html(e),$("#callPaymentStudentModal").modal("hide")):($("#paymentMethodModel").show(),$("#paymentMethodModel").html(e)),setTimeout((function(){$("body").addClass("modal-open")}),1e3))},error:function(e){customLoader(!1),showMessageTheme2(0,TECHNICAL_GLITCH,"",!0)}})}function callClientCommonPaymentGateway(e,a,t,o,n,r){callLocationForPayment(),customLoader(!0),$.ajax({type:"POST",url:getURLForHTML("common","call-for-client-common-payment-method"),contentType:"application/json",data:JSON.stringify(getRequestForClientPayment(e,a,t,o,n,r)),dataType:"html",global:!1,success:function(e){var a;"FAILED"==(a=e.split("|"))[0]||"EXCEPTION"==a[0]||"SESSIONOUT"==a[0]?"SESSIONOUT"==a[0]?(redirectLoginPage(),customLoader(!1)):showMessageTheme2(0,a[1],"",!0):"NOPAYMENTGATEWAYENABLED"==a[0]?showMessageTheme2(0,a[1],"",!0):"INVALIDPAYMENT"==a[0]||(1==$("#reserveSeatModal").length&&$("#reserveSeatModal").modal("hide"),"booksession"==n||"extension"==n?($("#payTabBookingSessionModal").modal("hide"),$("#paymentBookSessionModel").html(e),$("#callPaymentStudentModal").modal({backdrop:"static",keyboard:!1}),$("#courseFeeModalTNC").modal("hide")):$("#paymentMethodModel").html(e),setTimeout((function(){$("body").addClass("modal-open")}),1e3))},error:function(e){checkonlineOfflineStatus()||(showMessageTheme2(0,TECHNICAL_GLITCH,"",!0),customLoader(!1))}})}function getRequestForClientPayment(e,a,t,o,n,r){var l={};return $("#location").length>0&&(l.location=$("#location").val()),l.userId=t,l.paymentByUserId=r,l.moduleId=a,l.userPaymentDetailsId=o,l.termCondi=n,l}function continueWorking(){$("#logout_modal_logout").modal("hide"),customLoader(!0),setTimeout((function(){window.location.reload()}),1e3)}function callSigninStudentPay(e,a){hideModalMessage(!0),$("#callPaymentStudentModal").modal({backdrop:"static",keyboard:!1}),$("#courseFeeModalTNC").modal("hide"),$("#bookAnEnrollmentModel").modal("hide"),$("#wu_payment_warning").modal("hide")}function callStudentTransferSubmit(e,a,t,o,n){var r="",l=$("#userId").val().trim();if(1==a){if(""==$("#"+e+" #wireTransferNumberPaypal").val().trim()||null==$("#"+e+" #wireTransferNumberPaypal").val().trim())return showMessageTheme2(0,"Reference Number is required","",!0),!1;r="EVALUATION_TEST"==t?"callStudentWireTransferPayment('"+e+"', '1', '"+l+"', 'common','"+t+"', '"+o+"', '"+n+"');":"callStudentWireTransferPayment('"+e+"', '1', '"+l+"', 'student','"+t+"', '"+o+"', '"+n+"');"}if(2==a){if(""==$("#"+e+" #referenceNumber").val().trim()||null==$("#"+e+" #referenceNumber").val().trim())return showMessageTheme2(0,"Reference Number is required","",!0),!1;var m="fileName9";if("CASH"==n&&(m="fileName8"),null==$("#"+e+" #"+m).text()||""==$("#"+e+" #"+m).text())return showMessageTheme2(0,"Proof of Payment required","",!0),!1;r="EVALUATION_TEST"==t?"callStudentWireTransferPayment('"+e+"', '2', '"+l+"', 'common','"+t+"', '"+o+"', '"+n+"');":"callStudentWireTransferPayment('"+e+"', '2', '"+l+"', 'student','"+t+"', '"+o+"', '"+n+"');"}$("#callPaymentStudentModal").modal("hide"),"EVALUATION_TEST"==t?($("#proceedEvaluationPayment").attr("onclick",r),$("#cancelEvaluationPayment").attr("onclick","$('#callPaymentStudentModal').modal({backdrop: 'static', keyboard: false});"),$("#reference_number_evaluation").modal("show")):($("#proceedStudentPayment").attr("onclick",r),$("#cancelStudentPayment").attr("onclick","$('#callPaymentStudentModal').modal({backdrop: 'static', keyboard: false});"),$("#reference_number").modal("show"))}function showAlternatePG(){$("#primary-pg").hide(1e3),$("#alternate-pg").show(1e3)}function showPrimaryPG(){$("#primary-pg").show(1e3),$("#alternate-pg").hide(1e3)}