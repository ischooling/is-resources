var bankUploadDocsObj=[];function signupTeacherStage6OnLoadEvent(){$("#accountCurrency").html(getCurrenciesOption()),$("#accountCategory").html(getAccountCategoriesOption()),callCountriesOption("teacherSignupStage6","","accountHolderCountryId",""),callStates("teacherSignupStage6","","accountHolderCountryId","accountHolderStateId","accountHolderCityId"),$("#teacherSignupStage6 #accountHolderStateId").val($("#accountHolderStateId").val()).trigger("change"),callCities("teacherSignupStage6",$("#accountHolderStateId").val(),"accountHolderStateId","accountHolderCityId"),callCountriesOption("teacherSignupStage6","","bankCountryId",""),callStates("teacherSignupStage6","","bankCountryId","bankStateId","bankCityId"),$("#teacherSignupStage6 #bankStateId").val($("#bankStateId").val()).trigger("change"),callCities("teacherSignupStage6",$("#bankStateId").val(),"bankStateId","bankCityId"),$("#accountHolderCountryId").unbind().bind("change",(function(){$("#accountHolderCountryId").valid(),callStates("teacherSignupStage6",this.value,"accountHolderCountryId","accountHolderStateId","accountHolderCityId"),$("#accountHolderCityId").html("<option value=''>Select City*</option>"),validEndInvalidField(null,"accountHolderCityId"),validEndInvalidField(null,"accountHolderStateId")})),$("#accountHolderStateId").unbind().bind("change",(function(){$("#accountHolderStateId").valid(),callCities("teacherSignupStage6",this.value,"accountHolderStateId","accountHolderCityId"),validEndInvalidField(null,"accountHolderCityId")})),$("#accountHolderCityId").unbind().bind("change",(function(){$("#accountHolderCityId").valid()})),$("#bankCountryId").unbind().bind("change",(function(){$("#bankCountryId").valid(),callStates("teacherSignupStage6",this.value,"bankCountryId","bankStateId","bankCityId"),$("#bankCityId").html("<option value=''>Select City*</option>"),validEndInvalidField(null,"bankStateId"),validEndInvalidField(null,"bankCityId")})),$("#bankStateId").unbind().bind("change",(function(){$("#bankStateId").valid(),callCities("teacherSignupStage6",this.value,"bankStateId","bankCityId"),validEndInvalidField(null,"bankCityId")})),$("#bankCityId").unbind().bind("change",(function(){$("#bankCityId").valid()})),$("#accountCurrency").change((function(){if(""==$("#accountCurrency").val().trim())return validEndInvalidField(null,"accountCurrency"),!1;validEndInvalidField(!0,"accountCurrency")})),$("#accountNumber").blur((function(){if(""==$("#accountNumber").val().trim())return validEndInvalidField(null,"accountNumber"),!1;validEndInvalidField(!0,"accountNumber")})),$("#iban").blur((function(){if(""==$("#iban").val().trim())return validEndInvalidField(null,"iban"),!1;validEndInvalidField(!0,"iban")})),$("#accountCategory").change((function(){if(""==$("#accountCategory").val().trim())return validEndInvalidField(null,"accountCategory"),!1;validEndInvalidField(!0,"accountCategory")})),$("#accountHolderFirstName").blur((function(){if(""==$("#accountHolderFirstName").val().trim())return validEndInvalidField(null,"accountHolderFirstName"),!1;validEndInvalidField(!0,"accountHolderFirstName")})),$("#accountHolderMiddleName").blur((function(){if(""==$("#accountHolderMiddleName").val().trim())return validEndInvalidField(null,"accountHolderMiddleName"),!1;validEndInvalidField(!0,"accountHolderMiddleName")})),$("#accountHolderLastName").blur((function(){if(""==$("#accountHolderLastName").val().trim())return validEndInvalidField(null,"accountHolderLastName"),!1;validEndInvalidField(!0,"accountHolderLastName")})),$("#accountHolderAddress").blur((function(){if(""==$("#accountHolderAddress").val().trim())return validEndInvalidField(null,"accountHolderAddress"),!1;validEndInvalidField(!0,"accountHolderAddress")})),$("#accountHolderCountryId").change((function(){if(""==$("#accountHolderCountryId").val().trim())return validEndInvalidField(null,"accountHolderCountryId"),!1;validEndInvalidField(!0,"accountHolderCountryId")})),$("#accountHolderStateId").change((function(){if(""==$("#accountHolderStateId").val().trim())return validEndInvalidField(null,"accountHolderStateId"),!1;validEndInvalidField(!0,"accountHolderStateId")})),$("#accountHolderCityId").change((function(){if(""==$("#accountHolderCityId").val().trim())return validEndInvalidField(null,"accountHolderCityId"),!1;validEndInvalidField(!0,"accountHolderCityId")})),$("#accountHolderPostal").blur((function(){if(""==$("#accountHolderPostal").val().trim())return validEndInvalidField(null,"accountHolderPostal"),!1;validEndInvalidField(!0,"accountHolderPostal")})),$("#accountHolderPhone").blur((function(){if(""==$("#accountHolderPhone").val().trim())return validEndInvalidField(null,"accountHolderPhone"),!1;validEndInvalidField(!0,"accountHolderPhone")})),$("#accountHolderEmail").blur((function(){if(""==$("#accountHolderEmail").val().trim())return validEndInvalidField(null,"accountHolderEmail"),!1;validEndInvalidField(!0,"accountHolderEmail")})),$("#bankName").blur((function(){if(""==$("#bankName").val().trim())return validEndInvalidField(null,"bankName"),!1;validEndInvalidField(!0,"bankName")})),$("#bankBranchName").blur((function(){if(""==$("#bankBranchName").val().trim())return validEndInvalidField(null,"bankBranchName"),!1;validEndInvalidField(!0,"bankBranchName")})),$("#bankBranchAddress").blur((function(){if(""==$("#bankBranchAddress").val().trim())return validEndInvalidField(null,"bankBranchAddress"),!1;validEndInvalidField(!0,"bankBranchAddress")})),$("#bankCountryId").change((function(){if(""==$("#bankCountryId").val().trim())return validEndInvalidField(null,"bankCountryId"),!1;validEndInvalidField(!0,"bankCountryId")})),$("#bankStateId").change((function(){if(""==$("#bankStateId").val().trim())return validEndInvalidField(null,"bankStateId"),!1;validEndInvalidField(!0,"bankStateId")})),$("#bankCityId").change((function(){if(""==$("#bankCityId").val().trim())return validEndInvalidField(null,"bankCityId"),!1;validEndInvalidField(!0,"bankCityId")})),$("#bankPostal").blur((function(){if(""==$("#bankPostal").val().trim())return validEndInvalidField(null,"bankPostal"),!1;validEndInvalidField(!0,"bankPostal")})),$("#otherDetails").blur((function(){if(""==$("#otherDetails").val().trim())return validEndInvalidField(null,"otherDetails"),!1;validEndInvalidField(!0,"otherDetails")})),$("#swiftCode").blur((function(){if(""==$("#swiftCode").val().trim())return validEndInvalidField(null,"swiftCode"),!1;validEndInvalidField(!0,"swiftCode")})),$("#bankIfsc").blur((function(){if(""==$("#bankIfsc").val().trim())return validEndInvalidField(null,"bankIfsc"),!1;validEndInvalidField(!0,"bankIfsc")})),$("#routeNumber").blur((function(){if(""==$("#routeNumber").val().trim())return validEndInvalidField(null,"routeNumber"),!1;validEndInvalidField(!0,"routeNumber")}))}function callForSignupTeacherAgreement(a,e,n,t){if(!$("#agreementDeclarationConfirm").is(":checked"))return showMessage(2," Please Accept the Declaration.","",!0),!1;""==e&&(e=$("#"+a+" #userIdAgreement").val()),""==n&&(n=$("#"+a+" #agreementLogId").val()),""==t&&(t=$("#"+a+" #agreementAcceptanceFrom").val());var l=!1,d={};return d.userId=e,d.agreementLogId=n,d.agreementLogId=n,d.controlType=t,$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("teacher/signup","save-Teacher-Declaration"),data:JSON.stringify(d),dataType:"json",async:!1,success:function(a){"FAILED"==a.statusCode?("3"==a.status?redirectLoginPage():"0"!=a.status&&"3"!=a.status||showMessage(0,res.message,"",!0),l=!1):("SIGNUP"==t?getStage6Data():($("#teacherAgreementModal").modal("hide"),"true"==$("#showTimePrefModal").val()?$("#timePreferencePopup").modal("show"):$("#timePreferencePopup").modal("hide")),showMessage(1,"Teacher Agreement details updated successfully.","",!0),l=!0)},error:function(a){$("#nextStep").prop("disabled",!1)}}),l}function callForSignupTeacherAccountAndContact(a){return new Promise(((e,n)=>{let t=!1;return""==$("#"+a+" #accountCurrency").val()?(showMessage(2,"Please choose account currency.","",!0),!1):""==$("#"+a+" #accountNumber").val()?(showMessage(2,"Account number can't be blank.","",!0),!1):""==$("#"+a+" #accountCategory").val()?(showMessage(2,"Please choose account type.","",!0),!1):""==$("#"+a+" #accountHolderFirstName").val()?(showMessage(2,"Account holder first name can't be blank.","",!0),!1):""==$("#"+a+" #accountHolderLastName").val()?(showMessage(2,"Account holder last name can't be blank.","",!0),!1):""==$("#"+a+" #accountHolderAddress").val()?(showMessage(2,"Account holder address can't be blank.","",!0),!1):null==$("#"+a+" #accountHolderCountryId").val()||""==$("#"+a+" #accountHolderCountryId").val()?(showMessage(2,"Please choose account holder country.","",!0),!1):null==$("#"+a+" #accountHolderStateId").val()||""==$("#"+a+" #accountHolderStateId").val()?(showMessage(2,"Please choose account holder state.","",!0),!1):null==$("#"+a+" #accountHolderCityId").val()||""==$("#"+a+" #accountHolderCityId").val()?(showMessage(2,"Please choose account holder city.","",!0),!1):""==$("#"+a+" #accountHolderPostal").val()?(showMessage(2,"Account holder postal code can't be blank.","",!0),!1):""==$("#"+a+" #accountHolderPhone").val()?(showMessage(2,"Account holder phone number can't be blank.","",!0),!1):validateEmail($("#"+a+" #accountHolderEmail").val())?""==$("#"+a+" #bankName").val()?(showMessage(2,"Bank name can't be blank.","",!0),!1):""==$("#"+a+" #bankBranchName").val()?(showMessage(2,"Bank branch name can't be blank.","",!0),!1):""==$("#"+a+" #bankBranchAddress").val()?(showMessage(2,"Bank branch address can't be blank.","",!0),!1):null==$("#"+a+" #bankCountryId").val()||""==$("#"+a+" #bankCountryId").val()?(showMessage(2,"Please choose bank country.","",!0),!1):null==$("#"+a+" #bankStateId").val()||""==$("#"+a+" #bankStateId").val()?(showMessage(2,"Please choose bank state.","",!0),!1):null==$("#"+a+" #bankCityId").val()||""==$("#"+a+" #bankCityId").val()?(showMessage(2,"Please choose bank city.","",!0),!1):""==$("#"+a+" #bankPostal").val()?(showMessage(2,"Bank postal code can't be blank.","",!0),!1):""==$("#"+a+" #fileupload5Span").html()||"No file Selected*"==$("#"+a+" #fileupload5Span").html()?(showMessage(2,"Upload document for Address Proof.","",!0),!1):void $.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("teacher/signup","/save-teacher-bank-details"),data:JSON.stringify(getRequestForTeacherAccountAndContact(a)),dataType:"json",success:function(a){return"FAILED"===a.statusCode?("3"===a.status?redirectLoginPage():showMessage(0,a.message,"",!0),n(t)):(showMessage(1,"Redirecting to Dashboard"),setTimeout((function(){goAhead(BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/dashboard/teacher/"+UNIQUEUUID,"")}),1e3),t=!0,e(t))},error:function(){return $("#nextStep").prop("disabled",!1),n(t)}}):(showMessage(2,"Invalid Email.","",!0),!1)}))}function getRequestForTeacherAccountAndContact(a){var e={},n={},t={};return t.userId=USER_ID,t.attachements=bankUploadDocsObj,t.accountType="BANK_ACCOUNT",t.accountCurrency=$("#"+a+" #accountCurrency").val(),t.accountNumber=$("#"+a+" #accountNumber").val(),t.iban=$("#"+a+" #iban").val(),t.accountCategory=$("#"+a+" #accountCategory").val(),t.accountHolderFirstName=toTitleCase($("#"+a+" #accountHolderFirstName").val()),t.accountHolderMiddleName=toTitleCase($("#"+a+" #accountHolderMiddleName").val()),t.accountHolderLastName=toTitleCase($("#"+a+" #accountHolderLastName").val()),t.accountHolderAddress=toTitleCase($("#"+a+" #accountHolderAddress").val()),t.accountHolderCountryId=$("#"+a+" #accountHolderCountryId").val(),t.accountHolderStateId=$("#"+a+" #accountHolderStateId").val(),t.accountHolderCityId=$("#"+a+" #accountHolderCityId").val(),t.accountHolderPostal=$("#"+a+" #accountHolderPostal").val(),t.accountHolderPhone=$("#"+a+" #accountHolderPhone").val(),t.accountHolderEmail=$("#"+a+" #accountHolderEmail").val(),t.bankName=toTitleCase($("#"+a+" #bankName").val()),t.bankBranchName=toTitleCase($("#"+a+" #bankBranchName").val()),t.bankBranchAddress=escapeCharacters(toTitleCase($("#"+a+" #bankBranchAddress").val())),t.bankCountryId=$("#"+a+" #bankCountryId").val(),t.bankStateId=$("#"+a+" #bankStateId").val(),t.bankCityId=$("#"+a+" #bankCityId").val(),t.bankPostal=$("#"+a+" #bankPostal").val(),t.swiftCode=$("#"+a+" #swiftCode").val(),t.bankIfsc=$("#"+a+" #bankIfsc").val(),t.routeNumber=$("#"+a+" #routeNumber").val(),t.accountNumber=$("#"+a+" #accountNumber").val(),t.otherDetails=toSentenceCase($("#"+a+" #otherDetails").val()),t.payPalEmail=$("#"+a+" #paypalEmailId").val(),n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userType="TEACHER",n.userId=USER_ID,e.authentication=n,e.data=t,e}async function getStage6Data(){setSteps(5),showSkeleton(!0,"step5"),reviewDone=!0,$("#teacherSignupContentStage6").html(getTeacherBankAccountDetails()),signupTeacherStage6OnLoadEvent(),$(".step-5-skeleton").hide(),$("#teacherSignupStage6").show()}