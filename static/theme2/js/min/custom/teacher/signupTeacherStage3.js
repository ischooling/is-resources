var stup,countId=[],selectedCoursesID=[],mandatoryFields=[],GRADES_TAUGHT=new Array,SUBJECTS_TAUGHT=new Array,GRADES_TAUGHT_NAMES=new Array,SUBJECTS_TAUGHT_NAMES=new Array,subjectsTaught=SUBJECTS_TAUGHT,applySubejctflag=!1,applyGradeflag=!1,academicUploadDocsObj=[];async function signupTeacherStage3OnLoadEvent(e){stup=e.details.teacherDetails,$("#highestQualificationId").change((function(){if(null==$("#highestQualificationId").val()||null==$("#highestQualificationId").val()||""==$("#highestQualificationId").val().trim())return $("#highestQualificationId").valid(),validEndInvalidField(null,"highestQualificationId"),!1;validEndInvalidField(!0,"highestQualificationId")})),$("#totalExperianceFromYYYY").change((function(){if(null==$("#totalExperianceFromYYYY").val()||null==$("#totalExperianceFromYYYY").val()||""==$("#totalExperianceFromYYYY").val().trim())return $("#totalExperianceFromYYYY").valid(),validEndInvalidField(null,"totalExperianceFromYYYY"),!1;validEndInvalidField(!0,"totalExperianceFromYYYY")})),$("#totalExperianceFromMM").change((function(){if(null==$("#totalExperianceFromMM").val()||null==$("#totalExperianceFromMM").val()||""==$("#totalExperianceFromMM").val().trim())return validEndInvalidField(null,"totalExperianceFromMM"),!1;validEndInvalidField(!0,"totalExperianceFromMM")})),$("#lastOrganizationName").blur((function(){if(null==$("#lastOrganizationName").val()||null==$("#lastOrganizationName").val()||""==$("#lastOrganizationName").val().trim())return $("#lastOrganizationName").valid(),validEndInvalidField(null,"lastOrganizationName"),!1;validEndInvalidField(!0,"lastOrganizationName")})),$("#teacherSubjectSpecialization").blur((function(){if(null==$("#teacherSubjectSpecialization").val()||null==$("#teacherSubjectSpecialization").val()||""==$("#teacherSubjectSpecialization").val().trim())return $("#teacherSubjectSpecialization").valid(),validEndInvalidField(null,"teacherSubjectSpecialization"),!1;validEndInvalidField(!0,"teacherSubjectSpecialization")})),$("#lastJobTitle").blur((function(){if(null==$("#lastJobTitle").val()||null==$("#lastJobTitle").val()||""==$("#lastJobTitle").val().trim())return validEndInvalidField(null,"lastJobTitle"),!1;validEndInvalidField(!0,"lastJobTitle")})),$("#lastJobFromYYYY").change((function(){if(null==$("#lastJobFromYYYY").val()||null==$("#lastJobFromYYYY").val()||""==$("#lastJobFromYYYY").val().trim())return validEndInvalidField(null,"lastJobFromYYYY"),!1;validEndInvalidField(!0,"lastJobFromYYYY")})),$("#lastJobFromMM").change((function(){if(null==$("#lastJobFromMM").val()||null==$("#lastJobFromMM").val()||""==$("#lastJobFromMM").val().trim())return validEndInvalidField(null,"lastJobFromMM"),!1;validEndInvalidField(!0,"lastJobFromMM")})),$("#lastJobToYYYY").change((function(){if(null==$("#lastJobToYYYY").val()||null==$("#lastJobToYYYY").val()||""==$("#lastJobToYYYY").val().trim())return validEndInvalidField(null,"lastJobToYYYY"),!1;validEndInvalidField(!0,"lastJobToYYYY")})),$("#lastJobToMM").change((function(){if(null==$("#lastJobToMM").val()||null==$("#lastJobToMM").val()||""==$("#lastJobToMM").val().trim())return validEndInvalidField(null,"lastJobToMM"),!1;validEndInvalidField(!0,"lastJobToMM")})),$("#lastJobDesc").blur((function(){if(null==$("#lastJobDesc").val()||null==$("#lastJobDesc").val()||""==$("#lastJobDesc").val().trim())return $("#lastJobDesc").valid(),validEndInvalidField(null,"lastJobDesc"),!1;validEndInvalidField(!0,"lastJobDesc")})),$("#demoVedioLink").blur((function(){if(null==$("#demoVedioLink").val()||null==$("#demoVedioLink").val()||""==$("#demoVedioLink").val().trim())return $("#demoVedioLink").valid(),validEndInvalidField(null,"demoVedioLink"),!1;validEndInvalidField(!0,"demoVedioLink")})),$(".currently_working").click((function(){1==$(this).prop("checked")?($("#lastJobTo").addClass("hide"),$(".month_from").css({"margin-right":"0"})):($("#lastJobTo").removeClass("hide"),$(".month_from").css({"margin-right":"20px"}))})),$("#declConfirmation").click((function(){$("#declConfirmation").is(":checked")?$("#declConfirmation").val("Y"):$("#declConfirmation").val("N")}));$("#academicDocument").val();$(".add-upload-btn").trigger("click"),initializeSelect2(),autoSelectDropDownTeacherUpdateProfile("teacherSignupStage3",stup),formValdate("teacherSignupStage3",mandatoryFields,[]),$(".select_dropdown").select2(),$('[data-toggle="tooltip"]').tooltip().show()}function initializeSelect2(){$("#lastJobFromYYYY").hasClass("select2-hidden-accessible")?$("#lastJobFromYYYY").select2("destroy"):$("#lastJobFromYYYY").select2(),$("#lastJobFromMM").hasClass("select2-hidden-accessible")?$("#lastJobFromMM").select2("destroy"):$("#lastJobFromMM").select2(),$("#lastJobToYYYY").hasClass("select2-hidden-accessible")?$("#lastJobToYYYY").select2("destroy"):$("#lastJobToYYYY").select2(),$("#lastJobToMM").hasClass("select2-hidden-accessible")?$("#lastJobToMM").select2("destroy"):$("#lastJobToMM").select2(),$("#lastJobFromYYYY").val(stup.lastJobFromYYYY),$("#lastJobFromMM").val(stup.lastJobFromMM),$("#lastJobToYYYY").val(stup.lastJobToYYYY),$("#lastJobToMM").val(stup.lastJobToMM)}function autoSelectDropDownTeacherUpdateProfile(e,t){mandatoryFields=[],$("#highestQualificationId").val(t.highestQualificationId).trigger("change"),$("#totalExperianceFromYYYY").val(t.totalExperianceFromYYYY).trigger("change"),$("#totalExperianceFromMM").val(t.totalExperianceFromMM).trigger("change"),""!=t.highestQualificationId&&mandatoryFields.push("highestQualificationId"),""!=t.totalExperianceFromYYYY&&mandatoryFields.push("totalExperianceFromYYYY"),""!=t.totalExperianceFromMM&&mandatoryFields.push("totalExperianceFromMM"),""!=t.lastOrganizationName&&mandatoryFields.push("lastOrganizationName"),""!=t.teacherSubjectSpecialization&&mandatoryFields.push("teacherSubjectSpecialization"),""!=t.lastJobTitle&&mandatoryFields.push("lastJobTitle"),""!=t.lastJobFromYYYY&&mandatoryFields.push("lastJobFromYYYY"),""!=t.lastJobFromMM&&mandatoryFields.push("lastJobFromMM"),""!=t.lastJobToYYYY&&mandatoryFields.push("lastJobToYYYY"),""!=t.lastJobToMM&&mandatoryFields.push("lastJobToMM"),""!=t.lastJobDesc&&mandatoryFields.push("lastJobDesc"),""!=t.demoVedioLink&&mandatoryFields.push("demoVedioLink"),""!=t.uploadDocumentCVName&&null!=t.uploadDocumentCVName&&$("#fileupload1Span").closest(".valid-field").addClass("true"),""!=t.uploadDocumentAcademicName&&null!=t.uploadDocumentAcademicName&&$("#fileupload2Span").closest(".valid-field").addClass("true"),""!=t.uploadDocumentExperienceName&&null!=t.uploadDocumentExperienceName&&$("#fileupload3Span").closest(".valid-field").addClass("true"),""!=t.uploadDocumentPassport&&null!=t.uploadDocumentPassport&&$("#fileupload4Span").closest(".valid-field").addClass("true")}function callForSignupTeacherUpdateProfile(e,t,a,l){return""==$("#"+e+" #fileupload2Span").html()||"Upload Highest degree"==$("#"+e+" #fileupload2Span").html()?(showMessage(2," Please upload your highest degree.","",!0),!1):""==$("#"+e+" #fileupload1Span").html()||"Upload CV"==$("#"+e+" #fileupload1Span").html()?(showMessage(2,"  Please upload updated CV","",!0),!1):""==$("#"+e+" #fileupload4Span").html()||"Upload Passport/National ID"==$("#"+e+" #fileupload4Span").html()?(showMessage(2,"  Please upload Passport/National ID","",!0),!1):t.length+a.length+l.length<1?(showMessage(2," Select taught subjects","",!0),!1):($("#nextStep").prop("disabled",!0),$.ajax({type:"POST",url:getURLForHTML("teacher/signup","save-academic-professional-details"),data:JSON.stringify(getRequestForTeacherUpdateProfile(e,t,a,l)),contentType:"application/json",cache:!1,async:!0,timeout:6e5,success:function(s){var o=JSON.parse(s);"FAILED"==o.statusCode?("3"==o.status?redirectLoginPage():"0"!=o.status&&"3"!=o.status||showMessage(0,o.message,"",!0),!1):(getStage4Data(getRequestForTeacherUpdateProfile(e,t,a,l).data),showMessage(1,"Teacher profile updated successfully.","",!0),!0)}}),!0)}function getRequestForTeacherUpdateProfile(e,t,a,l){var s={},o={},i={};return i.userId=USER_ID,i.attachements=academicUploadDocsObj,i.elementrySelectedSubject=t,i.middleSelectedSubject=a,i.highSelectedSubject=l,i.selectedGrades=GRADES_TAUGHT.toString(),i.highestQualificationId=$("#"+e+" #highestQualificationId").val(),i.totalExperianceFromYYYY=$("#"+e+" #totalExperianceFromYYYY").val(),i.totalExperianceFromMM=0,i.lastOrganizationName=escapeCharacters(toTitleCase($("#"+e+" #lastOrganizationName").val())),i.educationSpecialization=escapeCharacters(toTitleCase($("#"+e+" #teacherSubjectSpecialization").val())),i.lastJobDesc=escapeCharacters(toSentenceCase($("#"+e+" #lastJobDesc").val())),i.declConfirmation=$("#"+e+" #declConfirmation").is(":checked")?"Y":"N",i.demoVedioLink=escapeCharacters($("#"+e+" #demoVedioLink").val()),o.hash=getHash(),o.schoolId=SCHOOL_ID,o.schoolUUID=SCHOOL_UUID,o.userType="TEACHER",o.userId=USER_ID,s.authentication=o,s.data=i,s}function getFromMonths(e,t,a){if(""!=t&&null!=t){if(hideMessage(""),""==$("#lastJobFromYYYY").val())return $("#lastJobFromMM").val(0),$("#lastJobFromMM").prop("disabled",!0),!1;var l=$("#"+e+" #lastJobFromYYYY").val();$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"LAST-JOB-FROM-MONTHS",l)),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessage(0,e.message,"",!0):buildDropdown(e.mastersData.lastJobFromMonths,$("#lastJobFromMM"),"Select Month"),$("#lastJobFromMM").prop("disabled",!1)},error:function(e){$("#lastJobFromMM").prop("disabled",!1)}}),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"LAST-JOB-TO-YEARS",l)),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessage(0,e.message,"",!0):buildDropdown(e.mastersData.lastJobToYears,$("#lastJobToYYYY"),"Select Years"),$("#lastJobFromMM").prop("disabled",!1)},error:function(e){$("#lastJobFromMM").prop("disabled",!1)}})}}function getToMonths(e,t,a){if(""!=t&&null!=t){if(hideMessage(""),""==$("#lastJobToYYYY").val())return $("#lastJobToMM").val(0),$("#lastJobToMM").prop("disabled",!0),!1;var l=$("#lastJobToYYYY").val();$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"LAST-JOB-TO-MONTHS",l)),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessage(0,e.message,"",!0):buildDropdown(e.mastersData.lastJobToMonths,$("#lastJobToMM"),"Select Month"),$("#lastJobToMM").prop("disabled",!1)},error:function(e){$("#lastJobToMM").prop("disabled",!1)}})}}function getSelectedGrades(){var e=GRADES_TAUGHT;console.log("frgs");var t;t=$(".course-selection-dropdown").select2("val"),(GRADES_TAUGHT=t).length>0&&(applyGradeflag=!0);var a=0;if(e.length==GRADES_TAUGHT.length)for(i=1;i<=e.length;i++)GRADES_TAUGHT.includes(e[i-1])&&a++;a!=e.length&&(gradesChanged=!0),console.log(GRADES_TAUGHT),$("#select_grade").modal("hide")}function setSelectedGrades(){$(".course-selection-dropdown").val(GRADES_TAUGHT).trigger("change")}function selectedCourseCategory(){var e=$(".custom-tab-wrapper li.active-tab a").attr("id");coursesDropdonw($(".courses-category-wrapper").find("#"+e+"C").find("ul.course-list li.active-tab").attr("coursetype"),e)}function coursesDropdonw(e,t){var a=$("."+e).select2({placeholder:"Select Course",allowClear:!0,minimumResultsForSearch:-1,dropdownParent:$("."+e+"-wrapper")}).change((function(){})).on("select2:closing",(function(e){e.preventDefault()})).on("select2:closed",(function(e){a.select2("open")})).on("select2:select",(function(e){var a="",l=e.params.data;countId.includes(l.id)||(l.id=l.id.replace(/\s+/g,""),a="<li class='select2-selection__choice'> <span courseId='"+l.id+"' class='select2-selection__choice__display'>"+l.text+"</span> </li>",countId.push(l.id)),subjectsTaught.includes(l.id,0)||(subjectsTaught.splice(subjectsTaught.length,0,l.id),"elementary"==t&&0==elementary_subjects.find_by_id(l.id)?elementary_subjects.push(l.text):"middle_school"==t&&0==middleSchool_subjects.find_by_id(l.id)?middleSchool_subjects.push(l.text):0==highSchool_subjects.find_by_id(l.id)&&highSchool_subjects.push(l.text)),selectedCoursesID.includes(l.id)||selectedCoursesID.push(l.id),$(".elementary_selected_course").append(a);var s=$(".selected_courses li .course-category-wrapper > ul li").length;$(".elementary_selected_course .select2-selection__choice").length>0?($(".selected_course_containter").show(),$(".elementary_selected_course").parent().closest("li").show().addClass("selectedCategory")):s<1?($(".selected_course_containter").hide(),$(".elementary_selected_course").parent().closest("li").hide()):$(".elementary_selected_course").parent().closest("li").hide()})).on("select2:unselect",(function(e){var t=e.params.data;subjectsTaught.remove_by_value(t.id);$(this).parent().closest("li").attr("coursetype");var a=t.id.replace(/\s+/g,"");$(".selected_course_wrapper").find("[courseid='"+a+"']").parent().remove();elementary_subjects.remove_by_object_id(t.id),middleSchool_subjects.remove_by_object_id(t.id),highSchool_subjects.remove_by_object_id(t.id),countId.remove_by_value(t.id);var l=$(".selected_courses li .course-category-wrapper > ul li").length;$(".elementary_selected_course .select2-selection__choice").length>0?($(".selected_course_containter").show(),$(".elementary_selected_course").parent().closest("li").show().addClass("selectedCategory")):l<1?($(".selected_course_containter").hide(),$(".elementary_selected_course").parent().closest("li").hide()):$(".elementary_selected_course").parent().closest("li").hide()}));a.select2("open")}function getSelectedSubjectes(){SUBJECTS_TAUGHT=subjectsTaught,$("#select_course").modal("hide"),applySubejctflag=!0}function showCourseList(){var e=$(".custom-tab-wrapper li.active-tab a").attr("id"),t=$(".courses-category-wrapper").find("#"+e+"C").find("ul.course-list li.active-tab").attr("coursetype");$("#select_course").modal("show"),coursesDropdonw(t,e)}async function showGradeList(){if(!applyGradeflag){$("#select_grade").remove(),$("body").append(gradeSelectionModal()),$("#e2_2").val(GRADES_TAUGHT).trigger("change");var e=$(".course-selection-dropdown").select2({placeholder:"Select Grade",dropdownParent:$("#select_grade .modal-body .container-fluid .grade_selection_wrapper")}).on("select2:closing",(function(e){e.preventDefault()})).on("select2:closed",(function(t){e.select2("open")}));e.select2("open")}$("#select_grade").modal("show")}async function showSelectedCourseList(){var e=$(this);if(e.data("requestRunning"))return!1;if(e.data("requestRunning",!0),!applySubejctflag){var t={};if(t.userId=USER_ID,responseData=await getDashboardDataBasedUrlAndPayloadWithParentUrl(!1,!1,"get-teacher-signup-subject-details",t,"/teacher/signup"),"SUCCESS"==responseData.statusCode){$("#select_course").remove(),$("body").append(courseSelectionModal(responseData.details)),elementary_subjects=responseData.details.subjectDetails.elementrySelectedSubject,middleSchool_subjects=responseData.details.subjectDetails.middleSelectedSubject,highSchool_subjects=responseData.details.subjectDetails.highSelectedSubject,SUBJECTS_TAUGHT_BACKUP=responseData.details.subjectDetails.elementrySelectedSubject.concat(responseData.details.subjectDetails.middleSelectedSubject,responseData.details.subjectDetails.highSelectedSubject),SUBJECTS_TAUGHT=responseData.details.subjectDetails.elementrySelectedSubject.concat(responseData.details.subjectDetails.middleSelectedSubject,responseData.details.subjectDetails.highSelectedSubject),$(".elementary-0").val(responseData.details.subjectDetails.elementrySelectedSubject).trigger("change"),$(".middle-school-0").val(responseData.details.subjectDetails.middleSelectedSubject).trigger("change"),$(".high-school-0").val(responseData.details.subjectDetails.highSelectedSubject).trigger("change"),responseData.details.subjectDetails.elementrySelectedSubject.concat(responseData.details.subjectDetails.middleSelectedSubject,responseData.details.subjectDetails.highSelectedSubject).length>0&&$(".selected_course_containter").show();var a=$(".custom-tab-wrapper li.active-tab a").attr("id");coursesDropdonw($(".courses-category-wrapper").find("#"+a+"C").find("ul.course-list li.active-tab").attr("coursetype"),a)}}$("#select_course").modal("show"),e.data("requestRunning",!1),$(".custom-tab-wrapper li a:not(:first)").addClass("inactive"),$(".custom-tab-item").hide(),$(".custom-tab-item:first").show(),$(".custom-tab-wrapper li a").click((function(){var e=$(this).attr("id");tabFullForm=$(this).attr("full-form"),$(this).hasClass("inactive")&&($(".custom-tab-wrapper li a").addClass("inactive"),$(".custom-tab-wrapper li").removeClass("active-tab"),$(this).removeClass("inactive"),$(this).parent().addClass("active-tab"),$(".custom-tab-item").hide(),$("#"+e+"C").find(".active-tab > .course-list-wrapper").show(),$("#"+e+"C").fadeIn())})),$(".course-tabs-format ul.course-list li a:not(:first)").addClass("inactive"),$(".elementary_course_item .course-list-wrapper").hide(),$(".elementary_course_item:first .course-list-wrapper").show(),$(".course-tabs-format ul.course-list li a").click((function(){var e=$(this).attr("id"),t=$(this).parent().closest(".custom-tab-item").attr("id");$(this).hasClass("inactive")&&($(".course-tabs-format ul.course-list li a").addClass("inactive"),$("#"+t).find(".elementary_course_item").removeClass("active-tab"),$(this).removeClass("inactive"),$(this).parent().addClass("active-tab").find(".elementary-wrapper").slideDown("fast"),$(".elementary_course_item .course-list-wrapper").hide(),$("#"+e+"C").slideDown())}))}async function getStage3Data(){setSteps(2),showSkeleton(!0,"step2");var e={};e.userId=USER_ID,responseData=await getDashboardDataBasedUrlAndPayloadWithParentUrl(!1,!1,"get-teacher-academic-professional-details",e,"teacher/signup"),$("#teacherSignupContentStage3").html(getTeacherProfessionalDetailsContent(responseData)),signupTeacherStage3OnLoadEvent(responseData),$("#totalExperianceFromYYYY").val(responseData.details.teacherDetails.totalExpYear).trigger("change"),GRADES_TAUGHT=""!=responseData.details.teacherDetails.selectedGrades?responseData.details.teacherDetails.selectedGrades.replaceAll(" ","").split(","):[],responseDataSubjects=await getDashboardDataBasedUrlAndPayloadWithParentUrl(!1,!1,"get-teacher-signup-subject-details",{userId:USER_ID},"/teacher/signup"),SUBJECTS_TAUGHT_BACKUP=responseDataSubjects.details.subjectDetails.elementrySelectedSubject.concat(responseDataSubjects.details.subjectDetails.middleSelectedSubject,responseDataSubjects.details.subjectDetails.highSelectedSubject),SUBJECTS_TAUGHT=responseDataSubjects.details.subjectDetails.elementrySelectedSubject.concat(responseDataSubjects.details.subjectDetails.middleSelectedSubject,responseDataSubjects.details.subjectDetails.highSelectedSubject),elementary_subjects=responseDataSubjects.details.subjectDetails.elementrySelectedSubject,middleSchool_subjects=responseDataSubjects.details.subjectDetails.middleSelectedSubject,highSchool_subjects=responseDataSubjects.details.subjectDetails.highSelectedSubject,$("#e2_2").val(GRADES_TAUGHT).trigger("change"),$(".elementary-0").val(elementary_subjects).trigger("change"),$(".middle-school-0").val(middleSchool_subjects).trigger("change"),$(".high-school-0").val(highSchool_subjects).trigger("change"),$(".step-2-skeleton").hide(),$("#teacherSignupStage3").show()}Array.prototype.remove_by_object_id=function(e){for(var t=0;t<this.length;t++)this[t].replace(/\s+/g,"")===e.replace(/\s+/g,"")&&(this.splice(t,1),t--);return this},Array.prototype.find_by_id=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return!0;return!1},Array.prototype.remove_by_value=function(e){for(var t=0;t<this.length;t++)this[t]===e&&(this.splice(t,1),t--);return this};