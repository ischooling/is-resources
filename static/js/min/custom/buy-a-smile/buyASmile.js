function getURLForSmile(e){return BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/common/"+e}function getURLForHTML(e,a){return BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/"+e+"/"+a}function tabActiveStatus(e){signupPage=e,$("#tabPosition"+e).trigger("click")}function validateRequestForSmile(){var e=1;return showMessageBAS("fNameError",""),showMessageBAS("lNameError",""),showMessageBAS("emailError",""),showMessageBAS("countryIdError",""),showMessageBAS("stateIdError",""),showMessageBAS("cityIdError",""),showMessageBAS("pincodeError",""),showMessageBAS("addressError",""),""==$("#fName").val()&&(showMessageBAS("fNameError","First Name is required."),e=0),""==$("#lName").val()&&(showMessageBAS("lNameError","Last Name is required."),e=0),validateEmail($("#email").val())||(showMessageBAS("emailError","Email is either empty or invalid"),e=0),null!=$("#countryId").val()&&0!=$("#countryId").val()||(showMessageBAS("countryIdError","Country is required"),e=0),null!=$("#stateId").val()&&0!=$("#stateId").val()||(showMessageBAS("stateIdError","State is required"),e=0),null!=$("#cityId").val()&&0!=$("#cityId").val()||(showMessageBAS("cityIdError","City is required"),e=0),""==$("#pincode").val()&&(showMessageBAS("pincodeError","Pincode is required."),e=0),""==$("#address").val()&&(showMessageBAS("addressError","Address is required."),e=0),0!=e}var signupstage=1;function smile(){if(1==signupstage)if(null!=$("#amount-input").val()&&""!=$("#amount-input").val()){if("."==$("#amount-input").val().charAt(0))return signupstage=1;if("0"==$("#amount-input").val().charAt(0))return signupstage=1;if(parseFloat($("#amount-input").val())>999999999.99)return signupstage=1;if($("#amount-input").val().includes(".")){if(2!=$("#amount-input").val().split(".").length)return signupstage=1;if(""==$("#amount-input").val().split(".")[1])return signupstage=1}signupstage=2}else signupstage=1;else(signupstage=2)&&saveSmile()}function smilePrev(){signupstage=1}function saveSmile(){if(!validateRequestForSmile())return!1;$.ajax({type:"POST",url:getURLForSmile("buy-a-smile-save"),contentType:"application/json",data:JSON.stringify(getRequestForSmile()),dataType:"html",success:function(e){if(""!=e)if("FAILED"==(a=JSON.parse(e)).statusResponse.status||"EXCEPTION"==a.statusResponse.status||"SESSIONOUT"==a.statusResponse.status)showMessageBAS("serverError",a.statusResponse.message);else if("NOPAYMENTGATEWAYENABLED"==a.statusResponse.status)showMessageBAS("serverError",a.statusResponse.message);else{var a=JSON.parse(e);$("#smileId").val(a.smileId),callSigninStudentPay(this)}},error:function(e){console.log(!0,e.responseText)}})}function callSigninStudentPay(e,a){$("#callPaymentStudentModal").modal({backdrop:"static",keyboard:!1})}function getRequestForSmile(){var e={},a={};return null!=$("#eId").val()&&(e.editId=$("#eId").val(),e.uuId=$("#uuId").val()),a.amount=(Math.round(100*$("#amount-input").val())/100).toFixed(2),a.firstName=$("#fName").val(),a.lastName=$("#lName").val(),a.email=$("#email").val(),a.countryId=$("#countryId option:selected").val(),a.stateId=$("#stateId option:selected").val(),a.cityId=$("#cityId option:selected").val(),a.pincode=$("#pincode").val(),a.address=$("#address").val(),a.schoolId=SCHOOL_ID,a.schoolUUID=SCHOOL_UUID,e.buyASmileDTO=a,e.controlType="ADD",e}function callStates(e,a,t){if(hideMessage(""),!validateRequestForMaster(e,t))return $("#"+e+" #stateId").val(0),resetDropdown($("#"+e+" #stateId"),"Select state"),$("#"+e+" #cityId").val(0),resetDropdown($("#"+e+" #cityId"),"Select city"),!1;$("#stateId").prop("disabled",!0),resetDropdown($("#"+e+" #cityId"),"Select city"),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster(e,"STATES-LIST",a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){"0"==e.status||"2"==e.status?showMessageBAS("serverError",e.message):buildDropdown(e.mastersData.states,$("#stateId"),"Select state"),$("#stateId").prop("disabled",!1)},error:function(e){$("#stateId").prop("disabled",!1)}})}function callCities(e,a,t){if(hideMessage(""),!validateRequestForMaster(e,t))return $("#"+e+" #cityId").val(0),resetDropdown($("#"+e+" #cityId"),"Select city"),!1;$("#"+e+" #cityId").prop("disabled",!0),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster("formId","CITIES-LIST",a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?showMessageBAS("serverError",e.message):buildDropdown(e.mastersData.cities,$("#cityId"),"Select city"),$("#cityId").prop("disabled",!1),!1},error:function(e){$("#cityId").prop("disabled",!1)}})}function validateRequestForMaster(e,a){return!(""==$("#"+e+" #"+a).val()||$("#"+e+" #"+a).val()<=0)}function resetDropdown(e,a){e.html(""),e.append("<option disabled selected> </option>")}function getURLForCommon(e){return BASE_URL+CONTEXT_PATH+SCHOOL_UUID+"/api/v1/common/"+e}function getRequestForMaster(e,a,t,o,s){var r={},n={},i={};return i.requestKey=a,i.requestValue=t,null!=o&&(i.requestExtra=o),null!=s&&(i.requestExtra1=s),n.hash=getHash(),n.schoolId=SCHOOL_ID,n.schoolUUID=SCHOOL_UUID,n.userType="COMMON",r.authentication=n,r.requestData=i,r}function buildDropdown(e,a,t){a.html(""),""!=e?(a.append('<option value="0">'+t+"</option>"),$.each(e,(function(e,t){null!=t.extra&&null!=t.extra1?a.append('<option value="'+t.key+'">'+t.extra+" - "+t.extra1+"</option>"):null!=t.extra?"selected"==t.extra?a.append('<option disabled selected value="'+t.key+'">'+t.value+"</option>"):(t.extra,a.append('<option value="'+t.key+'"> '+t.value+"</option>")):a.append('<option value="'+t.key+'">'+t.value+"</option>")}))):a.append('<option value="0">'+t+"</option>")}function hideMessage(e){$("#errorHeading").html(""),$("#statusMessage").removeClass("success-color"),$("#statusMessage").removeClass("danger-color"),$("#statusMessage").html(""),$("#modalMessage").modal("hide")}function showMessageBAS(e,a){$("#"+e).html(a),(a="")?$("#"+e).removeClass("show"):$("#"+e).addClass("show")}function hideMessageBAS(e){$("#"+e).html("")}function callCommonPaymentGatewaySmile(e,a,t,o){customLoader(!0),$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("common","call-payment-gateway"),data:JSON.stringify(getRequestForCommonPayment(e,a,t,o)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return hideMessageBAS("serverError"),"0"==e.status||"2"==e.status?showMessageBAS("serverError",e.message):"ELIGIBLE_CUSTOME_PLAN"==e.statusCode||"REDIRECT_TO_DASHBOOARD"==e.statusCode?window.location.reload():(showMessageBAS("serverError",e.message),"Smoovpay"==e.paymentGateway?prepareSmoovPayDataAndPostSmile(e.smoovPayData):window.location.replace(e.extra)),customLoader(!1),!1},error:function(e){}})}function getRequestForCommonPayment(e,a,t,o){var s={},r={};if("common"==a){r.userType=a,r.userId=$("#smileId").val();var n={};$("#location").length>0?n.location=$("#location").val():n.location="",n.themeType="theme2",n.paymentOptionName="Online",n.eligiblePaymentGateway=o,n.userType=a,n.moduleName="common",n.paymentTitle="Change a Life",n.paymentType="annually",n.entityType="BUY_A_SMILE",n.entityId=$("#smileId").val(),console.log("Data for Payment is :  ",n)}return r.hash=getHash(),r.schoolId=SCHOOL_ID,r.schoolUUID=SCHOOL_UUID,s.authentication=r,s.commonPaymentInfo=n,s}function validateEmail(e){return/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/.test(e)}function prepareSmoovPayDataAndPostSmile(e){$("#smoovpayForm").attr("action",e.endPoint),$("#smoovpayForm input[name*='action']").val(e.action),$("#smoovpayForm input[name*='currency']").val(e.currency),$("#smoovpayForm input[name*='version']").val(e.version),$("#smoovpayForm input[name*='item_name_1']").val(e.itemName1),$("#smoovpayForm input[name*='item_description_1']").val(e.itemDescription1),$("#smoovpayForm input[name*='item_quantity_1']").val(e.itemQuantity1),$("#smoovpayForm input[name*='item_amount_1']").val(e.itemAmount1),$("#smoovpayForm input[name*='merchant']").val(e.merchant),$("#smoovpayForm input[name*='ref_id']").val(e.refId),$("#smoovpayForm input[name*='delivery_charge']").val(e.deliveryCharge),$("#smoovpayForm input[name*='tax_amount']").val(e.taxAmount),$("#smoovpayForm input[name*='tax_percentage']").val(e.taxPercentage),$("#smoovpayForm input[name*='total_amount']").val(e.totalAmount),$("#smoovpayForm input[name*='str_url']").val(e.strUrl),$("#smoovpayForm input[name*='success_url']").val(e.successUrl),$("#smoovpayForm input[name*='cancel_url']").val(e.cancelUrl),$("#smoovpayForm input[name*='signature']").val(e.signature),$("#smoovpayForm input[name*='signature_algorithm']").val(e.signatureAlgorithm),$("#smoovpayForm").submit()}function getHash(){return Math.random().toString(36)}function showAlternatePG(){$("#primary-pg").hide(1e3),$("#alternate-pg").show(1e3)}function showPrimaryPG(){$("#primary-pg").show(1e3),$("#alternate-pg").hide(1e3)}function customLoader(e){e?($("#commonloaderId").removeClass("hide"),$("#commonloaderBody").addClass("loader"),$("#commonloaderId").addClass("loader-bg"),$("#commonloaderId").show()):($("#commonloaderBody").removeClass("loader"),$("#commonloaderId").removeClass("loader-bg"),$("#commonloaderId").addClass("hide"),$("#commonloaderId").hide())}$.ajaxSetup({beforeSend:function(e,a){if(null!=a.data&&"application/json"==a.contentType){var t={};t.payload=encode(a.data),a.data=JSON.stringify(t)}e.setRequestHeader("UNIQUEUUID",UNIQUEUUID)}});