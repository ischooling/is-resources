function getEmailLogsByEmail(){$.ajax({contentType:"application/json",type:"POST",url:getURLForHTML("dashboard","email-logs-data"),data:JSON.stringify(getEmailLogsByEmailPayload()),success:function(t){return"0"==t.status||"2"==t.status?(showMessage(!0,t.message),$("#logsDataTableWrapper").html(""),!1):($.fn.dataTable.isDataTable("#emailLogsTable")&&$("#emailLogsTable").dataTable().fnDestroy(),$("#logsDataTableWrapper").html(emailLogTable(t.list)),$(".email_logs_slide_popup").length<1&&$("body").append(emailLogsSlidePopupContent()),$("#emailLogsTable").dataTable({order:[[0,"asc"]],bFilter:!1}),!1)},error:function(t){return console.log(t),!1}})}function getEmailAttachments(t){var a={},e={};return e.emailId=t,$.ajax({contentType:"application/json",type:"POST",url:getURLForHTML("dashboard","get-email-attachments"),data:JSON.stringify(e),async:!1,success:function(t){null==t&&null==t?showMessage(!0,t):a=t.attachments},error:function(t){console.log(t)}}),a}function getEmailLogsByEmailPayload(){var t={},a=$("#emailLogForm #getEmail").val(),e=$("#emailLogForm #startDate").val(),l=$("#emailLogForm #endDate").val(),i=$("#emailLogForm #getSubject").val(),o=$("#emailLogForm #getContent").val(),n=$("#emailLogForm #attachement").val(),r=$("#emailLogForm #orderBy").val(),s=$("#emailLogForm #pageSize").val(),m=$("#emailLogForm #pageNo").val(),c=$("#emailLogForm #sortBy").val();return t.email=a,t.startDate=e,t.endDate=l,t.subject=null!=i&&null!=i&&""!=i?i.replaceAll(" ","").trim().replaceAll("'","\\'"):i,t.content=null!=o&&null!=o&&""!=o?o.replaceAll(" ","").trim().replaceAll("'","\\'"):o,t.attachements=n,t.orderBy=r,t.pageSize=s,t.pageNo=m,t.sortBy=c,t.schoolId=SCHOOL_ID,t}function emailLogTable(t){return'<table class="table table-bordered table-striped" id="emailLogsTable" style="width:100%"><thead><tr><th>S No.</th><th>Send To</th><th>CC</th><th>BCC</th><th>Mail Subject</th><th>Attachments</th><th>Service Provider</th><th style="width:130px">Date Time (UTC +5:30)</th><th>Mail Status</th><th>Action</th></tr></thead><tbody >'+getTableData(t)+"</tbody></table>"}function getTableData(t){for(var a="",e=0;e<t.length;e++){var l="<tr>",i=t[e].to.split(","),o="";i.forEach((t=>{o+=t+"</br>"}));var n=t[e].cc,r=n.split(","),s="";r.forEach((t=>{s+=t+"</br>"}));var m=t[e].bcc,c=m.split(","),d="";c.forEach((t=>{d+=t+"</br>"})),a+=l+="<td>"+(e+1)+"</td><td>"+o+"</td><td>"+s+"</td><td>"+d+"</td><td>"+t[e].subject+"</td><td>"+t[e].attachment+"</td><td>"+t[e].serviceBy+"</td><td>"+t[e].time+"</td><td>"+t[e].mailStatus+'</td><td><button class="btn btn-sm btn-primary" onclick="viewEmaillogsPopupConent('+t[e].id+",'"+o+"','"+n+"','"+m+"','"+t[e].subject+"','"+t[e].time+"','"+t[e].urlParameters+'\')"><i class="fa fa-eye"></i></button></td></tr>'}return a}function viewEmaillogsPopupConent(t,a,e,l,i,o,n){var r=getEmailAttachments(t),s="";null!=r&&null!=r&&r.forEach((t=>{s+="<a href="+FILE_UPLOAD_PATH+t+' target="_blank" class="d-line-block mr-3"><i class="fa fa-paperclip"></i>&nbsp;'+t+"</a> "})),$("#mailTime").html(o),$("#cc").html(e),$("#bcc").html(l),$("#sendTo").html(a),$("#emailSubject").html(i),$("#attachment").html(s),$("#emailTemplate").attr("src",BASE_URL+CONTEXT_PATH+UNIQUEUUID+"/dashboard/email-content?payload="+n),$(".email_logs_slide_popup").addClass("viewSlideContent")}function getEmailVerifyByEmail(){var t=$("#emailVerifyForm #getVEmail").val();if(console.log("email is "+t),!validateEmail(t))return showMessage(!0,"Email is either empty or invalid","studEmailIdError"),!1;if(""==t)return!1;var a={};a.email=t,$.ajax({contentType:"application/json",type:"POST",url:getURLForHTML("dashboard","email-status-data"),data:JSON.stringify(a),dataType:"json",success:function(t){return"0"==t.status||"2"==t.status?(showMessage(!0,t.message),!1):($.fn.dataTable.isDataTable("#emailVTable")&&$("#emailVTable").dataTable().fnDestroy(),$("#verificationDataTableWrapper").html(emailVerificationTable(t)),$("#emailVTable").dataTable(),!1)},error:function(t){return console.log(t),!1}})}function emailVerificationTable(t){return'<table class="table" id="emailVTable"><thead><tr><th>Email</th><th>Verification Status</th><th>Checked Date</th><th>Action</th></tr></thead><tbody >'+getVTableData(t)+"</tbody></table>"}function getVTableData(t){var a="";return a="Verified"==t.emailStatus?'<td> <button onClick="getChangeEmailVerification(0)" class="btn btn-primary">Unverify</button> </td>':'<td> <button onClick="getChangeEmailVerification(1)" class="btn btn-primary">Verify</button> </td>',"<tr><td>"+t.email+"</td><td>"+t.emailStatus+"</td><td>"+t.dateTime+"</td>"+a+"</tr>"}function getChangeEmailVerification(t){var a=$("#emailVerifyForm #getVEmail").val(),e={};e.email=a,e.status=t,$.ajax({contentType:"application/json",type:"POST",url:getURLForHTML("dashboard","email-status-change"),data:JSON.stringify(e),dataType:"json",success:function(t){return"0"==t.status||"2"==t.status?(showMessage(!0,t.message),!1):(getEmailVerifyByEmail(),!1)},error:function(t){return console.log(t),!1}})}function closeSlideContent(){$(".email_logs_slide_popup").removeClass("viewSlideContent")}function resizeIframe(t){t.style.height=t.contentWindow.document.documentElement.scrollHeight+"px"}function resetForm(t){$("#"+t)[0].reset(),$("#"+t+" #getEmail").val(""),$("#"+t+" #getSubject").val(""),$("#"+t+" #getContent").val(""),$("#"+t+" #attachement").val("").trigger("change"),$("#"+t+" #startDate").datepicker("setDate",null),$("#"+t+" #endDate").datepicker("setDate",null)}$(document).ready((function(){$(document).mouseup((function(t){var a=$(".email_logs_slide_popup");a.is(t.target)||0!==a.has(t.target).length||a.removeClass("viewSlideContent")}))}));