function addSemesterMarks(e,t,a,s,r,d,n,i,o){hideMessage("");var l="userId="+t+"&studentId="+a+"&semesterType="+s+"&standardId="+r+"&studentStandardId="+d+"&studentSessionId="+n+"&providerId="+i+"&moduleId="+o;$.ajax({type:"GET",url:getURLForHTML("dashboard","get-semester-marks"),data:l,dataType:"html",cache:!1,timeout:6e5,success:function(e){if(""!=e){var t;return"FAILED"==(t=e.split("|"))[0]||"EXCEPTION"==t[0]||"SESSIONOUT"==t[0]?"SESSIONOUT"==t[0]?redirectLoginPage():showMessage(!0,t[1]):$("#semesterMarksUploadContents").html(e),!1}},error:function(e){return!1}})}function requestForSaveSemesterData(e,t,a,s){var r={},d={};d.submitType=t,d.schoolId=SCHOOL_ID,d.userId=$("#"+e+" #userId").val(),d.studentId=$("#"+e+" #studentId").val(),d.standardId=$("#"+e+" #standardId").val(),d.studentStandardId=$("#"+e+" #studentStandardId").val(),d.studentSessionId=$("#"+e+" #studentSessionId").val(),d.courseProviderId=$("#"+e+" #courseProviderId").val(),d.semSubjectStatus=s;var n=[],i={};null!=editor1&&(d.marksRemarks=escapeCharacters(editor1.getData())),"SEMESTERA"==semesterType&&(d.semesterGraduateDateT=$("#"+e+" #semesterAGraduateDate").val(),d.semesterIssueDateT=$("#"+e+" #semesterAIssueDate").val()),"SEMESTERB"==semesterType&&(d.semesterGraduateDateT=$("#"+e+" #semesterBGraduateDate").val(),d.semesterIssueDateT=$("#"+e+" #semesterBIssueDate").val()),i.semester="Semester A",null!=$("#currentSemesterAMarks").attr("session_id")?i.sessionId=$("#currentSemesterAMarks").attr("session_id"):i.sessionId=$("#"+e+" #studentSessionId").val();var o=[];if($("#currentSemesterAMarks tbody tr").each((function(){var e={};e.courseType=$(this).find(".courseType").val(),e.marksId=$(this).find(".marksId").val(),e.subjectId=$(this).find(".subjectId").val();$(this).find(".percentageObtained").val();e.percentageObtained=$(this).find(".percentageObtained").val(),e.gradeObtained=$(this).find(".gradeObtained").val(),e.gradeCalculated=$(this).find(".gradeCalculated").text(),e.credits=$(this).find(".credit").text(),console.log("currentSemesterAMarks=> ",$(this).find(".credit").text()),e.status=$(this).find(".status").val(),e.gpaCalculated=$(this).find(".gpaCalculated").text(),o.push(e)})),i.semesterMarks=o,n.push(i),"SEMESTERB"==semesterType){var l={semester:"Semester B"};l.sessionId=$("#currentSemesterBMarks").attr("session_id");o=[];$("#currentSemesterBMarks tbody tr").each((function(){var e={};e.courseType=$(this).find(".courseType").val(),e.marksId=$(this).find(".marksId").val(),e.subjectId=$(this).find(".subjectId").val(),e.percentageObtained=$(this).find(".percentageObtained").val(),e.gradeObtained=$(this).find(".gradeObtained").val(),e.gradeCalculated=$(this).find(".gradeCalculated").text(),e.credits=$(this).find(".credit").text(),console.log("currentSemesterBMarks=> ",$(this).find(".credit").text()),e.status=$(this).find(".status").val(),e.gpaCalculated=$(this).find(".gpaCalculated").text(),o.push(e)})),l.semesterMarks=o,n.push(l)}return d.cumulativeGPA=$("#cumulativeGrade").html(),d.marks=n,r.marksRepresentDTO=d,r.sessionUserId=USER_ID,r}function saveSemesterMarks(e,t,a,s){var r="self",d=$("#"+e+" #courseProviderId").val();if("false"==a){if(1==t){if(r="all","SEMESTERA"==semesterType){if(""==$("#"+e+" #semesterAGraduateDate").val())return showMessage(!0,"Graduated Date is mandatory."),!1;if(""==$("#"+e+" #semesterAIssueDate").val()||null==$("#"+e+" #semesterAIssueDate").val())return showMessage(!0,"Date of Issuance is mandatory."),!1}if("SEMESTERB"==semesterType){if(""==$("#"+e+" #semesterBGraduateDate").val()||null==$("#"+e+" #semesterBGraduateDate").val())return showMessage(!0,"Graduated Date is mandatory."),!1;if(""==$("#"+e+" #semesterBIssueDate").val()||null==$("#"+e+" #semesterBGraduateDate").val())return showMessage(!0,"Date of Issuance is mandatory."),!1}}if($("#marksRemarks").val().length>200&&showMessage(!0,"Remarks can not more than 200 characters."),getCumulativeGrade(),"SEMESTERA"==semesterType){var n=validateSemesterMarks("currentSemesterAMarks",t,r,d);if(!n)return!1}if("SEMESTERB"==semesterType&&!(n=validateSemesterMarks("currentSemesterBMarks",t,r,d)))return!1}$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","save-semester-marks"),data:JSON.stringify(requestForSaveSemesterData(e,t,d,a)),dataType:"json",cache:!1,timeout:6e5,success:function(e){return"0"==e.status||"2"==e.status?"2"==e.status?redirectLoginPage():showMessage(!0,e.message):(showMessage(!0,e.message),$("#semesterMarksUploadModule").modal("hide"),setTimeout((function(){hideMessage("")}),3100)),!1},error:function(e){return!1}})}function validateSemesterMarks(e,t,a,s){console.log("validateSemesterMarks :: "+e);var r=1,d=0,n=0,i=0,o=!0,l=0;return $("#"+e+" tbody tr").each((function(){$(this).removeClass("tr-red");var a=$(this).find(".status").val(),u=$(this).find(".gradeObtained").val();if(console.log("gradeObtained: "+u),(""!=u||"Incomplete"==a)&&(d+=1),(""!=$(this).find(".percentageObtained").val()||"Incomplete"==a)&&(i+=1),"Completed"==a||"Repeated"==a||"Incomplete"==a){n+=1;var c=calculateSemesterPassingRule(e,r,!0,!0,t,!1,s);console.log("ruleStatus :: "+c),c&&(l+=1),c||o&&(o=!1)}r++})),"all"!=a||n==i&&n==d?0==n?(showMessage(!0,"You can not withdraw all courses!"),!1):0==l?(showMessage(!0,"Please provide grades for atleast one course."),!1):o:(showMessage(!0,"You have missed some relevant data."),!1)}function calculateSemesterPassingRule(e,t,a,s,r,d,n){console.log("calculateSemesterPassingRule position: "+t),console.log("data credit",$("#"+e+" #percentageObtained-"+t).attr("data-credit")),$("#"+e+" #tr-"+t).removeClass("tr-red");var i=$("#"+e+" #courseType-"+t).val(),o=($("#"+e+" #marksId-"+t).val(),$("#"+e+" #subjectId-"+t).val(),$("#"+e+" #percentageObtained-"+t).val()),l=$("#"+e+" #percentageObtained-"+t).attr("data-duration"),u=$("#"+e+" #percentageObtained-"+t).attr("data-credit"),c=$("#"+e+" #gradeObtained-"+t+" option:selected").val(),m=($("#"+e+" #gradeCalculated-"+t).html(),$("#"+e+" #credit-"+t).html()),p=$("#"+e+" #status-"+t+" option:selected").val(),h=!0,g=!0;return console.log("credit=> ",m),console.log("duration=> ",l),("Withdrawn"==p||"Incomplete"==p||""==o&&""==c&&2==r)&&(h=!1),h&&(""==o?(g=!1,s&&showMessage(!0,"Percentage scored cannot be blank")):parseFloat(o)<0?(g=!1,s&&showMessage(!0,"Percentage scored cannot be less than 0")):parseFloat(o)>100&&(g=!1,s&&showMessage(!0,"Percentage scored cannot be more than 100")),""==c&&(g=!1,s&&showMessage(!0,"Please select LMS grade"))),"Incomplete"!=p&&getSemesterGrade(e,i,o,t,n,l,u,p),d&&getCumulativeGrade(),g||a&&$("#"+e+" #tr-"+t).addClass("tr-red"),g}function getSemesterGrade(e,t,a,s,r,d,n,i){console.log("getSemesterGrade=> ",r),console.log("getSemesterGrade duration=> ",d);var o="0.00",l="F";return"Incomplete"==i?l="I":"-"==i?l="F":(console.log("getSemesterGrade: courseType: "+t+" percentage: "+a+" position: "+s),"FT"==t||"CR"==t||"ADV"==t||"CTE"==t?a>100?(l="F",o="0.00"):a>=96?(l="A+",o="4.00"):a>=93?(l="A",o="4.00"):a>=89?(l="A-",o="3.70"):a>=86?(l="B+",o="3.30"):a>=83?(l="B",o="3.00"):a>=79?(l="B-",o="2.70"):a>=76?(l="C+",o="2.30"):a>=73?(l="C",o="2.00"):a>=69?(l="C-",o="1.70"):a>=66?(l="D+",o="1.30"):a>=63?(l="D",o="1.00"):a>=60?(l="D-",o="0.70"):(l="F",o="0.00"):"AP"==t?a>100?(l="F",o="1.00"):a>=96?(l="A+",o="5.00"):a>=93?(l="A",o="5.00"):a>=89?(l="A-",o="4.70"):a>=86?(l="B+",o="4.30"):a>=83?(l="B",o="4.00"):a>=79?(l="B-",o="3.70"):a>=76?(l="C+",o="3.30"):a>=73?(l="C",o="3.00"):a>=69?(l="C-",o="2.70"):a>=66?(l="D+",o="2.30"):a>=63?(l="D",o="2.00"):a>=60?(l="D-",o="1.70"):(l="F",o="1.00"):"HON"==t&&(l=a>100?"F":a>=95.1?"A+":a>=92.1?"A":a>=88.1?"A-":a>=85.1?"B+":a>=82.1?"B":a>=78.1?"B-":a>=75.1?"C+":a>=72.1?"C":a>=68.1?"C-":a>=65.1?"D+":a>=62.1?"D":a>=59.1?"D-":"F")),$("#"+e+" #gradeCalculated-"+s).html(l),$("#"+e+" #gpaCalculated-"+s).html(parseFloat(o).toFixed(2)),2==r||31==r||36==r||37==r||38==r?$("#"+e+" #credit-"+s).html(n):$("#"+e+" #credit-"+s).html("0.5"),l}function getCumulativeGrade(){var e=0,t=0;if($("#currentSemesterAMarks tbody tr").each((function(){("Completed"==$(this).find(".status").val()||"Repeated"==$(this).find(".status").val())&&(e=parseFloat(parseFloat(e)+parseFloat($(this).find(".gpaCalculated").text().trim())),console.log("currentSemesterAMarks cumulativeGpa "+e+" = "+$(this).find(".gpaCalculated").text().trim()),t+=1)})),$("#currentSemesterBMarks")&&$("#currentSemesterBMarks tbody tr").each((function(){("Completed"==$(this).find(".status").val()||"Repeated"==$(this).find(".status").val())&&(e=parseFloat(parseFloat(e)+parseFloat($(this).find(".gpaCalculated").text().trim())),console.log("currentSemesterBMarks cumulativeGpa "+e+" = "+$(this).find(".gpaCalculated").text().trim()),t+=1)})),0==e&&0==t)$("#cumulativeGrade").html("0.00");else{var a=Math.round(parseFloat(e/t)*Math.pow(10,3))/Math.pow(10,3);console.log("final noOfCourse "+t+", cumulativeGpa "+e+", cumulativeGrade "+a),a=Math.round(parseFloat(a)*Math.pow(10,2))/Math.pow(10,2),$("#cumulativeGrade").html(parseFloat(a).toFixed(2))}}function publishSemesterMarks(e,t,a){$("#publishSemestermarks").attr("disabled","disabled");var s=$("#showTranscriptToStudent").val();null!=$("#showTranscriptToStudent").val()&&null!=$("#showTranscriptToStudent").val()||(s="Y");var r={};r.studentId=e,r.standardId=t,r.studentStandardId=a,r.showTranscriptToStudent=s,r.userId=USER_ID,$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","publish-student-semester-transcript"),data:JSON.stringify(r),dataType:"html",cache:!1,timeout:6e5,success:function(e){alert("Student Transcript has been published on student dashboard"),$("#publishSemestermarks").hide()},error:function(e){return $("#sendSWPR").removeAttr("disabled","disabled"),!1}})}function saveShowTranscriptToStudent(e,t,a,s){var r=$("#showTranscriptToStudent").val(),d=$("#progressionGrade").val(),n={};n.studentId=e,n.standardId=t,n.studentStandardId=a,n.showTranscriptToStudent=r,n.progressionGrade=d,n.saveType=s,n.userId=USER_ID,$.ajax({type:"POST",contentType:"application/json",url:getURLForHTML("dashboard","save-show-student-transcript"),data:JSON.stringify(n),dataType:"html",cache:!1,timeout:6e5,success:function(e){3==s?($("#showTranscriptUploadMessage").show(),setTimeout((function(){$("#showTranscriptUploadMessage").hide()}),3e3)):($("#showTranscriptToStudentMessage").show(),setTimeout((function(){$("#showTranscriptToStudentMessage").hide()}),3e3))},error:function(e){return $("#sendSWPR").removeAttr("disabled","disabled"),!1}})}function checkStatus(e,t,a){console.log("checkStatus=> ",a),"Incomplete"==$("#"+e+" #status-"+t).val()?($("#"+e+" #tr-"+t).removeClass("tr-red"),$("#"+e+" #gradeObtained-"+t).val(""),$("#"+e+" #gradeObtained-"+t).prop("disabled",!0),$("#"+e+" #percentageObtained-"+t).val(""),$("#"+e+" #percentageObtained-"+t).prop("disabled",!0),$("#"+e+" #gradeCalculated-"+t).html("I"),$("#"+e+" #credit-"+t).html("0.00"),$("#"+e+" #gpaCalculated-"+t).html("0.00")):"Withdrawn"==$("#"+e+" #status-"+t).val()?($("#"+e+" #tr-"+t).removeClass("tr-red"),$("#"+e+" #gradeObtained-"+t).val(""),$("#"+e+" #gradeObtained-"+t).prop("disabled",!0),$("#"+e+" #percentageObtained-"+t).val(""),$("#"+e+" #percentageObtained-"+t).prop("disabled",!0),$("#"+e+" #gradeCalculated-"+t).html("W"),$("#"+e+" #credit-"+t).html("-"),$("#"+e+" #gpaCalculated-"+t).html("0.00")):($("#"+e+" #status-"+t).val(),$("#"+e+" #gradeObtained-"+t).prop("disabled",!1),$("#"+e+" #percentageObtained-"+t).prop("disabled",!1),2==a?$("#"+e+" #credit-"+t).html("1.0"):$("#"+e+" #credit-"+t).html("0.5")),getCumulativeGrade()}function checkObtainedGrade(e,t){""!=$("#"+e+" #gradeObtained-"+t).val()&&$("#"+e+" #tr-"+t).removeClass("tr-red")}function callForBackStageTranscript(e){if(null==e||null==e||""==e)return!1;var t={};t.studentStandardId=e,t.UNIQUEUUID=UNIQUEUUID,$.ajax({type:"POST",url:getURLForHTML("dashboard","go-backstage-transcript"),data:JSON.stringify(t),contentType:"application/json",dataType:"html",success:function(e){if(""!=e){var t=JSON.parse(e);return"FAILED"==t.statusResponse.status||"EXCEPTION"==t.statusResponse.status||"SESSIONOUT"==t.statusResponse.status?"SESSIONOUT"==t.statusResponse.status?redirectLoginPage():setTimeout((function(){$("#backStageTranscriptMessageDiv").show(),$("#backStageTranscriptMessage").html(t.statusResponse.message)}),3e3):"SUCCESS"==t.statusResponse.status&&setTimeout((function(){$("#backStageTranscriptMessageDiv").show(),$("#backStageTranscriptMessage").html(t.statusResponse.message)}),3e3),!1}},error:function(e){console.log(!0,e.responseText)}})}