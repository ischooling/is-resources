function validateRequestForAgilixbuzzSyncEnrollment(e,t,s,n){return!0}function getRequestForAgilixbuzzSyncEnrollment(e,t,s,n,r){var a={},o={};a.uniqueId=UNIQUEUUID,a.moduleId=t,a.requestKey=s,a.lmsProviderId="TEACHER"==t&&"PULLENROLLMENT"==s?$("#courseProvider").val():r;var l=[],i={};return i.value=n,l.push(i),i.lmsProviderId="TEACHER"==t&&"PULLENROLLMENT"==s?$("#courseProvider").val():r,a.requestValues=l,o.agilixbuzzSyncRequest=a,o.userId=USER_ID,o}function callAgilixbuzzSyncEnrollment(e,t,s,n,r,a){var o=$("#lmsSubjectStart"+a).val(),l=$("#lmsSubjectEnd"+a).val();if(console.log("startDate="+o+", endDate="+l),""!=o)if(""!=l){if(hideMessage(""),!validateRequestForAgilixbuzzSyncEnrollment(e,t,s,n,r))return!1;var i='<div class="unique-loader loader-bg" style="width: 100px; height: 100px; position: inherit;">\n    \t\t\t\t\t<img src="'+PATH_FOLDER_IMAGE2+'loader-new.gif" alt="International Schooling Loader" class="new-loader-2024">\n\t\t\t\t\t</div>';$("#"+e+" #studentEnrollSemester tbody tr .lmsEnrollmentIdTd").each((function(){$(this).html(i)})),$.ajax({type:"POST",contentType:"application/json",url:getURLFor("lms-sync","enrollment"),data:JSON.stringify(getRequestForAgilixbuzzSyncEnrollment(e,t,s,n,r)),dataType:"json",success:function(t){return"0"==t.status||"2"==t.status||"3"==t.status?(showMessage(!0,t.message),"3"==t.status&&redirectLoginPage()):(showMessage(!0,t.message),$.each(t.details,(function(t,s){$("#"+e+" #studentEnrollSemester tbody").find("#"+s.entityId).find(".lmsEnrollmentIdTd").text(s.entityValue)}))),!1}})}else showMessage(!0,"Enrollment end date required");else showMessage(!0,"Enrollment start date required")}function getRequestForAgilixbuzzSyncAllEnrollment(e,t,s){var n={},r={};n.uniqueId=UNIQUEUUID,n.moduleId=e,n.lmsProviderId="TEACHER"==e?$("#courseProvider").val():s;var a=[];return $.each(t,(function(t,n){var r={};r.value=n,r.lmsProviderId="TEACHER"==e?$("#courseProvider").val():s,a.push(r)})),n.requestValues=a,r.agilixbuzzSyncRequest=n,r.userId=USER_ID,r}function syncAll(e,t,s){var n=!0,r=[];$("#"+e+" #studentEnrollSemester tbody tr").each((function(e){var t=$(this).find("#lmsSubjectStart"+(e+1)).val(),s=$(this).find("#lmsSubjectEnd"+(e+1)).val(),a=$(this).find("#lmsSubjectId"+(e+1)).val();return console.log("startDate="+t+", endDate="+s),""==t?(n=!1,void showMessage(!0,"Enrollment start date required")):""==s?(n=!1,void showMessage(!0,"Enrollment end date required")):void(""!=a&&r.push($(this).attr("id")))})),n&&$.ajax({type:"POST",contentType:"application/json",url:getURLFor("lms-sync","enrollment"),data:JSON.stringify(getRequestForAgilixbuzzSyncAllEnrollment(t,r,s)),dataType:"json",success:function(t){return"FAILED"==t.status||"EXCEPTION"==t.status||"SESSIONOUT"==t.status?(showMessage(!0,t.message),"3"==t.status&&redirectLoginPage()):(showMessage(!0,t.message),$.each(t.details,(function(t,s){$("#"+e+" #studentEnrollSemester tbody").find("#"+s.entityId).find(".lmsEnrollmentIdTd").text(s.entityValue)}))),!1}})}function validateRequestForAgilixbuzzSyncUser(e,t,s,n){return!0}function getRequestForAgilixbuzzSyncUser(e,t,s,n,r){var a={};a.uniqueId=UNIQUEUUID,a.moduleId=t,a.requestKey=s,a.lmsProviderId=r;var o=[],l={};return l.value=n,l.lmsProviderId=r,o.push(l),a.requestValues=o,a}function callAgilixbuzzSyncUser(e,t,s,n,r){if(hideMessage(""),!validateRequestForAgilixbuzzSyncUser(e,t,s,n,r))return!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("lms-sync","user"),data:JSON.stringify(getRequestForAgilixbuzzSyncUser(e,t,s,n,r)),dataType:"json",success:function(e){return"0"==e.status||"2"==e.status||"3"==e.status?(showMessage(!0,e.message),"3"==e.status&&redirectLoginPage()):($("#studentLmsContent tbody").find("."+n).text(e.lmsUserId),showMessage(!0,e.message)),!1}})}function validateRequestForBuzzGetUserGradeBookSummery(e,t,s,n){return!0}function getRequestForBuzzGetUserGradeBookSummery(e,t,s,n){var r={};return r.uniqueId=UNIQUEUUID,r.moduleId=t,r.lmsUserId=s,r.lmsProviderId=n,r}function callBuzzGetUserGradeBookSummery(e,t,s,n){if(hideMessage(""),!validateRequestForBuzzGetUserGradeBookSummery(e,t,s,n))return!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("lms-sync","get-grade-book-summery"),data:JSON.stringify(getRequestForBuzzGetUserGradeBookSummery(e,t,s,n)),dataType:"json",success:function(e){return"0"==e.status||"2"==e.status||"3"==e.status?(showMessage(!0,e.message),"3"==e.status&&redirectLoginPage()):showMessage(!0,e.message),!1}})}function validateRequestForAgilixbuzzLMSSync(e,t,s){return!0}function getRequestForAgilixbuzzLMSSync(e,t,s){var n={};return n.uniqueId=UNIQUEUUID,n.moduleId=t,n.requestKey=$("#schoolId").val(),n.lmsProviderId=$("#"+s).val(),n}function callAgilixbuzzLMSSync(e,t,s){if(hideMessage(""),customLoaderExternalPage(!0),$("#errMsg").text(""),!validateRequestForAgilixbuzzLMSSync(e,t,s))return!1;$.ajax({type:"POST",contentType:"application/json",url:getURLFor("lms-sync",""),data:JSON.stringify(getRequestForAgilixbuzzLMSSync(e,t,s)),dataType:"json",global:!1,success:function(e){return"FAILED"==e.code||"EXCEPTION"==e.code||"SESSIONOUT"==e.code?($("#errMsg").text(e.message),"SESSIONOUT"==e.code&&redirectLoginPage(),customLoaderExternalPage(!1)):($("#errMsg").text(e.message),"USER"==t?prefillLMSUserSyncResponse("lmsUserSyncResponse",e.responses):"LMSENNROLLMENT"==t?prefillLMSEnrollmentSyncResponse("lmsSyncEnrollmentResponse",e.responses):"VERIFYLMMSUSER"==t&&prefillLMSUserVerifyEmailResponse("lmsUserEmailVerifyResponse",e.responses),customLoaderExternalPage(!1)),!1},error:function(e){checkonlineOfflineStatus()}})}function prefillLMSUserVerifyEmailResponse(e,t){$("#"+e+" tbody").html(""),$.each(t,(function(t,s){var n="<tr>"+("<td>"+(t+1)+"</td>")+("<td>"+getLmsProviderName(s.lmsProviderId)+"</td>")+("<td>"+s.id+"</td>")+("<td>"+s.username+"</td>")+("<td>"+s.firstname+"</td>")+("<td>"+s.email+"</td>")+("<td>"+s.sync+"</td>")+"</tr>";$("#"+e).append(n)})),$("#"+e).dataTable().fnSetFilteringEnterPress()}function prefillLMSUserSyncResponse(e,t){$("#"+e+" tbody").html(""),$.each(t,(function(t,s){var n="<tr>"+("<td>"+(t+1)+"</td>")+("<td>"+getLmsProviderName(s.lmsProviderId)+"</td>")+("<td>"+s.reference+"</td>")+("<td>"+s.id+"</td>")+("<td>"+s.username+"</td>")+("<td>"+s.firstname+" "+s.lastname+"</td>")+("<td>"+s.email+"</td>")+("<td>"+s.sync+"</td>")+"</tr>";$("#"+e).append(n)})),$("#"+e).dataTable().fnSetFilteringEnterPress()}function prefillLMSEnrollmentSyncResponse(e,t){$("#"+e+" tbody").html(""),$.each(t,(function(t,s){var n="<tr>"+("<td>"+(t+1)+"</td>")+("<td>"+getLmsProviderName(s.lmsProviderId)+"</td>")+("<td>"+s.reference+"</td>")+("<td>"+s.enrolmentId+"</td>")+("<td>"+s.type+"</td>")+("<td>"+s.courseid+"</td>")+("<td>"+s.title+"</td>")+("<td>"+s.sync+"</td>")+"</tr>";$("#"+e).append(n)})),$("#"+e).dataTable().fnSetFilteringEnterPress()}function getLmsProviderName(e){return 36==e?"BUZZ":37==e?"BUZZ-GC":38==e?"BUZZ-GR":39==e?"Exact-Path":40==e?"Edmentum-Canvas":41==e?"Courseware":"N/A"}function callCourseProviderListForLMSSync(e,t,s){resetDropdown($("#studentFilter #lmsPlatform"),"Select LMS Platform"),$.ajax({type:"POST",contentType:"application/json",url:getURLForCommon("masters"),data:JSON.stringify(getRequestForMaster("formId","ALL-COURSE-PROVIDER-LIST","courseProList")),dataType:"json",cache:!1,success:function(n){if("0"==n.status||"2"==n.status)showMessage(!0,n.message);else{var r=n.mastersData.courseList,a=$("#"+e+" #"+t);a.html(""),$.each(r,(function(e,t){("LMSUSER"!=s&&"LMSENNROLLMENT"!=s||37!=t.key&&38!=t.key&&39!=t.key&&40!=t.key)&&("VERIFYLMMSUSER"!=s||36!=t.key&&37!=t.key&&38!=t.key&&39!=t.key&&40!=t.key)||a.append('<option value="'+t.key+'">'+t.value+" </option>")}))}}})}function callAgilixbuzzSMSSync(e){hideMessage(""),customLoaderExternalPage(!0),$("#errMsg").text(""),$.ajax({type:"GET",contentType:"application/json",url:"http://ims.internationalschooling.org:8090/ims/oneroster/sis-sync?access_token="+e,dataType:"json",global:!1,success:function(e){return"failed"==e.code||"exception"==e.code?($("#errMsg").text(e.message),customLoaderExternalPage(!1)):($("#errMsg").text('OneRoster.zip upload on "ftp.agilixbuzz.com" successfully, you will receive a SIS sync status mail on komal.ganjoo@internationalschooling.org'),customLoaderExternalPage(!1)),!1},error:function(e){checkonlineOfflineStatus()}})}var lmsSyncInterval,countCheck=0;async function syncLMS(e){var t={};if(t.schoolId=SCHOOL_ID,t.accessToken=e,"1"!=(await getDashboardDataBasedUrlAndPayload(!1,!1,"sis-sync",t)).status)return!1;$("#syncLMSWrapper").removeClass("d-none"),lmsSyncInterval=setInterval(syncLMSProcess,3e4)}async function syncLMSProcess(){countCheck++;var e={};e.schoolId=SCHOOL_ID;var t=await getDashboardDataBasedUrlAndPayload(!1,!1,"sis-sync-status",e);if("1"!=t.status)return!1;$(".lms-sync-process-1 #process-status-1").html(getSyncLMSProcessStatusContent(t.details.CSV_DOWNLOAD)),$(".lms-sync-process-2 #process-status-2").html(getSyncLMSProcessStatusContent(t.details.CSV_UPLOAD)),$(".lms-sync-process-3 #process-status-3").html(getSyncLMSProcessStatusContent(t.details.USER_SYNCED)),$(".lms-sync-process-4 #process-status-4").html(getSyncLMSProcessStatusContent(t.details.EMAIL_VERIFIED)),$(".lms-sync-process-5 #process-status-5").html(getSyncLMSProcessStatusContent(t.details.ENROLLMENT_SYNCED));var s=!1;("W"==t.details.CSV_DOWNLOAD&&"W"==t.details.CSV_UPLOAD&&"W"==t.details.USER_SYNCED&&"W"==t.details.EMAIL_VERIFIED&&"W"==t.details.ENROLLMENT_SYNCED||"C"==t.details.CSV_DOWNLOAD&&"C"==t.details.CSV_UPLOAD&&"C"==t.details.USER_SYNCED&&"C"==t.details.EMAIL_VERIFIED&&"C"==t.details.ENROLLMENT_SYNCED)&&(s=!0),countCheck>=50&&(s=!0),s&&(clearInterval(lmsSyncInterval),countCheck=0)}function getSyncLMSProcessStatusContent(e){var t="";return"P"==e?t+='<div class="spinner-border spinner-border-sm text-primary" role="status">\n\t\t\t<span class="sr-only">Loading...</span>\n\t\t</div>':"W"==e?t+='<span>\n\t\t\t<i class="fa fa-clock text-warning"></i>\n\t\t</span>':"C"==e&&(t+='<span>\n\t\t\t<i class="fa fa-check text-success"></i>\n\t\t</span>'),t}