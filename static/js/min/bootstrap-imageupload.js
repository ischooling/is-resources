if("undefined"==typeof jQuery)throw new Error("bootstrap-imageupload's JavaScript requires jQuery.");!function(e){"use strict";var i={},n={init:a,disable:function(){this.addClass("imageupload-disabled")},enable:t,reset:function(){a.call(this,i)}};function a(n){i=e.extend({},e.fn.imageupload.defaultOptions,n);var a=this,u=a.find(".file-tab"),p=a.find(".panel-heading .btn:eq(0)"),c=u.find('input[type="file"]'),m=u.find(".btn:eq(1)"),b=a.find(".url-tab"),g=a.find(".panel-heading .btn:eq(1)"),h=b.find(".btn:eq(0)"),v=b.find(".btn:eq(1)");s(u),f(b),r(u),t.call(a),p.off(),c.off(),m.off(),g.off(),h.off(),v.off(),p.on("click",(function(){e(this).blur(),r(u)})),c.on("change",(function(){e(this).blur(),function(n){var a=n.find(".btn:eq(0)"),t=n.find(".btn:eq(1)"),r=a.find("input");if(n.find(".alert").remove(),n.find("img").remove(),a.find("span").text("Browse"),t.hide(),!(r[0].files&&r[0].files[0]))return;a.prop("disabled",!0);var s=r[0].files[0];!function(n,a){if(n.size/5e3>i.maxFileSizeKb)return void a(!1,"File is too large (max "+i.maxFileSizeKb+"kB).");var t=d(n.name);console.log("fileExtension: "+t),e.inArray(t,i.allowedFormats)>-1?a(!0,"Image file is valid."):a(!1,"File type is not allowed.")}(s,(function(e,i){if(e){var d=new FileReader;d.onload=function(e){n.prepend(l(e.target.result)),a.find("span").text("Change"),t.css("display","inline-block")},d.onerror=function(){n.prepend(o("Error loading image file.")),r.val("")},d.readAsDataURL(s)}else n.prepend(o(i)),a.find("span").text("Browse"),r.val("");a.prop("disabled",!1)}))}(u)})),m.on("click",(function(){e(this).blur(),s(u)})),g.on("click",(function(){e(this).blur(),function(e){var i=e.closest(".imageupload"),n=i.find(".panel-heading .btn:eq(1)");if(!n.hasClass("active")){var a=i.find(".file-tab");i.find(".panel-heading .btn:eq(0)").removeClass("active"),n.addClass("active"),a.hide(),e.show(),s(a)}}(b)})),h.on("click",(function(){e(this).blur(),function(n){var a=n.find('input[type="text"]'),t=n.find(".btn:eq(0)"),r=n.find(".btn:eq(1)");n.find(".alert").remove(),n.find("img").remove(),r.hide();var s=a.val();if(!s)return void n.prepend(o("Please enter an image URL."));a.prop("disabled",!0),t.prop("disabled",!0),function(n,a){var t=null,o=3e3,l=!1,r=new Image;r.onload=function(){if(!l){window.clearTimeout(t);var o=n;-1!==o.indexOf("?")&&(o=o.split("?")[0].split("#")[0]);var r=d(o);e.inArray(r,i.allowedFormats)>-1?a(!0,"Image URL is valid."):a(!1,"File type is not allowed.")}},r.onerror=function(){l||(window.clearTimeout(t),a(!1,"Image could not be found."))},r.src=n,t=window.setTimeout((function(){l=!0,r.src="???",a(!1,"Loading image timed out.")}),o)}(s,(function(i,d){i?(n.find('input[type="hidden"]').val(s),e(l(s)).insertAfter(t.closest(".input-group")),r.css("display","inline-block")):n.prepend(o(d)),a.prop("disabled",!1),t.prop("disabled",!1)}))}(b)})),v.on("click",(function(){e(this).blur(),f(b)}))}function t(){this.removeClass("imageupload-disabled")}function o(e){var i=[];return i.push('<div class="alert alert-danger alert-dismissible">'),i.push('<button type="button" class="close" data-dismiss="alert">'),i.push("<span>&times;</span>"),i.push("</button>"+e),i.push("</div>"),i.join("")}function l(e){return'<img src="'+e+'" alt="Image preview" class="thumbnail" style="max-width: '+i.maxWidth+"px; max-height: "+i.maxHeight+'px">'}function d(e){return e.substr(e.lastIndexOf(".")+1).toLowerCase()}function r(e){var i=e.closest(".imageupload"),n=i.find(".panel-heading .btn:eq(0)");if(!n.hasClass("active")){var a=i.find(".url-tab");i.find(".panel-heading .btn:eq(1)").removeClass("active"),n.addClass("active"),a.hide(),e.show(),f(a)}}function s(e){e.find(".alert").remove(),e.find("img").remove(),e.find(".btn span").text("Browse"),e.find(".btn:eq(1)").hide(),e.find("input").val(""),e.find("span.fileName").text(""),console.log("$fileTab"+e)}function f(e){e.find(".alert").remove(),e.find("img").remove(),e.find(".btn:eq(1)").hide(),e.find("input").val("")}e.fn.imageupload=function(i){var a=arguments;return this.filter("div").each((function(){if(n[i])n[i].apply(e(this),Array.prototype.slice.call(a,1));else{if("object"!=typeof i&&i)throw new Error('Method "'+i+'" is not defined for imageupload.');n.init.apply(e(this),a)}}))},e.fn.imageupload.defaultOptions={allowedFormats:["jpg","jpeg","png","gif","pdf"],maxFileSizeKb:2048}}(jQuery);var $imageupload=$(".imageupload");$imageupload.imageupload(),$("#imageupload-disable").on("click",(function(){$imageupload.imageupload("disable"),$(this).blur()})),$("#imageupload-enable").on("click",(function(){$imageupload.imageupload("enable"),$(this).blur()})),$("#imageupload-reset").on("click",(function(){$imageupload.imageupload("reset"),$(this).blur()}));